<!DOCTYPE html>
<html>
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120382669-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-120382669-1');
    </script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-— generic unfurl tags -->
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:domain" value="templates.accordproject.org" />
    <meta name="twitter:label1" value="Apache 2.0 Licensed" />
    <meta name="twitter:data1" value="on GitHub.com" />
    <meta name="twitter:label2" value="Contribute" />
    <meta name="twitter:data2" value="at AccordProject.org" />

    
<!-— facebook open graph tags -->
<meta property="og:url" content="perishable-goods@0.1.0.html" />
<meta property="og:title" content="perishable-goods@0.1.0" />
<meta property="og:description" content="This clause specifies penalties if the transport conditions (temperature and humidity) for a package are breached." />
<meta property="og:image" content="https://www.plantuml.com/plantuml/svg/TP51JWCn34NtSuhiaUOCNQ022oH4om7In9eQ9NPm7C6eukvuEbdG4QpoytuS_yIxgbwqvJI4v6jrBDFeGs29HVWTWeu51ElPdn9CpB6EWKd5ct64N99NUEO8oLq6vzoTUn3-177JTLdHKouiQX2xMF7XZ2K3gQjThFZURZnY1XSRBBfJRXR0DK9z4GoTljdsodeZKfYiJqPQdBgX_kiNFQWWJSuU6LlOr5UWol8AFjgHlS170mfp3zB4Ap9Pl5NSvBFEow-0MKrkerlxVosanvOneixRaZzv0V99vxqDWMNu7dP0SPdW3m00" />

<!-— twitter card tags additive with the og: tags -->
<meta name="twitter:title" value="perishable-goods@0.1.0" />
<meta name="twitter:description" value="This clause specifies penalties if the transport conditions (temperature and humidity) for a package are breached." />
<meta name="twitter:image" content="https://www.plantuml.com/plantuml/svg/TP51JWCn34NtSuhiaUOCNQ022oH4om7In9eQ9NPm7C6eukvuEbdG4QpoytuS_yIxgbwqvJI4v6jrBDFeGs29HVWTWeu51ElPdn9CpB6EWKd5ct64N99NUEO8oLq6vzoTUn3-177JTLdHKouiQX2xMF7XZ2K3gQjThFZURZnY1XSRBBfJRXR0DK9z4GoTljdsodeZKfYiJqPQdBgX_kiNFQWWJSuU6LlOr5UWol8AFjgHlS170mfp3zB4Ap9Pl5NSvBFEow-0MKrkerlxVosanvOneixRaZzv0V99vxqDWMNu7dP0SPdW3m00" />
<meta name="twitter:url" value="perishable-goods@0.1.0.html" />


    <title>Accord Project Template Library</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>
    <a href="https://github.com/accordproject/cicero-template-library">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
            alt="Fork me on GitHub">
    </a>
    <section class="section">
        <div class="container">
            <a href="/">
                <img src="/accord_logo.png" />
            </a>
        </div>
    </section>

    
    <section class="section">
        <div class="container">
            <h1 class="title">
                Template perishable-goods@0.1.0
            </h1>
            <p class="subtitle">
                This clause specifies penalties if the transport conditions (temperature and humidity) for a package are breached.
            </p>

            <p>
                <a href="./archives/perishable-goods@0.1.0.cta" class="button is-rounded">Download Archive</a>
            </p>

            <img src="https://www.plantuml.com/plantuml/svg/TP51JWCn34NtSuhiaUOCNQ022oH4om7In9eQ9NPm7C6eukvuEbdG4QpoytuS_yIxgbwqvJI4v6jrBDFeGs29HVWTWeu51ElPdn9CpB6EWKd5ct64N99NUEO8oLq6vzoTUn3-177JTLdHKouiQX2xMF7XZ2K3gQjThFZURZnY1XSRBBfJRXR0DK9z4GoTljdsodeZKfYiJqPQdBgX_kiNFQWWJSuU6LlOr5UWol8AFjgHlS170mfp3zB4Ap9Pl5NSvBFEow-0MKrkerlxVosanvOneixRaZzv0V99vxqDWMNu7dP0SPdW3m00" />

            <h2 class="title is-2">Model Dependencies</h2>
            <div class="content">
                <ul>
                
                  <li>None</li>
                
                </ul>
            </div>

            <h2 class="title is-2">Sample</h2>
            <div class="content">
                <pre>
On receipt of the shipment "SHIP_001" the importer "DAN" pays the grower "PETER" 1.50 USD per KG. The shipment must contain between 3000 and 3500 KG of "Grade I, Size 4, Zutano Mexican Avocados".

Shipping containers used must be temperature and humidity controlled, and sensor readings must be logged at least 1 per HOUR.

Shipments that arrive after 07/02/2018 are to be considered spoiled and must be arranged to be returned to or disposed of by grower at cost to grower.

Temperature readings for the shipment must be between 2 and 13.

Humidity readings for the shipment must be between 70 and 90.

Shipments that have a temperature or humidity reading outside the agreed range have a price penalty applied calculated using the Formula for Breach Penalty Calculation below. The breach penalty factor to be used is 0.2.

Formula for Breach Penalty Calculation:
   penalty = number of shipment units x difference between sensor reading and agreed range x breach penalty factor

                </pre>
            </div>

            <h2 class="title is-2">README</h2>
            <div class="content">
                <p>
                <h1 id="perishablegoods">Perishable Goods</h1>
<p>This is a smart legal clause that conforms to the <a href="https://docs.google.com/document/d/1UacA_r2KGcBA2D4voDgGE8jqid-Uh4Dt09AE-shBKR0">Accord Project Template Specification</a>, the protocol is managed by the open-source community of the <a href="https://accordproject.org">Accord Project</a>. The clause can be parsed and executed by the <a href="https://github.com/accordproject/cicero">Cicero</a> engine.</p>
<h2 id="description">Description</h2>
<blockquote>
  <p>This clause specifies penalties if the transport conditions (temperature and humidity) for a package are breached.</p>
</blockquote>
<p>This clause contains:</p>
<ul>
<li><em>Some sample Clause Text</em> - <a href="sample.txt">sample.txt</a>, <a href="shipping-contact.txt">shipping-contract.txt</a></li>
<li><em>A template</em> - <a href="grammar/template.tem">grammar/template.tem</a></li>
<li><em>Some data models</em> - <a href="models/model.cto">models/model.cto</a>, <a href="models/contact.cto">models/contact.cto</a></li>
<li><em>Contact logic</em> (in JavaScript) - <a href="lib/logic.js">logic/logic.js</a></li>
</ul>
<h2 id="runningthisclause">Running this clause</h2>
<h3 id="onyourownmachine">On your own machine</h3>
<ol>
<li><p><a href="https://github.com/accordproject/cicero-template-library/archive/master.zip">Download the Cicero template library</a></p></li>
<li><p>Unzip the library with your favourite tool</p></li>
<li><p>Then from the command-line, change the current directory to the folder containing this README.md file.</p></li>
</ol>
<pre><code>cd perishable-goods
</code></pre>
<ol start="4">
<li>With the <a href="https://github.com/accordproject/cicero#installation">Cicero command-line tool</a>:</li>
</ol>
<pre><code>cicero execute --template ./ --sample ./sample.txt --request ./request.json --state ./state.json
</code></pre>
<blockquote>
  <p>Note, all of the command-line flags (like <code>--template</code>) are optional.</p>
</blockquote>
<p>Alternatively you can use the simpler command below if you want to use all of the default files.</p>
<pre><code>cicero execute
</code></pre>
<p>You should see the following output in your terminal:</p>
<pre><code class="bash language-bash">mattmbp:perishable-goods matt$ cicero execute
18:30:03 - info: Logging initialized. 2018-05-15T22:30:03.138Z
18:30:03 - info: Using current directory as template folder
18:30:03 - info: Loading a default sample.txt file.
18:30:03 - info: Loading a single default request.json file.
18:30:03 - info: Loading a default state.json file.
18:30:03 - info: CICERO-ENGINE Base payOut: 4500
18:30:03 - info: CICERO-ENGINE Received at: Sun Feb 18 2018 06:11:41 GMT-0500 (EST)
18:30:03 - info: CICERO-ENGINE Contract arrivalDateTime: 2018-04-02
18:30:03 - info: CICERO-ENGINE Lowest temp reading: 2
18:30:03 - info: CICERO-ENGINE Highest temp reading: 15
18:30:03 - info: CICERO-ENGINE Max temp penalty: 0.4
18:30:03 - info: CICERO-ENGINE Lowest humidity reading: 65
18:30:03 - info: CICERO-ENGINE Highest humidity reading: 90
18:30:03 - info: CICERO-ENGINE Min humidity penalty: 1.4
18:30:03 - info: CICERO-ENGINE Payout: 300
18:30:03 - info: CICERO-ENGINE {"request":{"$class":"org.accordproject.perishablegoods.ShipmentReceived","unitCount":3000,"shipment":{"$class":"org.accordproject.perishablegoods.Shipment","shipmentId":"SHIP_001","sensorReadings":[{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":15,"humidity":65,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"c"},{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":2,"humidity":80,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"a"},{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":5,"humidity":90,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"b"}]},"transactionId":"99c64b8a-b3b0-408a-8ec4-7820776cd447","timestamp":"2018-02-18T11:11:41.264Z"},"state":{"$class":"org.accordproject.common.ContractState","stateId":"org.accordproject.common.ContractState#1"},"contract":{"$class":"org.accordproject.perishablegoods.contract.TemplateModel","grower":"PETER","importer":"DAN","shipment":"SHIP_001","dueDate":"2018-04-02","unitPrice":1.5,"unit":"KG","minUnits":3000,"maxUnits":3500,"product":"Grade I, Size 4, Zutano Mexican Avocados","sensorReadingFrequency":1,"duration":"HOUR","minTemperature":2,"maxTemperature":13,"minHumidity":70,"maxHumidity":90,"penaltyFactor":0.2},"response":{"$class":"org.accordproject.perishablegoods.PriceCalculation","totalPrice":300,"penalty":4200,"late":false,"shipment":{"$class":"org.accordproject.perishablegoods.Shipment","shipmentId":"SHIP_001","sensorReadings":[{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":15,"humidity":65,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"c"},{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":2,"humidity":80,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"a"},{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":5,"humidity":90,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"b"}]},"transactionId":"2a204a05-5f24-4cc8-900b-e0f1d0520a62","timestamp":"2018-05-15T22:30:03.863Z"},"emit":[],"now":"2018-05-15T22:30:03.862Z"}
18:30:03 - info: {"clause":"perishable-goods@0.1.0-21d371562ab877afb69d7decedcc9b570da4eeba86a05b526c1e4b7a5417c44d","request":{"$class":"org.accordproject.perishablegoods.ShipmentReceived","unitCount":3000,"shipment":{"$class":"org.accordproject.perishablegoods.Shipment","shipmentId":"SHIP_001","sensorReadings":[{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":2,"humidity":80,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"a"},{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":5,"humidity":90,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"b"},{"$class":"org.accordproject.perishablegoods.SensorReading","centigrade":15,"humidity":65,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"c"}]},"transactionId":"99c64b8a-b3b0-408a-8ec4-7820776cd447","timestamp":"2018-02-18T11:11:41.264Z"},"response":{"$class":"org.accordproject.perishablegoods.PriceCalculation","totalPrice":300,"penalty":4200,"late":false,"shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001","transactionId":"2a204a05-5f24-4cc8-900b-e0f1d0520a62","timestamp":"2018-05-15T22:30:03.863Z"},"state":{"$class":"org.accordproject.common.ContractState","stateId":"org.accordproject.common.ContractState#1"},"emit":[]}
</code></pre>
<p>This template provides additional sample clause text. You can execute the second sample with the command:</p>
<pre><code>cicero execute --sample shipping-contract.txt 
</code></pre>
<p>You should then see the following output.</p>
<pre><code>...
18:31:22 - info: CICERO-ENGINE Base payOut: 4500
18:31:22 - info: CICERO-ENGINE Received at: Sun Feb 18 2018 06:11:41 GMT-0500 (EST)
18:31:22 - info: CICERO-ENGINE Contract arrivalDateTime: 2018-04-02
18:31:22 - info: CICERO-ENGINE Lowest temp reading: 2
18:31:22 - info: CICERO-ENGINE Highest temp reading: 15
18:31:22 - info: CICERO-ENGINE Lowest humidity reading: 65
18:31:22 - info: CICERO-ENGINE Highest humidity reading: 90
18:31:22 - info: CICERO-ENGINE Payout: 4500
...
</code></pre>
<blockquote>
  <p>Output above is abbreviated for clarity at <code>...</code></p>
</blockquote>
<h3 id="samplepayloaddata">Sample Payload Data</h3>
<p>Request, as in <a href="https://github.com/accordproject/cicero-template-library/blob/master/perishable-goods/request.json">request.json</a></p>
<pre><code class="json language-json">{
    "$class":"org.accordproject.perishablegoods.ShipmentReceived",
    "unitCount":3000,
    "shipment":{
        "$class":"org.accordproject.perishablegoods.Shipment",
        "shipmentId":"SHIP_001",
        "sensorReadings":[
            {
                "$class":"org.accordproject.perishablegoods.SensorReading",
                "centigrade":2,
                "humidity":80,
                "shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001",
                "transactionId":"a"
            },
            {
                "$class":"org.accordproject.perishablegoods.SensorReading",
                "centigrade":5,
                "humidity":90,
                "shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001",
                "transactionId":"b"
            },
            {
                "$class":"org.accordproject.perishablegoods.SensorReading",
                "centigrade":15,
                "humidity":65,
                "shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001",
                "transactionId":"c"
            }
        ]
    },
    "transactionId":"99c64b8a-b3b0-408a-8ec4-7820776cd447",
    "timestamp":"2018-02-18T11:11:41.264Z"
}
</code></pre>
<p>For the request above, you should see the following response:</p>
<pre><code class="json language-json">{
    "$class":"org.accordproject.perishablegoods.PriceCalculation",
    "totalPrice":300,
    "penalty":4200,
    "late":false,
    "shipment":"resource:org.accordproject.perishablegoods.Shipment#SHIP_001",
    "transactionId":"87a0f521-7848-4306-ad98-affc1af73333",
    "timestamp":"2018-02-18T11:13:53.190Z"
}
</code></pre>
<h2 id="testingthisclause">Testing this clause</h2>
<p>This clause comes with an automated test that ensures that it executes correctly under different conditions. To test the clause, complete the following steps.</p>
<p>You need npm and node to test a clause. You can download both from <a href="https://nodejs.org/">here</a>.</p>
<blockquote>
  <p>This clause was tested with Node v8.9.3 and NPM v5.6.0</p>
</blockquote>
<p>From the <code>perishable-goods</code> directory.</p>
<ol>
<li>Install all of the dependencies.</li>
</ol>
<pre><code>npm install
</code></pre>
<ol start="2">
<li>Run the tests</li>
</ol>
<pre><code>npm test
</code></pre>
<p>If successful, you should see the following output</p>
<pre><code>mattmbp:perishable-goods matt$ npm test

&gt; perishable-goods@0.1.0 test /Users/matt/dev/accordproject/cicero-template-library/perishable-goods
&gt; mocha

11:15:35 - info: Logging initialized. 2018-02-18T11:15:35.869Z


  Logic
    #ShipmentReceived
...
      ✓ on time delivery with min and max temp violations


  1 passing (280ms)
</code></pre>
<blockquote>
  <p>Output above is abbreviated for clarity at <code>...</code></p>
</blockquote>
                </p>
            </div>
        </div>
    </section>


    <footer class="footer">
        <div class="container">
            <div class="content has-text-centered">
                <p>
                    Copyright 2018 <a href="https://accordproject.org">Accord Project</a>. Licensed under the
                    <a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache-2.0</a> Open Source software license.
                </p>
            </div>
        </div>
    </footer>
</body>

</html>