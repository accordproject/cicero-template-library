{% extends "page.njk" %}

{% block body %}
    <section class="hero is-dark">
      <div class="hero-body">
        <div class="container">
          <h1 class="title is-1">
            Accord Project <span class="has-light">Template Library</span>
          </h1>
          <h2 class="subtitle">
            This library contains all Accord Project contract and clause templates. Templates are captured using the Accord Project Cicero format. To contribute new templates (or fix existing templates), you can fork this <a href="https://github.com/accordproject/cicero-template-library" target="_blank">GitHub</a> repository and submit pull requests to the maintainers.
          </h2>
        </div>
      </div>
    </section>

    <section class="section">
        <div class="container">
            <h2 class="title is-2">Templates</h2>

            <div class="search-container">
                <div class="field">
                    <div class="control has-icons-left">
                        <input id="template-search" class="input" type="text" placeholder="Search for template...">
                        <span class="icon is-left">
                            <i class="fas fa-search"></i>
                        </span>
                    </div>
                </div>
            </div>

            <table id="template-table" class="table box versions">
            <thead>
                <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Cicero Version</th>
                <th>Type</th>
                </tr>
            </thead>
            <tbody>
                {% for name, val in templateIndex |dictsort%}
                <tr>
                <th>
                  <a href="{{name}}.html">
                    {% if val.displayName %}
                      {{val.displayName}}
                    {% else %}
                      {{name}}
                    {% endif %}
                  <a>
                </th>
                <td>{{val.description}}</td>
                <td>{{val.ciceroVersion}}</td>
                <td>{% if val.type === 0 %}Contract{% else %}Clause{% endif %}</td>
                {% endfor %}
                <tr id="no-results" class="no-results-row" style="display: none;">
                    <td colspan="4" class="has-text-centered no-results-message">No results found.</td>
                </tr>
            </tbody>            
            <tfoot>
                <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Cicero Version</th>
                <th>Type</th>
                </tr>
            </tfoot>
            </table>

            <div class="content">
                <a href="template-library.json" target="_blank">Template Library Index</a>
            </div>
        </div>
    </section>

    <script>
    (function() {
        var searchInput = document.getElementById('template-search');
        var table = document.getElementById('template-table');
        var noResultsRow = document.getElementById('no-results');
        var tfoot = table.querySelector('tfoot');
        var tbody = table.querySelector('tbody');
        var rows = tbody.querySelectorAll('tr:not(.no-results-row)');

        searchInput.addEventListener('input', function() {
            var query = searchInput.value.toLowerCase().trim();
            var visibleCount = 0;

            for (var i = 0; i < rows.length; i++) {
                var text = rows[i].textContent.toLowerCase();
                if (text.indexOf(query) !== -1) {
                    rows[i].style.display = '';
                    visibleCount++;
                } else {
                    rows[i].style.display = 'none';
                }
            }

            noResultsRow.style.display = visibleCount === 0 ? '' : 'none';
            tfoot.style.display = visibleCount === 0 ? 'none' : '';
        });
    })();
    </script>

{% endblock %}