17:48:50 - [32minfo[39m: Using current directory as template folder
17:48:50 - [32minfo[39m: Loading a default sample.txt file.
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: constructor
17:48:50 - [34mdebug[39m: constructor
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processDirectory
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: fromDirectory
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:50 - [34mdebug[39m: isFileInNodeModuleDir
17:48:50 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: fromDirectory
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processDirectory
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: fromDirectory
17:48:52 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:48:52 - [34mdebug[39m: fromDirectory
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: isFileInNodeModuleDir
17:48:52 - [34mdebug[39m: processFile
17:48:52 - [34mdebug[39m: fromDirectory
17:48:52 - [34mdebug[39m: buildGrammar
17:48:52 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : [{","offset":0,"lineBreaks":2,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"sozlesmeTarihi","text":"sozlesmeTarihi","offset":45,"lineBreaks":0,"line":3,"col":21}},{"type":"Chunk","value":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : ","text":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : [{","offset":61,"lineBreaks":4,"line":3,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":114,"lineBreaks":0,"line":7,"col":39}},{"type":"Chunk","value":"\n    1.2 Adresi : ","text":"\n    1.2 Adresi : [{","offset":127,"lineBreaks":1,"line":7,"col":52},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"\n    1.3 Telefon : ","text":"\n    1.3 Telefon : [{","offset":165,"lineBreaks":1,"line":8,"col":38},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":186,"lineBreaks":0,"line":9,"col":21}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":202,"lineBreaks":4,"line":9,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":286,"lineBreaks":0,"line":13,"col":36}},{"type":"Chunk","value":"\n    1.5 Adresi : ","text":"\n    1.5 Adresi : [{","offset":297,"lineBreaks":1,"line":13,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":317,"lineBreaks":0,"line":14,"col":20}},{"type":"Chunk","value":"\n    1.6 Telefon : ","text":"\n    1.6 Telefon : [{","offset":333,"lineBreaks":1,"line":14,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":354,"lineBreaks":0,"line":15,"col":21}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : [{","offset":368,"lineBreaks":6,"line":15,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":454,"lineBreaks":0,"line":21,"col":22}},{"type":"Chunk","value":"\n    2.2 Marka : ","text":"\n    2.2 Marka : [{","offset":463,"lineBreaks":1,"line":21,"col":31},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":482,"lineBreaks":0,"line":22,"col":19}},{"type":"Chunk","value":"\n    2.3 Model : ","text":"\n    2.3 Model : [{","offset":489,"lineBreaks":1,"line":22,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":508,"lineBreaks":0,"line":23,"col":19}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı : ","text":"\n    2.4 Trafiğe Çıkış Yılı : [{","offset":515,"lineBreaks":1,"line":23,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":547,"lineBreaks":0,"line":24,"col":32}},{"type":"Chunk","value":"\n    2.5 Renk : ","text":"\n    2.5 Renk : [{","offset":559,"lineBreaks":1,"line":24,"col":44},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":577,"lineBreaks":0,"line":25,"col":18}},{"type":"Chunk","value":"\n    2.6 Şase No : ","text":"\n    2.6 Şase No : [{","offset":583,"lineBreaks":1,"line":25,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":604,"lineBreaks":0,"line":26,"col":21}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : [{","offset":608,"lineBreaks":4,"line":26,"col":25},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":651,"lineBreaks":0,"line":30,"col":19}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi : ","text":"\n    3.2 Başlangıç Tarihi : [{","offset":658,"lineBreaks":1,"line":30,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":688,"lineBreaks":0,"line":31,"col":30}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi : ","text":"\n    3.3 Bitiş Tarihi : [{","offset":705,"lineBreaks":1,"line":31,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":731,"lineBreaks":0,"line":32,"col":26}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası : ","text":"\n    3.4 Teslimat Noktası : [{","offset":744,"lineBreaks":1,"line":32,"col":39},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":774,"lineBreaks":0,"line":33,"col":30}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU : ","text":"\n\n1. SÖZLEŞMENİN KONUSU : [{","offset":791,"lineBreaks":2,"line":33,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":819,"lineBreaks":0,"line":35,"col":27}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":828,"lineBreaks":0,"line":35,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":846,"lineBreaks":0,"line":35,"col":54}},{"type":"Chunk","value":", ","text":", [{","offset":853,"lineBreaks":0,"line":35,"col":61},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":857,"lineBreaks":0,"line":35,"col":65}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":864,"lineBreaks":11,"line":35,"col":72},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1738,"lineBreaks":0,"line":46,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1757,"lineBreaks":1,"line":46,"col":83}]}
17:48:52 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : [{","offset":0,"lineBreaks":2,"line":1,"col":1}
17:48:52 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"sozlesmeTarihi","text":"sozlesmeTarihi","offset":45,"lineBreaks":0,"line":3,"col":21}}
17:48:52 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : ","text":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : [{","offset":61,"lineBreaks":4,"line":3,"col":37}
17:48:52 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":114,"lineBreaks":0,"line":7,"col":39}}
17:48:52 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.2 Adresi : ","text":"\n    1.2 Adresi : [{","offset":127,"lineBreaks":1,"line":7,"col":52}
17:48:52 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":147,"lineBreaks":0,"line":8,"col":20}}
17:48:52 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n    1.3 Telefon : ","text":"\n    1.3 Telefon : [{","offset":165,"lineBreaks":1,"line":8,"col":38}
17:48:52 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":186,"lineBreaks":0,"line":9,"col":21}}
17:48:52 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":202,"lineBreaks":4,"line":9,"col":37}
17:48:52 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":286,"lineBreaks":0,"line":13,"col":36}}
17:48:52 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.5 Adresi : ","text":"\n    1.5 Adresi : [{","offset":297,"lineBreaks":1,"line":13,"col":47}
17:48:52 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":317,"lineBreaks":0,"line":14,"col":20}}
17:48:52 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n    1.6 Telefon : ","text":"\n    1.6 Telefon : [{","offset":333,"lineBreaks":1,"line":14,"col":36}
17:48:52 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":354,"lineBreaks":0,"line":15,"col":21}}
17:48:52 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : [{","offset":368,"lineBreaks":6,"line":15,"col":35}
17:48:52 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":454,"lineBreaks":0,"line":21,"col":22}}
17:48:52 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.2 Marka : ","text":"\n    2.2 Marka : [{","offset":463,"lineBreaks":1,"line":21,"col":31}
17:48:52 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":482,"lineBreaks":0,"line":22,"col":19}}
17:48:52 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.3 Model : ","text":"\n    2.3 Model : [{","offset":489,"lineBreaks":1,"line":22,"col":26}
17:48:52 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":508,"lineBreaks":0,"line":23,"col":19}}
17:48:52 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı : ","text":"\n    2.4 Trafiğe Çıkış Yılı : [{","offset":515,"lineBreaks":1,"line":23,"col":26}
17:48:52 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":547,"lineBreaks":0,"line":24,"col":32}}
17:48:52 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.5 Renk : ","text":"\n    2.5 Renk : [{","offset":559,"lineBreaks":1,"line":24,"col":44}
17:48:52 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":577,"lineBreaks":0,"line":25,"col":18}}
17:48:52 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n    2.6 Şase No : ","text":"\n    2.6 Şase No : [{","offset":583,"lineBreaks":1,"line":25,"col":24}
17:48:52 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":604,"lineBreaks":0,"line":26,"col":21}}
17:48:52 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : [{","offset":608,"lineBreaks":4,"line":26,"col":25}
17:48:52 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":651,"lineBreaks":0,"line":30,"col":19}}
17:48:52 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi : ","text":"\n    3.2 Başlangıç Tarihi : [{","offset":658,"lineBreaks":1,"line":30,"col":26}
17:48:52 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":688,"lineBreaks":0,"line":31,"col":30}}
17:48:52 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi : ","text":"\n    3.3 Bitiş Tarihi : [{","offset":705,"lineBreaks":1,"line":31,"col":47}
17:48:52 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":731,"lineBreaks":0,"line":32,"col":26}}
17:48:52 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası : ","text":"\n    3.4 Teslimat Noktası : [{","offset":744,"lineBreaks":1,"line":32,"col":39}
17:48:52 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":774,"lineBreaks":0,"line":33,"col":30}}
17:48:52 - [34mdebug[39m: element rule34 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU : ","text":"\n\n1. SÖZLEŞMENİN KONUSU : [{","offset":791,"lineBreaks":2,"line":33,"col":47}
17:48:52 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":819,"lineBreaks":0,"line":35,"col":27}}
17:48:52 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":828,"lineBreaks":0,"line":35,"col":36}
17:48:52 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":846,"lineBreaks":0,"line":35,"col":54}}
17:48:52 - [34mdebug[39m: element rule38 {"type":"Chunk","value":", ","text":", [{","offset":853,"lineBreaks":0,"line":35,"col":61}
17:48:52 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":857,"lineBreaks":0,"line":35,"col":65}}
17:48:52 - [34mdebug[39m: element rule40 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":864,"lineBreaks":11,"line":35,"col":72}
17:48:52 - [34mdebug[39m: element rule41 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1738,"lineBreaks":0,"line":46,"col":64}}
17:48:52 - [34mdebug[39m: element rule42 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1757,"lineBreaks":1,"line":46,"col":83}
17:48:52 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 rule41 rule42 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40,rule41,rule42 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "8264d05a-2ee5-42d6-98eb-55cc8ed2b562",
        kirayaveren : rule3,
        kiralayan : rule9,
        sozlesmeTarihi : rule1,
        AnkaraMahkemeleri : rule41,
        kirayaverenAdres : rule5,
        kiralayanAdres : rule11,
        kirayaverenTel : rule7,
        kiralayanTel : rule13,
        plakaNo : rule15,
        marka : rule17,
        model : rule19,
        uretimYili : rule21,
        renk : rule23,
        id : rule25,
        baslangicTarihi : rule29,
        bitisTarihi : rule31,
        ucret : rule27,
        teslimatNoktasi : rule33,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : " 


rule1 -> String {% id %} # sozlesmeTarihi 


rule2 -> "\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : " 


rule3 -> String {% id %} # kirayaveren 


rule4 -> "\n    1.2 Adresi : " 


rule5 -> String {% id %} # kirayaverenAdres 


rule6 -> "\n    1.3 Telefon : " 


rule7 -> String {% id %} # kirayaverenTel 


rule8 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : " 


rule9 -> String {% id %} # kiralayan 


rule10 -> "\n    1.5 Adresi : " 


rule11 -> String {% id %} # kiralayanAdres 


rule12 -> "\n    1.6 Telefon : " 


rule13 -> String {% id %} # kiralayanTel 


rule14 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : " 


rule15 -> String {% id %} # plakaNo 


rule16 -> "\n    2.2 Marka : " 


rule17 -> String {% id %} # marka 


rule18 -> "\n    2.3 Model : " 


rule19 -> String {% id %} # model 


rule20 -> "\n    2.4 Trafiğe Çıkış Yılı : " 


rule21 -> String {% id %} # uretimYili 


rule22 -> "\n    2.5 Renk : " 


rule23 -> String {% id %} # renk 


rule24 -> "\n    2.6 Şase No : " 


rule25 -> String {% id %} # id 


rule26 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : " 


rule27 -> String {% id %} # ucret 


rule28 -> "\n    3.2 Başlangıç Tarihi : " 


rule29 -> String {% id %} # baslangicTarihi 


rule30 -> "\n    3.3 Bitiş Tarihi : " 


rule31 -> String {% id %} # bitisTarihi 


rule32 -> "\n    3.4 Teslimat Noktası : " 


rule33 -> String {% id %} # teslimatNoktasi 


rule34 -> "\n\n1. SÖZLEŞMENİN KONUSU : " 


rule35 -> String {% id %} # plakaNo 


rule36 -> " Plaka numaralı " 


rule37 -> String {% id %} # marka 


rule38 -> ", " 


rule39 -> String {% id %} # model 


rule40 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule41 -> String {% id %} # AnkaraMahkemeleri 


rule42 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:48:52 - [34mdebug[39m: fromDirectory
17:48:52 - [34mdebug[39m: fromDirectory
17:48:52 - [31merror[39m: invalid syntax at line 3 col 19:

  SÖZLEŞME TARİHİ : “17.07.2018”
                    ^
Unexpected "“"

Error: invalid syntax at line 3 col 19:

  SÖZLEŞME TARİHİ : “17.07.2018”
                    ^
Unexpected "“"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:48:52 - [32minfo[39m: undefined
17:49:15 - [32minfo[39m: Using current directory as template folder
17:49:15 - [32minfo[39m: Loading a default sample.txt file.
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: constructor
17:49:15 - [34mdebug[39m: constructor
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processDirectory
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: fromDirectory
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:15 - [34mdebug[39m: isFileInNodeModuleDir
17:49:15 - [34mdebug[39m: processFile
17:49:17 - [34mdebug[39m: fromDirectory
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: processDirectory
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: processFile
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: processFile
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: processFile
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: processFile
17:49:17 - [34mdebug[39m: isFileInNodeModuleDir
17:49:17 - [34mdebug[39m: processFile
17:49:17 - [34mdebug[39m: fromDirectory
17:49:18 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:49:18 - [34mdebug[39m: fromDirectory
17:49:18 - [34mdebug[39m: isFileInNodeModuleDir
17:49:18 - [34mdebug[39m: processFile
17:49:18 - [34mdebug[39m: isFileInNodeModuleDir
17:49:18 - [34mdebug[39m: processFile
17:49:18 - [34mdebug[39m: isFileInNodeModuleDir
17:49:18 - [34mdebug[39m: processFile
17:49:18 - [34mdebug[39m: isFileInNodeModuleDir
17:49:18 - [34mdebug[39m: processFile
17:49:18 - [34mdebug[39m: isFileInNodeModuleDir
17:49:18 - [34mdebug[39m: processFile
17:49:18 - [34mdebug[39m: isFileInNodeModuleDir
17:49:18 - [34mdebug[39m: processFile
17:49:18 - [34mdebug[39m: fromDirectory
17:49:18 - [34mdebug[39m: buildGrammar
17:49:18 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : [{","offset":0,"lineBreaks":2,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"sozlesmeTarihi","text":"sozlesmeTarihi","offset":45,"lineBreaks":0,"line":3,"col":21}},{"type":"Chunk","value":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : ","text":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : [{","offset":61,"lineBreaks":4,"line":3,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":114,"lineBreaks":0,"line":7,"col":39}},{"type":"Chunk","value":"\n    1.2 Adresi : ","text":"\n    1.2 Adresi : [{","offset":127,"lineBreaks":1,"line":7,"col":52},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"\n    1.3 Telefon : ","text":"\n    1.3 Telefon : [{","offset":165,"lineBreaks":1,"line":8,"col":38},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":186,"lineBreaks":0,"line":9,"col":21}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":202,"lineBreaks":4,"line":9,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":286,"lineBreaks":0,"line":13,"col":36}},{"type":"Chunk","value":"\n    1.5 Adresi : ","text":"\n    1.5 Adresi : [{","offset":297,"lineBreaks":1,"line":13,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":317,"lineBreaks":0,"line":14,"col":20}},{"type":"Chunk","value":"\n    1.6 Telefon : ","text":"\n    1.6 Telefon : [{","offset":333,"lineBreaks":1,"line":14,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":354,"lineBreaks":0,"line":15,"col":21}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : [{","offset":368,"lineBreaks":6,"line":15,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":454,"lineBreaks":0,"line":21,"col":22}},{"type":"Chunk","value":"\n    2.2 Marka : ","text":"\n    2.2 Marka : [{","offset":463,"lineBreaks":1,"line":21,"col":31},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":482,"lineBreaks":0,"line":22,"col":19}},{"type":"Chunk","value":"\n    2.3 Model : ","text":"\n    2.3 Model : [{","offset":489,"lineBreaks":1,"line":22,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":508,"lineBreaks":0,"line":23,"col":19}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı : ","text":"\n    2.4 Trafiğe Çıkış Yılı : [{","offset":515,"lineBreaks":1,"line":23,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":547,"lineBreaks":0,"line":24,"col":32}},{"type":"Chunk","value":"\n    2.5 Renk : ","text":"\n    2.5 Renk : [{","offset":559,"lineBreaks":1,"line":24,"col":44},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":577,"lineBreaks":0,"line":25,"col":18}},{"type":"Chunk","value":"\n    2.6 Şase No : ","text":"\n    2.6 Şase No : [{","offset":583,"lineBreaks":1,"line":25,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":604,"lineBreaks":0,"line":26,"col":21}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : [{","offset":608,"lineBreaks":4,"line":26,"col":25},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":651,"lineBreaks":0,"line":30,"col":19}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi : ","text":"\n    3.2 Başlangıç Tarihi : [{","offset":658,"lineBreaks":1,"line":30,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":688,"lineBreaks":0,"line":31,"col":30}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi : ","text":"\n    3.3 Bitiş Tarihi : [{","offset":705,"lineBreaks":1,"line":31,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":731,"lineBreaks":0,"line":32,"col":26}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası : ","text":"\n    3.4 Teslimat Noktası : [{","offset":744,"lineBreaks":1,"line":32,"col":39},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":774,"lineBreaks":0,"line":33,"col":30}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU : ","text":"\n\n1. SÖZLEŞMENİN KONUSU : [{","offset":791,"lineBreaks":2,"line":33,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":819,"lineBreaks":0,"line":35,"col":27}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":828,"lineBreaks":0,"line":35,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":846,"lineBreaks":0,"line":35,"col":54}},{"type":"Chunk","value":", ","text":", [{","offset":853,"lineBreaks":0,"line":35,"col":61},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":857,"lineBreaks":0,"line":35,"col":65}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":864,"lineBreaks":11,"line":35,"col":72},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1738,"lineBreaks":0,"line":46,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1757,"lineBreaks":1,"line":46,"col":83}]}
17:49:18 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : [{","offset":0,"lineBreaks":2,"line":1,"col":1}
17:49:18 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"sozlesmeTarihi","text":"sozlesmeTarihi","offset":45,"lineBreaks":0,"line":3,"col":21}}
17:49:18 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : ","text":"\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : [{","offset":61,"lineBreaks":4,"line":3,"col":37}
17:49:18 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":114,"lineBreaks":0,"line":7,"col":39}}
17:49:18 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.2 Adresi : ","text":"\n    1.2 Adresi : [{","offset":127,"lineBreaks":1,"line":7,"col":52}
17:49:18 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":147,"lineBreaks":0,"line":8,"col":20}}
17:49:18 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n    1.3 Telefon : ","text":"\n    1.3 Telefon : [{","offset":165,"lineBreaks":1,"line":8,"col":38}
17:49:18 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":186,"lineBreaks":0,"line":9,"col":21}}
17:49:18 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":202,"lineBreaks":4,"line":9,"col":37}
17:49:18 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":286,"lineBreaks":0,"line":13,"col":36}}
17:49:18 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.5 Adresi : ","text":"\n    1.5 Adresi : [{","offset":297,"lineBreaks":1,"line":13,"col":47}
17:49:18 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":317,"lineBreaks":0,"line":14,"col":20}}
17:49:18 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n    1.6 Telefon : ","text":"\n    1.6 Telefon : [{","offset":333,"lineBreaks":1,"line":14,"col":36}
17:49:18 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":354,"lineBreaks":0,"line":15,"col":21}}
17:49:18 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : [{","offset":368,"lineBreaks":6,"line":15,"col":35}
17:49:18 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":454,"lineBreaks":0,"line":21,"col":22}}
17:49:18 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.2 Marka : ","text":"\n    2.2 Marka : [{","offset":463,"lineBreaks":1,"line":21,"col":31}
17:49:18 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":482,"lineBreaks":0,"line":22,"col":19}}
17:49:18 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.3 Model : ","text":"\n    2.3 Model : [{","offset":489,"lineBreaks":1,"line":22,"col":26}
17:49:18 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":508,"lineBreaks":0,"line":23,"col":19}}
17:49:18 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı : ","text":"\n    2.4 Trafiğe Çıkış Yılı : [{","offset":515,"lineBreaks":1,"line":23,"col":26}
17:49:18 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":547,"lineBreaks":0,"line":24,"col":32}}
17:49:18 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.5 Renk : ","text":"\n    2.5 Renk : [{","offset":559,"lineBreaks":1,"line":24,"col":44}
17:49:18 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":577,"lineBreaks":0,"line":25,"col":18}}
17:49:18 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n    2.6 Şase No : ","text":"\n    2.6 Şase No : [{","offset":583,"lineBreaks":1,"line":25,"col":24}
17:49:18 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":604,"lineBreaks":0,"line":26,"col":21}}
17:49:18 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : [{","offset":608,"lineBreaks":4,"line":26,"col":25}
17:49:18 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":651,"lineBreaks":0,"line":30,"col":19}}
17:49:18 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi : ","text":"\n    3.2 Başlangıç Tarihi : [{","offset":658,"lineBreaks":1,"line":30,"col":26}
17:49:18 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":688,"lineBreaks":0,"line":31,"col":30}}
17:49:18 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi : ","text":"\n    3.3 Bitiş Tarihi : [{","offset":705,"lineBreaks":1,"line":31,"col":47}
17:49:18 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":731,"lineBreaks":0,"line":32,"col":26}}
17:49:18 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası : ","text":"\n    3.4 Teslimat Noktası : [{","offset":744,"lineBreaks":1,"line":32,"col":39}
17:49:18 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":774,"lineBreaks":0,"line":33,"col":30}}
17:49:18 - [34mdebug[39m: element rule34 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU : ","text":"\n\n1. SÖZLEŞMENİN KONUSU : [{","offset":791,"lineBreaks":2,"line":33,"col":47}
17:49:18 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":819,"lineBreaks":0,"line":35,"col":27}}
17:49:18 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":828,"lineBreaks":0,"line":35,"col":36}
17:49:18 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":846,"lineBreaks":0,"line":35,"col":54}}
17:49:18 - [34mdebug[39m: element rule38 {"type":"Chunk","value":", ","text":", [{","offset":853,"lineBreaks":0,"line":35,"col":61}
17:49:18 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":857,"lineBreaks":0,"line":35,"col":65}}
17:49:18 - [34mdebug[39m: element rule40 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":864,"lineBreaks":11,"line":35,"col":72}
17:49:18 - [34mdebug[39m: element rule41 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1738,"lineBreaks":0,"line":46,"col":64}}
17:49:18 - [34mdebug[39m: element rule42 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1757,"lineBreaks":1,"line":46,"col":83}
17:49:18 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 rule41 rule42 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40,rule41,rule42 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "abe7f557-85d1-4e5e-8e9a-ba291036922d",
        kirayaveren : rule3,
        kiralayan : rule9,
        sozlesmeTarihi : rule1,
        AnkaraMahkemeleri : rule41,
        kirayaverenAdres : rule5,
        kiralayanAdres : rule11,
        kirayaverenTel : rule7,
        kiralayanTel : rule13,
        plakaNo : rule15,
        marka : rule17,
        model : rule19,
        uretimYili : rule21,
        renk : rule23,
        id : rule25,
        baslangicTarihi : rule29,
        bitisTarihi : rule31,
        ucret : rule27,
        teslimatNoktasi : rule33,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\nSÖZLEŞME TARİHİ : " 


rule1 -> String {% id %} # sozlesmeTarihi 


rule2 -> "\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : " 


rule3 -> String {% id %} # kirayaveren 


rule4 -> "\n    1.2 Adresi : " 


rule5 -> String {% id %} # kirayaverenAdres 


rule6 -> "\n    1.3 Telefon : " 


rule7 -> String {% id %} # kirayaverenTel 


rule8 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : " 


rule9 -> String {% id %} # kiralayan 


rule10 -> "\n    1.5 Adresi : " 


rule11 -> String {% id %} # kiralayanAdres 


rule12 -> "\n    1.6 Telefon : " 


rule13 -> String {% id %} # kiralayanTel 


rule14 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : " 


rule15 -> String {% id %} # plakaNo 


rule16 -> "\n    2.2 Marka : " 


rule17 -> String {% id %} # marka 


rule18 -> "\n    2.3 Model : " 


rule19 -> String {% id %} # model 


rule20 -> "\n    2.4 Trafiğe Çıkış Yılı : " 


rule21 -> String {% id %} # uretimYili 


rule22 -> "\n    2.5 Renk : " 


rule23 -> String {% id %} # renk 


rule24 -> "\n    2.6 Şase No : " 


rule25 -> String {% id %} # id 


rule26 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : " 


rule27 -> String {% id %} # ucret 


rule28 -> "\n    3.2 Başlangıç Tarihi : " 


rule29 -> String {% id %} # baslangicTarihi 


rule30 -> "\n    3.3 Bitiş Tarihi : " 


rule31 -> String {% id %} # bitisTarihi 


rule32 -> "\n    3.4 Teslimat Noktası : " 


rule33 -> String {% id %} # teslimatNoktasi 


rule34 -> "\n\n1. SÖZLEŞMENİN KONUSU : " 


rule35 -> String {% id %} # plakaNo 


rule36 -> " Plaka numaralı " 


rule37 -> String {% id %} # marka 


rule38 -> ", " 


rule39 -> String {% id %} # model 


rule40 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule41 -> String {% id %} # AnkaraMahkemeleri 


rule42 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:49:18 - [34mdebug[39m: fromDirectory
17:49:18 - [34mdebug[39m: fromDirectory
17:49:18 - [31merror[39m: invalid syntax at line 3 col 19:

  SÖZLEŞME TARİHİ : “17072018”
                    ^
Unexpected "“"

Error: invalid syntax at line 3 col 19:

  SÖZLEŞME TARİHİ : “17072018”
                    ^
Unexpected "“"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:49:18 - [32minfo[39m: undefined
17:50:20 - [32minfo[39m: Using current directory as template folder
17:50:20 - [32minfo[39m: Loading a default sample.txt file.
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: constructor
17:50:20 - [34mdebug[39m: constructor
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processDirectory
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: fromDirectory
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:20 - [34mdebug[39m: isFileInNodeModuleDir
17:50:20 - [34mdebug[39m: processFile
17:50:22 - [34mdebug[39m: fromDirectory
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: processDirectory
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: processFile
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: processFile
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: processFile
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: processFile
17:50:22 - [34mdebug[39m: isFileInNodeModuleDir
17:50:22 - [34mdebug[39m: processFile
17:50:22 - [34mdebug[39m: fromDirectory
17:50:23 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:50:23 - [34mdebug[39m: fromDirectory
17:50:23 - [34mdebug[39m: isFileInNodeModuleDir
17:50:23 - [34mdebug[39m: processFile
17:50:23 - [34mdebug[39m: isFileInNodeModuleDir
17:50:23 - [34mdebug[39m: processFile
17:50:23 - [34mdebug[39m: isFileInNodeModuleDir
17:50:23 - [34mdebug[39m: processFile
17:50:23 - [34mdebug[39m: isFileInNodeModuleDir
17:50:23 - [34mdebug[39m: processFile
17:50:23 - [34mdebug[39m: isFileInNodeModuleDir
17:50:23 - [34mdebug[39m: processFile
17:50:23 - [34mdebug[39m: isFileInNodeModuleDir
17:50:23 - [34mdebug[39m: processFile
17:50:23 - [34mdebug[39m: fromDirectory
17:50:23 - [34mdebug[39m: buildGrammar
17:50:23 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":77,"lineBreaks":0,"line":6,"col":39}},{"type":"Chunk","value":"\n    1.2 Adresi : ","text":"\n    1.2 Adresi : [{","offset":90,"lineBreaks":1,"line":6,"col":52},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":110,"lineBreaks":0,"line":7,"col":20}},{"type":"Chunk","value":"\n    1.3 Telefon : ","text":"\n    1.3 Telefon : [{","offset":128,"lineBreaks":1,"line":7,"col":38},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":149,"lineBreaks":0,"line":8,"col":21}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":165,"lineBreaks":4,"line":8,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":249,"lineBreaks":0,"line":12,"col":36}},{"type":"Chunk","value":"\n    1.5 Adresi : ","text":"\n    1.5 Adresi : [{","offset":260,"lineBreaks":1,"line":12,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":280,"lineBreaks":0,"line":13,"col":20}},{"type":"Chunk","value":"\n    1.6 Telefon : ","text":"\n    1.6 Telefon : [{","offset":296,"lineBreaks":1,"line":13,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":317,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : [{","offset":331,"lineBreaks":6,"line":14,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":417,"lineBreaks":0,"line":20,"col":22}},{"type":"Chunk","value":"\n    2.2 Marka : ","text":"\n    2.2 Marka : [{","offset":426,"lineBreaks":1,"line":20,"col":31},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":445,"lineBreaks":0,"line":21,"col":19}},{"type":"Chunk","value":"\n    2.3 Model : ","text":"\n    2.3 Model : [{","offset":452,"lineBreaks":1,"line":21,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":471,"lineBreaks":0,"line":22,"col":19}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı : ","text":"\n    2.4 Trafiğe Çıkış Yılı : [{","offset":478,"lineBreaks":1,"line":22,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":510,"lineBreaks":0,"line":23,"col":32}},{"type":"Chunk","value":"\n    2.5 Renk : ","text":"\n    2.5 Renk : [{","offset":522,"lineBreaks":1,"line":23,"col":44},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":540,"lineBreaks":0,"line":24,"col":18}},{"type":"Chunk","value":"\n    2.6 Şase No : ","text":"\n    2.6 Şase No : [{","offset":546,"lineBreaks":1,"line":24,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":567,"lineBreaks":0,"line":25,"col":21}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : [{","offset":571,"lineBreaks":4,"line":25,"col":25},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":614,"lineBreaks":0,"line":29,"col":19}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi : ","text":"\n    3.2 Başlangıç Tarihi : [{","offset":621,"lineBreaks":1,"line":29,"col":26},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":651,"lineBreaks":0,"line":30,"col":30}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi : ","text":"\n    3.3 Bitiş Tarihi : [{","offset":668,"lineBreaks":1,"line":30,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":694,"lineBreaks":0,"line":31,"col":26}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası : ","text":"\n    3.4 Teslimat Noktası : [{","offset":707,"lineBreaks":1,"line":31,"col":39},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":737,"lineBreaks":0,"line":32,"col":30}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU : ","text":"\n\n1. SÖZLEŞMENİN KONUSU : [{","offset":754,"lineBreaks":2,"line":32,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":782,"lineBreaks":0,"line":34,"col":27}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":791,"lineBreaks":0,"line":34,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":809,"lineBreaks":0,"line":34,"col":54}},{"type":"Chunk","value":", ","text":", [{","offset":816,"lineBreaks":0,"line":34,"col":61},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":820,"lineBreaks":0,"line":34,"col":65}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":827,"lineBreaks":11,"line":34,"col":72},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1701,"lineBreaks":0,"line":45,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1720,"lineBreaks":1,"line":45,"col":83}]}
17:50:23 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : [{","offset":0,"lineBreaks":5,"line":1,"col":1}
17:50:23 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":77,"lineBreaks":0,"line":6,"col":39}}
17:50:23 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi : ","text":"\n    1.2 Adresi : [{","offset":90,"lineBreaks":1,"line":6,"col":52}
17:50:23 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":110,"lineBreaks":0,"line":7,"col":20}}
17:50:23 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon : ","text":"\n    1.3 Telefon : [{","offset":128,"lineBreaks":1,"line":7,"col":38}
17:50:23 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":149,"lineBreaks":0,"line":8,"col":21}}
17:50:23 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":165,"lineBreaks":4,"line":8,"col":37}
17:50:23 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":249,"lineBreaks":0,"line":12,"col":36}}
17:50:23 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi : ","text":"\n    1.5 Adresi : [{","offset":260,"lineBreaks":1,"line":12,"col":47}
17:50:23 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":280,"lineBreaks":0,"line":13,"col":20}}
17:50:23 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon : ","text":"\n    1.6 Telefon : [{","offset":296,"lineBreaks":1,"line":13,"col":36}
17:50:23 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":317,"lineBreaks":0,"line":14,"col":21}}
17:50:23 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : [{","offset":331,"lineBreaks":6,"line":14,"col":35}
17:50:23 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":417,"lineBreaks":0,"line":20,"col":22}}
17:50:23 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka : ","text":"\n    2.2 Marka : [{","offset":426,"lineBreaks":1,"line":20,"col":31}
17:50:23 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":445,"lineBreaks":0,"line":21,"col":19}}
17:50:23 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model : ","text":"\n    2.3 Model : [{","offset":452,"lineBreaks":1,"line":21,"col":26}
17:50:23 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":471,"lineBreaks":0,"line":22,"col":19}}
17:50:23 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı : ","text":"\n    2.4 Trafiğe Çıkış Yılı : [{","offset":478,"lineBreaks":1,"line":22,"col":26}
17:50:23 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":510,"lineBreaks":0,"line":23,"col":32}}
17:50:23 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk : ","text":"\n    2.5 Renk : [{","offset":522,"lineBreaks":1,"line":23,"col":44}
17:50:23 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":540,"lineBreaks":0,"line":24,"col":18}}
17:50:23 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No : ","text":"\n    2.6 Şase No : [{","offset":546,"lineBreaks":1,"line":24,"col":24}
17:50:23 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":567,"lineBreaks":0,"line":25,"col":21}}
17:50:23 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : [{","offset":571,"lineBreaks":4,"line":25,"col":25}
17:50:23 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":614,"lineBreaks":0,"line":29,"col":19}}
17:50:23 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi : ","text":"\n    3.2 Başlangıç Tarihi : [{","offset":621,"lineBreaks":1,"line":29,"col":26}
17:50:23 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":651,"lineBreaks":0,"line":30,"col":30}}
17:50:23 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi : ","text":"\n    3.3 Bitiş Tarihi : [{","offset":668,"lineBreaks":1,"line":30,"col":47}
17:50:23 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":694,"lineBreaks":0,"line":31,"col":26}}
17:50:23 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası : ","text":"\n    3.4 Teslimat Noktası : [{","offset":707,"lineBreaks":1,"line":31,"col":39}
17:50:23 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":737,"lineBreaks":0,"line":32,"col":30}}
17:50:23 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU : ","text":"\n\n1. SÖZLEŞMENİN KONUSU : [{","offset":754,"lineBreaks":2,"line":32,"col":47}
17:50:23 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":782,"lineBreaks":0,"line":34,"col":27}}
17:50:23 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":791,"lineBreaks":0,"line":34,"col":36}
17:50:23 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":809,"lineBreaks":0,"line":34,"col":54}}
17:50:23 - [34mdebug[39m: element rule36 {"type":"Chunk","value":", ","text":", [{","offset":816,"lineBreaks":0,"line":34,"col":61}
17:50:23 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":820,"lineBreaks":0,"line":34,"col":65}}
17:50:23 - [34mdebug[39m: element rule38 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":827,"lineBreaks":11,"line":34,"col":72}
17:50:23 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1701,"lineBreaks":0,"line":45,"col":64}}
17:50:23 - [34mdebug[39m: element rule40 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1720,"lineBreaks":1,"line":45,"col":83}
17:50:23 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "0e4b4253-c857-4cdd-a2c8-d26629a92949",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule39,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı : " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi : " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon : " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi : " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon : " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No : " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka : " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model : " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı : " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk : " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No : " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret : " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi : " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi : " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası : " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU : " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> ", " 


rule37 -> String {% id %} # model 


rule38 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ :Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME :Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule39 -> String {% id %} # AnkaraMahkemeleri 


rule40 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:50:23 - [34mdebug[39m: fromDirectory
17:50:23 - [34mdebug[39m: fromDirectory
17:50:23 - [31merror[39m: invalid syntax at line 3 col 1:

  1. TARAFLAR
  ^
Unexpected "1"

Error: invalid syntax at line 3 col 1:

  1. TARAFLAR
  ^
Unexpected "1"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:50:23 - [32minfo[39m: undefined
17:51:44 - [32minfo[39m: Using current directory as template folder
17:51:44 - [32minfo[39m: Loading a default sample.txt file.
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: constructor
17:51:44 - [34mdebug[39m: constructor
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processDirectory
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: fromDirectory
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:44 - [34mdebug[39m: isFileInNodeModuleDir
17:51:44 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: fromDirectory
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processDirectory
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: fromDirectory
17:51:47 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:51:47 - [34mdebug[39m: fromDirectory
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: isFileInNodeModuleDir
17:51:47 - [34mdebug[39m: processFile
17:51:47 - [34mdebug[39m: fromDirectory
17:51:47 - [34mdebug[39m: buildGrammar
17:51:47 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":242,"lineBreaks":0,"line":11,"col":36}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":253,"lineBreaks":1,"line":11,"col":47},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":271,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":287,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":306,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":320,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":404,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":413,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":430,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":437,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":454,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":461,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":491,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":503,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":519,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":525,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":544,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":548,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":589,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":596,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":624,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":641,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":665,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":678,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":706,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":723,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":749,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":758,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":776,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":", ","text":", [{","offset":783,"lineBreaks":0,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":787,"lineBreaks":0,"line":33,"col":63}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":794,"lineBreaks":11,"line":33,"col":70},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1670,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1689,"lineBreaks":1,"line":44,"col":83}]}
17:51:47 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
17:51:47 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
17:51:47 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
17:51:47 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
17:51:47 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
17:51:47 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
17:51:47 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : [{","offset":158,"lineBreaks":4,"line":7,"col":35}
17:51:47 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":242,"lineBreaks":0,"line":11,"col":36}}
17:51:47 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":253,"lineBreaks":1,"line":11,"col":47}
17:51:47 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":271,"lineBreaks":0,"line":12,"col":18}}
17:51:47 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":287,"lineBreaks":1,"line":12,"col":34}
17:51:47 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":306,"lineBreaks":0,"line":13,"col":19}}
17:51:47 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":320,"lineBreaks":6,"line":13,"col":33}
17:51:47 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":404,"lineBreaks":0,"line":19,"col":20}}
17:51:47 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":413,"lineBreaks":1,"line":19,"col":29}
17:51:47 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":430,"lineBreaks":0,"line":20,"col":17}}
17:51:47 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":437,"lineBreaks":1,"line":20,"col":24}
17:51:47 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":454,"lineBreaks":0,"line":21,"col":17}}
17:51:47 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":461,"lineBreaks":1,"line":21,"col":24}
17:51:47 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":491,"lineBreaks":0,"line":22,"col":30}}
17:51:47 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":503,"lineBreaks":1,"line":22,"col":42}
17:51:47 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":519,"lineBreaks":0,"line":23,"col":16}}
17:51:47 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":525,"lineBreaks":1,"line":23,"col":22}
17:51:47 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":544,"lineBreaks":0,"line":24,"col":19}}
17:51:47 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":548,"lineBreaks":4,"line":24,"col":23}
17:51:47 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":589,"lineBreaks":0,"line":28,"col":17}}
17:51:47 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":596,"lineBreaks":1,"line":28,"col":24}
17:51:47 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":624,"lineBreaks":0,"line":29,"col":28}}
17:51:47 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":641,"lineBreaks":1,"line":29,"col":45}
17:51:47 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":665,"lineBreaks":0,"line":30,"col":24}}
17:51:47 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":678,"lineBreaks":1,"line":30,"col":37}
17:51:47 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":706,"lineBreaks":0,"line":31,"col":28}}
17:51:47 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":723,"lineBreaks":2,"line":31,"col":45}
17:51:47 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":749,"lineBreaks":0,"line":33,"col":25}}
17:51:47 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":758,"lineBreaks":0,"line":33,"col":34}
17:51:47 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":776,"lineBreaks":0,"line":33,"col":52}}
17:51:47 - [34mdebug[39m: element rule36 {"type":"Chunk","value":", ","text":", [{","offset":783,"lineBreaks":0,"line":33,"col":59}
17:51:47 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":787,"lineBreaks":0,"line":33,"col":63}}
17:51:47 - [34mdebug[39m: element rule38 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":794,"lineBreaks":11,"line":33,"col":70}
17:51:47 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1670,"lineBreaks":0,"line":44,"col":64}}
17:51:47 - [34mdebug[39m: element rule40 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1689,"lineBreaks":1,"line":44,"col":83}
17:51:47 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "54de1685-596d-43ed-9d6f-2a89ae1d70aa",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule39,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı : " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> ", " 


rule37 -> String {% id %} # model 


rule38 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule39 -> String {% id %} # AnkaraMahkemeleri 


rule40 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:51:47 - [34mdebug[39m: fromDirectory
17:51:47 - [34mdebug[39m: fromDirectory
17:51:47 - [31merror[39m: invalid syntax at line 5 col 35:

      1.1 Kiraya Verenin Adı Soyadı : "Acme Car Rental"
                                    ^
Unexpected ":"

Error: invalid syntax at line 5 col 35:

      1.1 Kiraya Verenin Adı Soyadı : "Acme Car Rental"
                                    ^
Unexpected ":"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:51:47 - [32minfo[39m: undefined
17:51:58 - [32minfo[39m: Using current directory as template folder
17:51:58 - [32minfo[39m: Loading a default sample.txt file.
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: constructor
17:51:58 - [34mdebug[39m: constructor
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processDirectory
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: fromDirectory
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:51:58 - [34mdebug[39m: isFileInNodeModuleDir
17:51:58 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: fromDirectory
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processDirectory
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: fromDirectory
17:52:03 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:52:03 - [34mdebug[39m: fromDirectory
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: isFileInNodeModuleDir
17:52:03 - [34mdebug[39m: processFile
17:52:03 - [34mdebug[39m: fromDirectory
17:52:03 - [34mdebug[39m: buildGrammar
17:52:03 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}]}
17:52:03 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
17:52:03 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
17:52:03 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
17:52:03 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
17:52:03 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
17:52:03 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
17:52:03 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
17:52:03 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
17:52:03 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
17:52:03 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
17:52:03 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
17:52:03 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
17:52:03 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
17:52:03 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
17:52:03 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
17:52:03 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
17:52:03 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
17:52:03 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
17:52:03 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
17:52:03 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
17:52:03 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
17:52:03 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
17:52:03 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
17:52:03 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
17:52:03 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
17:52:03 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
17:52:03 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
17:52:03 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
17:52:03 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
17:52:03 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
17:52:03 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
17:52:03 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
17:52:03 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
17:52:03 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
17:52:03 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
17:52:03 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
17:52:03 - [34mdebug[39m: element rule36 {"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59}
17:52:03 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}}
17:52:03 - [34mdebug[39m: element rule38 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70}
17:52:03 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}}
17:52:03 - [34mdebug[39m: element rule40 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}
17:52:03 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "da71e695-ec12-4230-b905-d07757b6624b",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule39,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> ", " 


rule37 -> String {% id %} # model 


rule38 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule39 -> String {% id %} # AnkaraMahkemeleri 


rule40 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:52:03 - [34mdebug[39m: fromDirectory
17:52:03 - [34mdebug[39m: fromDirectory
17:52:03 - [31merror[39m: invalid syntax at line 5 col 35:

      1.1 Kiraya Verenin Adı Soyadı : "Acme Car Rental"
                                    ^
Unexpected ":"

Error: invalid syntax at line 5 col 35:

      1.1 Kiraya Verenin Adı Soyadı : "Acme Car Rental"
                                    ^
Unexpected ":"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:52:03 - [32minfo[39m: undefined
17:53:18 - [32minfo[39m: Using current directory as template folder
17:53:18 - [32minfo[39m: Loading a default sample.txt file.
17:53:18 - [34mdebug[39m: fromDirectory
17:53:18 - [34mdebug[39m: fromDirectory
17:53:18 - [34mdebug[39m: fromDirectory
17:53:18 - [34mdebug[39m: fromDirectory
17:53:18 - [34mdebug[39m: fromDirectory
17:53:18 - [34mdebug[39m: fromDirectory
17:53:18 - [34mdebug[39m: fromDirectory
17:53:19 - [34mdebug[39m: constructor
17:53:19 - [34mdebug[39m: constructor
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processDirectory
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: fromDirectory
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:19 - [34mdebug[39m: isFileInNodeModuleDir
17:53:19 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: fromDirectory
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processDirectory
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: fromDirectory
17:53:21 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:53:21 - [34mdebug[39m: fromDirectory
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: isFileInNodeModuleDir
17:53:21 - [34mdebug[39m: processFile
17:53:21 - [34mdebug[39m: fromDirectory
17:53:21 - [34mdebug[39m: buildGrammar
17:53:21 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}]}
17:53:21 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
17:53:21 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
17:53:21 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
17:53:21 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
17:53:21 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
17:53:21 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
17:53:21 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
17:53:21 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
17:53:21 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
17:53:21 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
17:53:21 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
17:53:21 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
17:53:21 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
17:53:21 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
17:53:21 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
17:53:21 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
17:53:21 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
17:53:21 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
17:53:21 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
17:53:21 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
17:53:21 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
17:53:21 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
17:53:21 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
17:53:21 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
17:53:21 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
17:53:21 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
17:53:21 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
17:53:21 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
17:53:21 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
17:53:21 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
17:53:21 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
17:53:21 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
17:53:21 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
17:53:21 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
17:53:21 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
17:53:21 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
17:53:21 - [34mdebug[39m: element rule36 {"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59}
17:53:21 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}}
17:53:21 - [34mdebug[39m: element rule38 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70}
17:53:21 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}}
17:53:21 - [34mdebug[39m: element rule40 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}
17:53:21 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "a392813f-9527-4409-9fc9-40b86e06e1f0",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule39,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> ", " 


rule37 -> String {% id %} # model 


rule38 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule39 -> String {% id %} # AnkaraMahkemeleri 


rule40 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:53:21 - [34mdebug[39m: fromDirectory
17:53:21 - [34mdebug[39m: fromDirectory
17:53:21 - [31merror[39m: invalid syntax at line 6 col 16:

      1.2 Adresi “Dikmen Caddesi No:48/15 Dikmen Ankara”
                 ^
Unexpected "“"

Error: invalid syntax at line 6 col 16:

      1.2 Adresi “Dikmen Caddesi No:48/15 Dikmen Ankara”
                 ^
Unexpected "“"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:53:21 - [32minfo[39m: undefined
17:55:26 - [32minfo[39m: Using current directory as template folder
17:55:26 - [32minfo[39m: Loading a default sample.txt file.
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: constructor
17:55:26 - [34mdebug[39m: constructor
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processDirectory
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: fromDirectory
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:26 - [34mdebug[39m: isFileInNodeModuleDir
17:55:26 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: fromDirectory
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processDirectory
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: fromDirectory
17:55:28 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:55:28 - [34mdebug[39m: fromDirectory
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: isFileInNodeModuleDir
17:55:28 - [34mdebug[39m: processFile
17:55:28 - [34mdebug[39m: fromDirectory
17:55:28 - [34mdebug[39m: buildGrammar
17:55:28 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}]}
17:55:28 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
17:55:28 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
17:55:28 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
17:55:28 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
17:55:28 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
17:55:28 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
17:55:28 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
17:55:28 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
17:55:28 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
17:55:28 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
17:55:28 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
17:55:28 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
17:55:28 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
17:55:28 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
17:55:28 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
17:55:28 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
17:55:28 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
17:55:28 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
17:55:28 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
17:55:28 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
17:55:28 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
17:55:28 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
17:55:28 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
17:55:28 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
17:55:28 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
17:55:28 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
17:55:28 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
17:55:28 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
17:55:28 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
17:55:28 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
17:55:28 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
17:55:28 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
17:55:28 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
17:55:28 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
17:55:28 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
17:55:28 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
17:55:28 - [34mdebug[39m: element rule36 {"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59}
17:55:28 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}}
17:55:28 - [34mdebug[39m: element rule38 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70}
17:55:28 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}}
17:55:28 - [34mdebug[39m: element rule40 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}
17:55:28 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "3cb31da0-ae1d-4cd6-a27b-132c455966a0",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule39,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> ", " 


rule37 -> String {% id %} # model 


rule38 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule39 -> String {% id %} # AnkaraMahkemeleri 


rule40 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:55:28 - [34mdebug[39m: fromDirectory
17:55:28 - [34mdebug[39m: fromDirectory
17:55:28 - [31merror[39m: invalid syntax at line 13 col 32:

      1.6 Telefon "+901234567890" 
                                 ^
Unexpected " "

Error: invalid syntax at line 13 col 32:

      1.6 Telefon "+901234567890" 
                                 ^
Unexpected " "

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:55:28 - [32minfo[39m: undefined
17:55:57 - [32minfo[39m: Using current directory as template folder
17:55:57 - [32minfo[39m: Loading a default sample.txt file.
17:55:57 - [34mdebug[39m: fromDirectory
17:55:57 - [34mdebug[39m: fromDirectory
17:55:57 - [34mdebug[39m: fromDirectory
17:55:57 - [34mdebug[39m: fromDirectory
17:55:57 - [34mdebug[39m: fromDirectory
17:55:57 - [34mdebug[39m: fromDirectory
17:55:57 - [34mdebug[39m: fromDirectory
17:55:57 - [34mdebug[39m: constructor
17:55:58 - [34mdebug[39m: constructor
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processDirectory
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: fromDirectory
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:55:58 - [34mdebug[39m: isFileInNodeModuleDir
17:55:58 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: fromDirectory
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processDirectory
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: fromDirectory
17:56:00 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:56:00 - [34mdebug[39m: fromDirectory
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: isFileInNodeModuleDir
17:56:00 - [34mdebug[39m: processFile
17:56:00 - [34mdebug[39m: fromDirectory
17:56:00 - [34mdebug[39m: buildGrammar
17:56:00 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}]}
17:56:00 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
17:56:00 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
17:56:00 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
17:56:00 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
17:56:00 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
17:56:00 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
17:56:00 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
17:56:00 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
17:56:00 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
17:56:00 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
17:56:00 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
17:56:01 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
17:56:01 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
17:56:01 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
17:56:01 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
17:56:01 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
17:56:01 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
17:56:01 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
17:56:01 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
17:56:01 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
17:56:01 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
17:56:01 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
17:56:01 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
17:56:01 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
17:56:01 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
17:56:01 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
17:56:01 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
17:56:01 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
17:56:01 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
17:56:01 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
17:56:01 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
17:56:01 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
17:56:01 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
17:56:01 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
17:56:01 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
17:56:01 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
17:56:01 - [34mdebug[39m: element rule36 {"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59}
17:56:01 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}}
17:56:01 - [34mdebug[39m: element rule38 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70}
17:56:01 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}}
17:56:01 - [34mdebug[39m: element rule40 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}
17:56:01 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "9d9f3a23-709c-4366-ad73-4652c52c0470",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule39,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> ", " 


rule37 -> String {% id %} # model 


rule38 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule39 -> String {% id %} # AnkaraMahkemeleri 


rule40 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:56:01 - [34mdebug[39m: fromDirectory
17:56:01 - [34mdebug[39m: fromDirectory
17:56:01 - [31merror[39m: invalid syntax at line 33 col 63:

  1. SÖZLEŞMENİN KONUSU "PlakaNo" Plaka numaralı "Marka / Model" marka otomobilin KİRALAYAN'a kiraya verilmesi.
                                                                ^
Unexpected " "

Error: invalid syntax at line 33 col 63:

  1. SÖZLEŞMENİN KONUSU "PlakaNo" Plaka numaralı "Marka / Model" marka otomobilin KİRALAYAN'a kiraya verilmesi.
                                                                ^
Unexpected " "

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:56:01 - [32minfo[39m: undefined
17:56:35 - [32minfo[39m: Using current directory as template folder
17:56:35 - [32minfo[39m: Loading a default sample.txt file.
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: constructor
17:56:35 - [34mdebug[39m: constructor
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processDirectory
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: fromDirectory
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:35 - [34mdebug[39m: isFileInNodeModuleDir
17:56:35 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: fromDirectory
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processDirectory
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: fromDirectory
17:56:37 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



17:56:37 - [34mdebug[39m: fromDirectory
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: isFileInNodeModuleDir
17:56:37 - [34mdebug[39m: processFile
17:56:37 - [34mdebug[39m: fromDirectory
17:56:37 - [34mdebug[39m: buildGrammar
17:56:37 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}]}
17:56:37 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
17:56:37 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
17:56:37 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
17:56:37 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
17:56:37 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
17:56:37 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
17:56:37 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
17:56:37 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
17:56:37 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
17:56:37 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
17:56:37 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
17:56:37 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
17:56:37 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
17:56:37 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
17:56:37 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
17:56:37 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
17:56:37 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
17:56:37 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
17:56:37 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
17:56:37 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
17:56:37 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
17:56:37 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
17:56:37 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
17:56:37 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
17:56:37 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
17:56:37 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
17:56:37 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
17:56:37 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
17:56:37 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
17:56:37 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
17:56:37 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
17:56:37 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
17:56:37 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
17:56:37 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
17:56:37 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
17:56:37 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
17:56:37 - [34mdebug[39m: element rule36 {"type":"Chunk","value":", ","text":", [{","offset":781,"lineBreaks":0,"line":33,"col":59}
17:56:37 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":785,"lineBreaks":0,"line":33,"col":63}}
17:56:37 - [34mdebug[39m: element rule38 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":792,"lineBreaks":11,"line":33,"col":70}
17:56:37 - [34mdebug[39m: element rule39 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1668,"lineBreaks":0,"line":44,"col":64}}
17:56:37 - [34mdebug[39m: element rule40 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1687,"lineBreaks":1,"line":44,"col":83}
17:56:37 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 rule39 rule40 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "f5520c8d-b389-4cf1-8b40-648243e8067d",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule39,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> ", " 


rule37 -> String {% id %} # model 


rule38 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule39 -> String {% id %} # AnkaraMahkemeleri 


rule40 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
17:56:37 - [34mdebug[39m: fromDirectory
17:56:37 - [34mdebug[39m: fromDirectory
17:56:37 - [31merror[39m: invalid syntax at line 33 col 55:

  1. SÖZLEŞMENİN KONUSU "PlakaNo" Plaka numaralı "marka""model" marka otomobilin KİRALAYAN'a kiraya verilmesi.
                                                        ^
Unexpected "\""

Error: invalid syntax at line 33 col 55:

  1. SÖZLEŞMENİN KONUSU "PlakaNo" Plaka numaralı "marka""model" marka otomobilin KİRALAYAN'a kiraya verilmesi.
                                                        ^
Unexpected "\""

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:56:37 - [32minfo[39m: undefined
17:56:56 - [32minfo[39m: Using current directory as template folder
17:56:56 - [32minfo[39m: Loading a default sample.txt file.
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: constructor
17:56:56 - [34mdebug[39m: constructor
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processDirectory
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: fromDirectory
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:56:56 - [34mdebug[39m: isFileInNodeModuleDir
17:56:56 - [34mdebug[39m: processFile
17:57:29 - [31merror[39m: Failed to load model file. Queue: [{"options":{},"url":"https://models.accordproject.org/money.cto","downloadedUris":{}}] Details: {}
Error: Failed to load model file. Queue: [{"options":{},"url":"https://models.accordproject.org/money.cto","downloadedUris":{}}] Details: {}
    at ModelFileDownloader.on (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/introspect/loaders/modelfiledownloader.js:72:25)
    at emitTwo (events.js:126:13)
    at ModelFileDownloader.emit (events.js:214:7)
    at runJob.then.catch (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/introspect/loaders/jobqueue.js:152:22)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
17:57:29 - [32minfo[39m: undefined
20:03:00 - [32minfo[39m: Using current directory as template folder
20:03:00 - [32minfo[39m: Loading a default sample.txt file.
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: constructor
20:03:00 - [34mdebug[39m: constructor
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processDirectory
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: fromDirectory
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:00 - [34mdebug[39m: isFileInNodeModuleDir
20:03:00 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: fromDirectory
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processDirectory
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: fromDirectory
20:03:01 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



20:03:01 - [34mdebug[39m: fromDirectory
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: isFileInNodeModuleDir
20:03:01 - [34mdebug[39m: processFile
20:03:01 - [34mdebug[39m: fromDirectory
20:03:01 - [34mdebug[39m: buildGrammar
20:03:01 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}]}
20:03:01 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
20:03:01 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
20:03:01 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
20:03:01 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
20:03:01 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
20:03:01 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
20:03:01 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
20:03:01 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
20:03:01 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
20:03:01 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
20:03:01 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
20:03:01 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
20:03:01 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
20:03:01 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
20:03:01 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
20:03:01 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
20:03:01 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
20:03:01 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
20:03:01 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
20:03:01 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
20:03:01 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
20:03:01 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
20:03:01 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
20:03:01 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
20:03:01 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
20:03:01 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
20:03:01 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
20:03:01 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
20:03:01 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
20:03:01 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
20:03:01 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
20:03:01 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
20:03:01 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
20:03:01 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
20:03:01 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
20:03:01 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
20:03:01 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
20:03:01 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}}
20:03:01 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}
20:03:01 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "e2e94f1e-eaa5-4df0-8c83-aea0c994df0b",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # AnkaraMahkemeleri 


rule38 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
20:03:01 - [34mdebug[39m: fromDirectory
20:03:01 - [34mdebug[39m: fromDirectory
20:03:01 - [31merror[39m: invalid syntax at line 44 col 71:

  İş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda "Ankara" Mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.
                                                                        ^
Unexpected "M"

Error: invalid syntax at line 44 col 71:

  İş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda "Ankara" Mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.
                                                                        ^
Unexpected "M"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
20:03:01 - [32minfo[39m: undefined
20:03:26 - [32minfo[39m: Using current directory as template folder
20:03:26 - [32minfo[39m: Loading a default sample.txt file.
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: constructor
20:03:26 - [34mdebug[39m: constructor
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processDirectory
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: fromDirectory
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:26 - [34mdebug[39m: isFileInNodeModuleDir
20:03:26 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: fromDirectory
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processDirectory
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: fromDirectory
20:03:28 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



20:03:28 - [34mdebug[39m: fromDirectory
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: isFileInNodeModuleDir
20:03:28 - [34mdebug[39m: processFile
20:03:28 - [34mdebug[39m: fromDirectory
20:03:28 - [34mdebug[39m: buildGrammar
20:03:28 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}]}
20:03:28 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
20:03:28 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
20:03:28 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
20:03:28 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
20:03:28 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
20:03:28 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
20:03:28 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
20:03:28 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
20:03:28 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
20:03:28 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
20:03:28 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
20:03:28 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
20:03:28 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
20:03:28 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
20:03:28 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
20:03:28 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
20:03:28 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
20:03:28 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
20:03:28 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
20:03:28 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
20:03:28 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
20:03:28 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
20:03:28 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
20:03:28 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
20:03:28 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
20:03:28 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
20:03:28 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
20:03:28 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
20:03:28 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
20:03:28 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
20:03:28 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
20:03:28 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
20:03:28 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
20:03:28 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
20:03:28 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
20:03:28 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
20:03:28 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
20:03:28 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}}
20:03:28 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}
20:03:28 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "1c1c1c39-fb7f-4686-82ca-4a404ea58d0b",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # AnkaraMahkemeleri 


rule38 -> " yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
20:03:28 - [34mdebug[39m: fromDirectory
20:03:28 - [34mdebug[39m: fromDirectory
20:03:28 - [31merror[39m: invalid syntax at line 44 col 71:

  İş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda "Ankara" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.
                                                                        ^
Unexpected "m"

Error: invalid syntax at line 44 col 71:

  İş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda "Ankara" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.
                                                                        ^
Unexpected "m"

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
20:03:28 - [32minfo[39m: undefined
20:04:51 - [32minfo[39m: Using current directory as template folder
20:04:51 - [32minfo[39m: Loading a default sample.txt file.
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: constructor
20:04:51 - [34mdebug[39m: constructor
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processDirectory
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: fromDirectory
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:51 - [34mdebug[39m: isFileInNodeModuleDir
20:04:51 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: fromDirectory
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processDirectory
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: fromDirectory
20:04:52 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



20:04:52 - [34mdebug[39m: fromDirectory
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: isFileInNodeModuleDir
20:04:52 - [34mdebug[39m: processFile
20:04:52 - [34mdebug[39m: fromDirectory
20:04:52 - [34mdebug[39m: buildGrammar
20:04:52 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}]}
20:04:52 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
20:04:52 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
20:04:52 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
20:04:52 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
20:04:52 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
20:04:52 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
20:04:52 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
20:04:52 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
20:04:52 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
20:04:52 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
20:04:52 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
20:04:53 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
20:04:53 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
20:04:53 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
20:04:53 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
20:04:53 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
20:04:53 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
20:04:53 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
20:04:53 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
20:04:53 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
20:04:53 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
20:04:53 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
20:04:53 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
20:04:53 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
20:04:53 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
20:04:53 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
20:04:53 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
20:04:53 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
20:04:53 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
20:04:53 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
20:04:53 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
20:04:53 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
20:04:53 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
20:04:53 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
20:04:53 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
20:04:53 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
20:04:53 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
20:04:53 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}}
20:04:53 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}
20:04:53 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "13cdbbf5-ba8a-4ecb-b287-348d2ef36ca5",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # AnkaraMahkemeleri 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        sozlesmeTarihi : data[4],
        AnkaraMahkemeleri : data[6],
        kirayaverenAdres : data[8],
        kiralayanAdres : data[10],
        kirayaverenTel : data[12],
        kiralayanTel : data[14],
        plakaNo : data[16],
        marka : data[18],
        model : data[20],
        uretimYili : data[22],
        renk : data[24],
        id : data[26],
        baslangicTarihi : data[28],
        bitisTarihi : data[30],
        ucret : data[32],
        teslimatNoktasi : data[34],
        contractId : data[36],
        parties : data[38]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
20:04:53 - [34mdebug[39m: fromDirectory
20:04:53 - [34mdebug[39m: fromDirectory
20:04:53 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"13cdbbf5-ba8a-4ecb-b287-348d2ef36ca5","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","AnkaraMahkemeleri":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
20:04:53 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"13cdbbf5-ba8a-4ecb-b287-348d2ef36ca5","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","AnkaraMahkemeleri":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
20:04:53 - [31merror[39m: Instance com.tr.carrental.MyContract#13cdbbf5-ba8a-4ecb-b287-348d2ef36ca5 missing required field sozlesmeTarihi
ValidationException: Instance com.tr.carrental.MyContract#13cdbbf5-ba8a-4ecb-b287-348d2ef36ca5 missing required field sozlesmeTarihi
    at Function.reportMissingRequiredProperty (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer/resourcevalidator.js:481:15)
    at ResourceValidator.visitClassDeclaration (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer/resourcevalidator.js:179:39)
    at ResourceValidator.visit (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer/resourcevalidator.js:74:25)
    at AssetDeclaration.accept (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/introspect/decorated.js:65:24)
    at ValidatedResource.validate (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/model/validatedresource.js:124:26)
    at Serializer.fromJSON (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer.js:184:22)
    at Clause.setData (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:62:61)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:113:14)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
20:04:53 - [32minfo[39m: undefined
20:05:21 - [32minfo[39m: Using current directory as template folder
20:05:21 - [32minfo[39m: Loading a default sample.txt file.
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: constructor
20:05:21 - [34mdebug[39m: constructor
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processDirectory
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: fromDirectory
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:21 - [34mdebug[39m: isFileInNodeModuleDir
20:05:21 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: fromDirectory
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processDirectory
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: fromDirectory
20:05:23 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



20:05:23 - [34mdebug[39m: fromDirectory
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: isFileInNodeModuleDir
20:05:23 - [34mdebug[39m: processFile
20:05:23 - [34mdebug[39m: fromDirectory
20:05:23 - [34mdebug[39m: buildGrammar
20:05:23 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}]}
20:05:23 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
20:05:23 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
20:05:23 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
20:05:23 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
20:05:23 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
20:05:23 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
20:05:23 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
20:05:23 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
20:05:23 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
20:05:23 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
20:05:23 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
20:05:24 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
20:05:24 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
20:05:24 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
20:05:24 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
20:05:24 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
20:05:24 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
20:05:24 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
20:05:24 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
20:05:24 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
20:05:24 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
20:05:24 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
20:05:24 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
20:05:24 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
20:05:24 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
20:05:24 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
20:05:24 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
20:05:24 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
20:05:24 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
20:05:24 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
20:05:24 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
20:05:24 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
20:05:24 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
20:05:24 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
20:05:24 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
20:05:24 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
20:05:24 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
20:05:24 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"AnkaraMahkemeleri","text":"AnkaraMahkemeleri","offset":1657,"lineBreaks":0,"line":44,"col":64}}
20:05:24 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1676,"lineBreaks":1,"line":44,"col":83}
20:05:24 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "3dc91999-cac2-45dc-843e-874d611d317b",
        kirayaveren : rule1,
        kiralayan : rule7,
        AnkaraMahkemeleri : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # AnkaraMahkemeleri 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        AnkaraMahkemeleri : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
20:05:24 - [34mdebug[39m: fromDirectory
20:05:24 - [34mdebug[39m: fromDirectory
20:05:24 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"3dc91999-cac2-45dc-843e-874d611d317b","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","AnkaraMahkemeleri":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
20:05:24 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"3dc91999-cac2-45dc-843e-874d611d317b","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","AnkaraMahkemeleri":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
20:05:24 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m3dc91999-cac2-45dc-843e-874d611d317b[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaveren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32mAnkaraMahkemeleri[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
20:11:48 - [32minfo[39m: Using current directory as template folder
20:11:48 - [32minfo[39m: Loading a default sample.txt file.
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: constructor
20:11:48 - [34mdebug[39m: constructor
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processDirectory
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: fromDirectory
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:48 - [34mdebug[39m: isFileInNodeModuleDir
20:11:48 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: fromDirectory
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processDirectory
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: fromDirectory
20:11:49 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



20:11:49 - [34mdebug[39m: fromDirectory
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: isFileInNodeModuleDir
20:11:49 - [34mdebug[39m: processFile
20:11:49 - [34mdebug[39m: fromDirectory
20:11:49 - [34mdebug[39m: buildGrammar
20:11:49 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
20:11:49 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
20:11:49 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
20:11:49 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
20:11:49 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
20:11:49 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
20:11:49 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
20:11:49 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
20:11:49 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
20:11:49 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
20:11:49 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
20:11:49 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
20:11:49 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
20:11:49 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
20:11:49 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
20:11:49 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
20:11:49 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
20:11:49 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
20:11:49 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
20:11:49 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
20:11:49 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
20:11:49 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
20:11:49 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
20:11:49 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
20:11:49 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
20:11:49 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
20:11:49 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
20:11:49 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
20:11:49 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
20:11:49 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
20:11:49 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
20:11:49 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
20:11:49 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
20:11:49 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
20:11:49 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
20:11:49 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
20:11:49 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
20:11:49 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
20:11:49 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
20:11:49 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
20:11:49 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "45a84899-8e71-4225-809d-7e0a314b33c2",
        kirayaveren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
20:11:49 - [34mdebug[39m: fromDirectory
20:11:49 - [34mdebug[39m: fromDirectory
20:11:49 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"45a84899-8e71-4225-809d-7e0a314b33c2","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
20:11:49 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"45a84899-8e71-4225-809d-7e0a314b33c2","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
20:11:49 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m45a84899-8e71-4225-809d-7e0a314b33c2[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaveren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
21:27:25 - [32minfo[39m: Using current directory as template folder
21:27:25 - [32minfo[39m: Loading a default sample.txt file.
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: constructor
21:27:25 - [34mdebug[39m: constructor
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processDirectory
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: fromDirectory
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:25 - [34mdebug[39m: isFileInNodeModuleDir
21:27:25 - [34mdebug[39m: processFile
21:27:26 - [34mdebug[39m: fromDirectory
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: processDirectory
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: processFile
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: processFile
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: processFile
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: processFile
21:27:26 - [34mdebug[39m: isFileInNodeModuleDir
21:27:26 - [34mdebug[39m: processFile
21:27:26 - [34mdebug[39m: fromDirectory
21:27:27 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



21:27:27 - [34mdebug[39m: fromDirectory
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: isFileInNodeModuleDir
21:27:27 - [34mdebug[39m: processFile
21:27:27 - [34mdebug[39m: fromDirectory
21:27:27 - [34mdebug[39m: buildGrammar
21:27:27 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
21:27:27 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
21:27:27 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
21:27:27 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
21:27:27 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
21:27:27 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
21:27:27 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
21:27:27 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
21:27:27 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
21:27:27 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
21:27:27 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
21:27:27 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
21:27:27 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
21:27:27 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
21:27:27 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
21:27:27 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
21:27:27 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
21:27:27 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
21:27:27 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
21:27:27 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
21:27:27 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
21:27:27 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
21:27:27 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
21:27:27 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
21:27:27 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
21:27:27 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
21:27:27 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
21:27:27 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
21:27:27 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
21:27:27 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
21:27:27 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
21:27:27 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
21:27:27 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
21:27:27 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
21:27:27 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
21:27:27 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
21:27:27 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
21:27:27 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
21:27:27 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
21:27:27 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
21:27:27 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "8546ea68-a550-430d-a434-bbd61c13575c",
        kirayaveren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
21:27:27 - [34mdebug[39m: fromDirectory
21:27:27 - [34mdebug[39m: fromDirectory
21:27:27 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"8546ea68-a550-430d-a434-bbd61c13575c","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
21:27:27 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"8546ea68-a550-430d-a434-bbd61c13575c","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
21:27:27 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m8546ea68-a550-430d-a434-bbd61c13575c[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaveren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
21:39:43 - [32minfo[39m: Using current directory as template folder
21:39:43 - [32minfo[39m: Loading a default sample.txt file.
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: constructor
21:39:43 - [34mdebug[39m: constructor
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processDirectory
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: fromDirectory
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:43 - [34mdebug[39m: isFileInNodeModuleDir
21:39:43 - [34mdebug[39m: processFile
21:39:44 - [34mdebug[39m: fromDirectory
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: processDirectory
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: processFile
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: processFile
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: processFile
21:39:44 - [34mdebug[39m: isFileInNodeModuleDir
21:39:44 - [34mdebug[39m: processFile
21:39:44 - [34mdebug[39m: fromDirectory
21:39:45 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



21:39:45 - [34mdebug[39m: fromDirectory
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: isFileInNodeModuleDir
21:39:45 - [34mdebug[39m: processFile
21:39:45 - [34mdebug[39m: fromDirectory
21:39:45 - [34mdebug[39m: buildGrammar
21:39:45 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
21:39:45 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
21:39:45 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
21:39:45 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
21:39:45 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
21:39:45 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
21:39:45 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
21:39:45 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
21:39:45 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
21:39:45 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
21:39:45 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
21:39:45 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
21:39:45 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
21:39:45 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
21:39:45 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
21:39:45 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
21:39:45 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
21:39:45 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
21:39:45 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
21:39:45 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
21:39:45 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
21:39:45 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
21:39:45 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
21:39:45 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
21:39:45 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
21:39:45 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
21:39:45 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
21:39:45 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
21:39:45 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
21:39:45 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
21:39:45 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
21:39:45 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
21:39:45 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
21:39:45 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
21:39:45 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
21:39:45 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
21:39:45 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
21:39:45 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
21:39:45 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
21:39:45 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
21:39:45 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "8ca6f014-543b-45f6-804e-6f743efd8cc7",
        kirayaveren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
21:39:45 - [34mdebug[39m: fromDirectory
21:39:45 - [34mdebug[39m: fromDirectory
21:39:45 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"8ca6f014-543b-45f6-804e-6f743efd8cc7","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
21:39:45 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"8ca6f014-543b-45f6-804e-6f743efd8cc7","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
21:39:45 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m8ca6f014-543b-45f6-804e-6f743efd8cc7[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaveren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
21:42:59 - [32minfo[39m: Using current directory as template folder
21:42:59 - [32minfo[39m: Loading a default sample.txt file.
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: constructor
21:42:59 - [34mdebug[39m: constructor
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processDirectory
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: fromDirectory
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:42:59 - [34mdebug[39m: isFileInNodeModuleDir
21:42:59 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: fromDirectory
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processDirectory
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: fromDirectory
21:43:01 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



21:43:01 - [34mdebug[39m: fromDirectory
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: isFileInNodeModuleDir
21:43:01 - [34mdebug[39m: processFile
21:43:01 - [34mdebug[39m: fromDirectory
21:43:01 - [34mdebug[39m: buildGrammar
21:43:01 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
21:43:01 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
21:43:01 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaveren","text":"kirayaveren","offset":74,"lineBreaks":0,"line":5,"col":37}}
21:43:01 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
21:43:01 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
21:43:01 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
21:43:01 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
21:43:01 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
21:43:01 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
21:43:01 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
21:43:01 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
21:43:01 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
21:43:01 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
21:43:01 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
21:43:01 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
21:43:01 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
21:43:01 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
21:43:01 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
21:43:01 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
21:43:01 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
21:43:01 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
21:43:01 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
21:43:01 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
21:43:01 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
21:43:01 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
21:43:01 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
21:43:01 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
21:43:01 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
21:43:01 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
21:43:01 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
21:43:01 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
21:43:01 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
21:43:01 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
21:43:01 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
21:43:01 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
21:43:01 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
21:43:01 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
21:43:01 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
21:43:01 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
21:43:01 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
21:43:01 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "59591b57-cd28-45fe-be40-e710f8c62e73",
        kirayaveren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaveren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaveren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
21:43:01 - [34mdebug[39m: fromDirectory
21:43:01 - [34mdebug[39m: fromDirectory
21:43:01 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"59591b57-cd28-45fe-be40-e710f8c62e73","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
21:43:01 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"59591b57-cd28-45fe-be40-e710f8c62e73","kirayaveren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
21:43:01 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m59591b57-cd28-45fe-be40-e710f8c62e73[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaveren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
22:17:16 - [32minfo[39m: Using current directory as template folder
22:17:16 - [32minfo[39m: Loading a default sample.txt file.
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: constructor
22:17:16 - [34mdebug[39m: constructor
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processDirectory
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: fromDirectory
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:16 - [34mdebug[39m: isFileInNodeModuleDir
22:17:16 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: fromDirectory
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processDirectory
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: fromDirectory
22:17:17 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



22:17:17 - [34mdebug[39m: fromDirectory
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: isFileInNodeModuleDir
22:17:17 - [34mdebug[39m: processFile
22:17:17 - [34mdebug[39m: fromDirectory
22:17:17 - [34mdebug[39m: buildGrammar
22:17:17 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
22:17:17 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
22:17:17 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
22:17:17 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
22:17:17 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
22:17:17 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
22:17:17 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
22:17:17 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
22:17:17 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
22:17:17 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
22:17:17 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
22:17:17 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
22:17:17 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
22:17:17 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
22:17:17 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
22:17:17 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
22:17:17 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
22:17:17 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
22:17:18 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
22:17:18 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
22:17:18 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
22:17:18 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
22:17:18 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
22:17:18 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
22:17:18 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
22:17:18 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
22:17:18 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
22:17:18 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
22:17:18 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
22:17:18 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
22:17:18 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
22:17:18 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
22:17:18 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
22:17:18 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
22:17:18 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
22:17:18 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
22:17:18 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
22:17:18 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
22:17:18 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
22:17:18 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
22:17:18 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "dcc8ce10-efce-4033-b9cc-fc1d66fed9d1",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
22:17:18 - [34mdebug[39m: fromDirectory
22:17:18 - [34mdebug[39m: fromDirectory
22:17:18 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"dcc8ce10-efce-4033-b9cc-fc1d66fed9d1","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
22:17:18 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"dcc8ce10-efce-4033-b9cc-fc1d66fed9d1","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
22:17:18 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35mdcc8ce10-efce-4033-b9cc-fc1d66fed9d1[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaVeren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
22:43:54 - [32minfo[39m: Using current directory as template folder
22:43:54 - [32minfo[39m: Loading a default sample.txt file.
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: constructor
22:43:54 - [34mdebug[39m: constructor
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processDirectory
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: fromDirectory
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:54 - [34mdebug[39m: isFileInNodeModuleDir
22:43:54 - [34mdebug[39m: processFile
22:43:58 - [34mdebug[39m: fromDirectory
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: processDirectory
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: processFile
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: processFile
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: processFile
22:43:58 - [34mdebug[39m: isFileInNodeModuleDir
22:43:58 - [34mdebug[39m: processFile
22:43:58 - [34mdebug[39m: fromDirectory
22:43:59 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



22:43:59 - [34mdebug[39m: fromDirectory
22:43:59 - [34mdebug[39m: isFileInNodeModuleDir
22:43:59 - [34mdebug[39m: processFile
22:43:59 - [34mdebug[39m: isFileInNodeModuleDir
22:43:59 - [34mdebug[39m: processFile
22:43:59 - [34mdebug[39m: isFileInNodeModuleDir
22:43:59 - [34mdebug[39m: processFile
22:43:59 - [34mdebug[39m: isFileInNodeModuleDir
22:43:59 - [34mdebug[39m: processFile
22:43:59 - [34mdebug[39m: isFileInNodeModuleDir
22:43:59 - [34mdebug[39m: processFile
22:43:59 - [34mdebug[39m: fromDirectory
22:43:59 - [34mdebug[39m: buildGrammar
22:43:59 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
22:43:59 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
22:43:59 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
22:43:59 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
22:43:59 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
22:43:59 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
22:43:59 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
22:43:59 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
22:43:59 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
22:43:59 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
22:43:59 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
22:43:59 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
22:43:59 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
22:43:59 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
22:43:59 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
22:43:59 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
22:43:59 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
22:43:59 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
22:43:59 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
22:43:59 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
22:43:59 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
22:43:59 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
22:43:59 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
22:43:59 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
22:43:59 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
22:43:59 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
22:43:59 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
22:43:59 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
22:43:59 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
22:43:59 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
22:43:59 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
22:43:59 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
22:43:59 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
22:43:59 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
22:43:59 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
22:43:59 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
22:43:59 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
22:43:59 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
22:43:59 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
22:43:59 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
22:43:59 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "092d1f6e-8a88-47f1-9c40-8cc4222326e7",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
22:43:59 - [34mdebug[39m: fromDirectory
22:43:59 - [34mdebug[39m: fromDirectory
22:43:59 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"092d1f6e-8a88-47f1-9c40-8cc4222326e7","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
22:43:59 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"092d1f6e-8a88-47f1-9c40-8cc4222326e7","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
22:43:59 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m092d1f6e-8a88-47f1-9c40-8cc4222326e7[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaVeren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
08:20:29 - [32minfo[39m: Using current directory as template folder
08:20:29 - [32minfo[39m: Loading a default sample.txt file.
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: constructor
08:20:29 - [34mdebug[39m: constructor
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processDirectory
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: fromDirectory
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:29 - [34mdebug[39m: isFileInNodeModuleDir
08:20:29 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: fromDirectory
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processDirectory
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: fromDirectory
08:20:31 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



08:20:31 - [34mdebug[39m: fromDirectory
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: isFileInNodeModuleDir
08:20:31 - [34mdebug[39m: processFile
08:20:31 - [34mdebug[39m: fromDirectory
08:20:31 - [34mdebug[39m: buildGrammar
08:20:31 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
08:20:31 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
08:20:31 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
08:20:31 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
08:20:31 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
08:20:31 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
08:20:31 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
08:20:31 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
08:20:31 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
08:20:31 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
08:20:31 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
08:20:31 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
08:20:31 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
08:20:31 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
08:20:31 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
08:20:31 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
08:20:31 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
08:20:31 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
08:20:32 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
08:20:32 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
08:20:32 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
08:20:32 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
08:20:32 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
08:20:32 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
08:20:32 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
08:20:32 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
08:20:32 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
08:20:32 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
08:20:32 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
08:20:32 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
08:20:32 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
08:20:32 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
08:20:32 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
08:20:32 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
08:20:32 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
08:20:32 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
08:20:32 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
08:20:32 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
08:20:32 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
08:20:32 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
08:20:32 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "cdb19a93-aa79-4ee9-8ab8-5f0745ae5117",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
08:20:32 - [34mdebug[39m: fromDirectory
08:20:32 - [34mdebug[39m: fromDirectory
08:20:32 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"cdb19a93-aa79-4ee9-8ab8-5f0745ae5117","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
08:20:32 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"cdb19a93-aa79-4ee9-8ab8-5f0745ae5117","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
08:20:32 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35mcdb19a93-aa79-4ee9-8ab8-5f0745ae5117[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaVeren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
08:25:26 - [32minfo[39m: Using current directory as template folder
08:25:26 - [32minfo[39m: Loading a default sample.txt file.
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: constructor
08:25:26 - [34mdebug[39m: constructor
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processDirectory
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: fromDirectory
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:26 - [34mdebug[39m: isFileInNodeModuleDir
08:25:26 - [34mdebug[39m: processFile
08:25:30 - [34mdebug[39m: fromDirectory
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: processDirectory
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: processFile
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: processFile
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: processFile
08:25:30 - [34mdebug[39m: isFileInNodeModuleDir
08:25:30 - [34mdebug[39m: processFile
08:25:30 - [34mdebug[39m: fromDirectory
08:25:30 - [31merror[39m: In: /Users/serkanerkan/cicero-template-library/src/car-rental-tr/lib/logic.ergo [Cannot find type with name 'MyRequest']
Error: In: /Users/serkanerkan/cicero-template-library/src/car-rental-tr/lib/logic.ergo [Cannot find type with name 'MyRequest']
    at Object.process (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:969:35)
    at Function.processFile (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1054:27)
    at items.forEach (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1039:22)
    at Array.forEach (<anonymous>)
    at Function.processDirectory (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1038:15)
    at template.getModelManager.updateExternalModels.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:945:22)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
08:25:30 - [32minfo[39m: undefined
08:26:07 - [32minfo[39m: Using current directory as template folder
08:26:07 - [32minfo[39m: Loading a default sample.txt file.
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: constructor
08:26:07 - [34mdebug[39m: constructor
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processDirectory
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: fromDirectory
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:07 - [34mdebug[39m: isFileInNodeModuleDir
08:26:07 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: fromDirectory
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processDirectory
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: fromDirectory
08:26:10 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



08:26:10 - [34mdebug[39m: fromDirectory
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: isFileInNodeModuleDir
08:26:10 - [34mdebug[39m: processFile
08:26:10 - [34mdebug[39m: fromDirectory
08:26:10 - [34mdebug[39m: buildGrammar
08:26:10 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
08:26:10 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
08:26:10 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
08:26:10 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
08:26:10 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
08:26:10 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
08:26:10 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
08:26:10 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
08:26:10 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
08:26:10 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
08:26:10 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
08:26:10 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
08:26:10 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
08:26:10 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
08:26:10 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
08:26:10 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
08:26:10 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
08:26:10 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
08:26:10 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
08:26:10 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
08:26:10 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
08:26:10 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
08:26:10 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
08:26:10 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
08:26:10 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
08:26:10 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
08:26:10 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
08:26:10 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
08:26:10 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
08:26:10 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
08:26:10 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
08:26:10 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
08:26:10 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
08:26:10 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
08:26:10 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
08:26:10 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
08:26:10 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
08:26:10 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
08:26:10 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
08:26:10 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
08:26:10 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "16508a03-ff42-41eb-ae46-9a83d68de477",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
08:26:10 - [34mdebug[39m: fromDirectory
08:26:10 - [34mdebug[39m: fromDirectory
08:26:10 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"16508a03-ff42-41eb-ae46-9a83d68de477","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
08:26:10 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"16508a03-ff42-41eb-ae46-9a83d68de477","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
08:26:10 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m16508a03-ff42-41eb-ae46-9a83d68de477[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaVeren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
10:04:49 - [32minfo[39m: Using current directory as template folder
10:04:49 - [32minfo[39m: Loading a default sample.txt file.
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: constructor
10:04:49 - [34mdebug[39m: constructor
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processDirectory
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: fromDirectory
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:49 - [34mdebug[39m: isFileInNodeModuleDir
10:04:49 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: fromDirectory
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processDirectory
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: fromDirectory
10:04:54 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



10:04:54 - [34mdebug[39m: fromDirectory
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: isFileInNodeModuleDir
10:04:54 - [34mdebug[39m: processFile
10:04:54 - [34mdebug[39m: fromDirectory
10:04:54 - [34mdebug[39m: buildGrammar
10:04:54 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
10:04:54 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
10:04:54 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
10:04:54 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
10:04:54 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
10:04:54 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
10:04:54 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
10:04:54 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
10:04:54 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
10:04:54 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
10:04:54 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
10:04:54 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
10:04:54 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
10:04:54 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
10:04:54 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
10:04:54 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
10:04:54 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
10:04:54 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
10:04:54 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
10:04:54 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
10:04:54 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
10:04:54 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
10:04:54 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
10:04:54 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
10:04:54 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
10:04:54 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
10:04:54 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
10:04:54 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
10:04:54 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
10:04:54 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
10:04:54 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
10:04:54 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
10:04:54 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
10:04:54 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
10:04:54 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
10:04:54 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
10:04:54 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
10:04:54 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
10:04:54 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
10:04:54 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
10:04:54 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "69ccda25-15a8-4fa7-8e3d-3b075022ece9",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
10:04:54 - [34mdebug[39m: fromDirectory
10:04:54 - [34mdebug[39m: fromDirectory
10:04:54 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"69ccda25-15a8-4fa7-8e3d-3b075022ece9","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:04:54 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"69ccda25-15a8-4fa7-8e3d-3b075022ece9","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:04:54 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m69ccda25-15a8-4fa7-8e3d-3b075022ece9[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaVeren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
10:05:05 - [32minfo[39m: Using current directory as template folder
10:05:05 - [32minfo[39m: Loading a default sample.txt file.
10:05:05 - [32minfo[39m: Loading a single default request.json file.
10:05:05 - [32minfo[39m: Loading a default state.json file.
10:05:05 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: constructor
10:05:05 - [34mdebug[39m: constructor
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processDirectory
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: fromDirectory
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:05 - [34mdebug[39m: isFileInNodeModuleDir
10:05:05 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: fromDirectory
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processDirectory
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: fromDirectory
10:05:09 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



10:05:09 - [34mdebug[39m: fromDirectory
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: isFileInNodeModuleDir
10:05:09 - [34mdebug[39m: processFile
10:05:09 - [34mdebug[39m: fromDirectory
10:05:09 - [34mdebug[39m: buildGrammar
10:05:09 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
10:05:09 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
10:05:09 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
10:05:09 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
10:05:09 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
10:05:09 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
10:05:09 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
10:05:09 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
10:05:09 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
10:05:09 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
10:05:09 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
10:05:09 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
10:05:09 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
10:05:09 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
10:05:09 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
10:05:09 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
10:05:09 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
10:05:09 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
10:05:09 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
10:05:09 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
10:05:09 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
10:05:09 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
10:05:09 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
10:05:09 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
10:05:09 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
10:05:09 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
10:05:09 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
10:05:09 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
10:05:09 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
10:05:09 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
10:05:09 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
10:05:09 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
10:05:09 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
10:05:09 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
10:05:09 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
10:05:09 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
10:05:09 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
10:05:09 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
10:05:09 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
10:05:09 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
10:05:09 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "ac9af22b-3e04-4bd4-80e1-d2c16519c958",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
10:05:09 - [34mdebug[39m: fromDirectory
10:05:09 - [34mdebug[39m: fromDirectory
10:05:09 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"ac9af22b-3e04-4bd4-80e1-d2c16519c958","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:05:09 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"ac9af22b-3e04-4bd4-80e1-d2c16519c958","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:05:09 - [34mdebug[39m: Engine processing request com.tr.carrental.MyRequest with state org.accordproject.cicero.contract.AccordContractState
10:05:09 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'com.tr.carrental.MyRequest':
                let type0 = 'com.tr.carrental.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                comXtrXcarrentalXMyLogic_helloworld(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
10:05:09 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
10:05:09 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-530b443eb74ea8a873e3155bd64687cd1b731b453849b93c1f3b5f60ca662241[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mWorld[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mHello undefined World[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35maf41d319-b519-47aa-9f03-418d79128cdd[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-26T07:05:09.586Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35ma2adbebd-b7f0-47f8-bb5b-f68209f3d8ce[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
10:17:36 - [32minfo[39m: Using current directory as template folder
10:17:36 - [32minfo[39m: Loading a default sample.txt file.
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: constructor
10:17:36 - [34mdebug[39m: constructor
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processDirectory
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: fromDirectory
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:36 - [34mdebug[39m: isFileInNodeModuleDir
10:17:36 - [34mdebug[39m: processFile
10:17:40 - [34mdebug[39m: fromDirectory
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: processDirectory
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: processFile
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: processFile
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: processFile
10:17:40 - [34mdebug[39m: isFileInNodeModuleDir
10:17:40 - [34mdebug[39m: processFile
10:17:40 - [34mdebug[39m: fromDirectory
10:17:41 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



10:17:41 - [34mdebug[39m: fromDirectory
10:17:41 - [34mdebug[39m: isFileInNodeModuleDir
10:17:41 - [34mdebug[39m: processFile
10:17:41 - [34mdebug[39m: isFileInNodeModuleDir
10:17:41 - [34mdebug[39m: processFile
10:17:41 - [34mdebug[39m: isFileInNodeModuleDir
10:17:41 - [34mdebug[39m: processFile
10:17:41 - [34mdebug[39m: isFileInNodeModuleDir
10:17:41 - [34mdebug[39m: processFile
10:17:41 - [34mdebug[39m: isFileInNodeModuleDir
10:17:41 - [34mdebug[39m: processFile
10:17:41 - [34mdebug[39m: fromDirectory
10:17:41 - [34mdebug[39m: buildGrammar
10:17:41 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
10:17:41 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
10:17:41 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
10:17:41 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
10:17:41 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
10:17:41 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
10:17:41 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
10:17:41 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
10:17:41 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
10:17:41 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
10:17:41 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
10:17:41 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
10:17:41 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
10:17:41 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
10:17:41 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
10:17:41 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
10:17:41 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
10:17:41 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
10:17:41 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
10:17:41 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
10:17:41 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
10:17:41 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
10:17:41 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
10:17:41 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
10:17:41 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
10:17:41 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
10:17:41 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
10:17:41 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
10:17:41 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
10:17:41 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
10:17:41 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
10:17:41 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
10:17:41 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
10:17:41 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
10:17:41 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
10:17:41 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
10:17:41 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
10:17:41 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
10:17:41 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
10:17:41 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
10:17:41 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "f5cd8910-9436-4fee-9d72-cd72aa1b2434",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
10:17:41 - [34mdebug[39m: fromDirectory
10:17:41 - [34mdebug[39m: fromDirectory
10:17:41 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"f5cd8910-9436-4fee-9d72-cd72aa1b2434","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:17:41 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"f5cd8910-9436-4fee-9d72-cd72aa1b2434","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:17:41 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35mf5cd8910-9436-4fee-9d72-cd72aa1b2434[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaVeren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
10:17:48 - [32minfo[39m: Using current directory as template folder
10:17:48 - [32minfo[39m: Loading a default sample.txt file.
10:17:48 - [32minfo[39m: Loading a single default request.json file.
10:17:48 - [32minfo[39m: Loading a default state.json file.
10:17:48 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: constructor
10:17:48 - [34mdebug[39m: constructor
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processDirectory
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: fromDirectory
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:48 - [34mdebug[39m: isFileInNodeModuleDir
10:17:48 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: fromDirectory
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processDirectory
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: fromDirectory
10:17:53 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



10:17:53 - [34mdebug[39m: fromDirectory
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: isFileInNodeModuleDir
10:17:53 - [34mdebug[39m: processFile
10:17:53 - [34mdebug[39m: fromDirectory
10:17:53 - [34mdebug[39m: buildGrammar
10:17:53 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
10:17:53 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
10:17:53 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
10:17:53 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
10:17:53 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
10:17:53 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
10:17:53 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
10:17:53 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
10:17:53 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
10:17:53 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
10:17:53 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
10:17:53 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
10:17:53 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
10:17:53 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
10:17:53 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
10:17:53 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
10:17:53 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
10:17:53 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
10:17:54 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
10:17:54 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
10:17:54 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
10:17:54 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
10:17:54 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
10:17:54 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
10:17:54 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
10:17:54 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
10:17:54 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
10:17:54 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
10:17:54 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
10:17:54 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
10:17:54 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
10:17:54 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
10:17:54 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
10:17:54 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
10:17:54 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
10:17:54 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
10:17:54 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
10:17:54 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
10:17:54 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
10:17:54 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
10:17:54 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "dcc63729-ffdc-4ecd-85bc-2a5d1ab8ac87",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
10:17:54 - [34mdebug[39m: fromDirectory
10:17:54 - [34mdebug[39m: fromDirectory
10:17:54 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"dcc63729-ffdc-4ecd-85bc-2a5d1ab8ac87","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:17:54 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"dcc63729-ffdc-4ecd-85bc-2a5d1ab8ac87","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:17:54 - [34mdebug[39m: Engine processing request com.tr.carrental.MyRequest with state org.accordproject.cicero.contract.AccordContractState
10:17:54 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'com.tr.carrental.MyRequest':
                let type0 = 'com.tr.carrental.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                comXtrXcarrentalXMyLogic_helloworld(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
10:17:54 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
10:17:54 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-4da6eed53cab53c1bcf93eaf5a7ff4076f9725f96fc259ded57f1d6350ec139d[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mWorld[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mHello undefined World[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35ma7348061-01ab-4394-a6b8-2f45ffb26c57[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-26T07:17:54.113Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35mc4bc5d00-faf7-43e1-b343-661fbab6ae98[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
10:27:24 - [32minfo[39m: Using current directory as template folder
10:27:24 - [32minfo[39m: Loading a default sample.txt file.
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: constructor
10:27:24 - [34mdebug[39m: constructor
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processDirectory
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: fromDirectory
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:24 - [34mdebug[39m: isFileInNodeModuleDir
10:27:24 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: fromDirectory
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processDirectory
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: fromDirectory
10:27:30 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



10:27:30 - [34mdebug[39m: fromDirectory
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: isFileInNodeModuleDir
10:27:30 - [34mdebug[39m: processFile
10:27:30 - [34mdebug[39m: fromDirectory
10:27:30 - [34mdebug[39m: buildGrammar
10:27:30 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
10:27:30 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
10:27:30 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
10:27:30 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
10:27:30 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
10:27:30 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
10:27:30 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
10:27:30 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
10:27:30 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
10:27:30 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
10:27:30 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
10:27:30 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
10:27:30 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
10:27:30 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
10:27:30 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
10:27:30 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
10:27:30 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
10:27:30 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
10:27:31 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
10:27:31 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
10:27:31 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
10:27:31 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
10:27:31 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
10:27:31 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
10:27:31 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
10:27:31 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
10:27:31 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
10:27:31 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
10:27:31 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
10:27:31 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
10:27:31 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
10:27:31 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
10:27:31 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
10:27:31 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
10:27:31 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
10:27:31 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
10:27:31 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
10:27:31 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
10:27:31 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
10:27:31 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
10:27:31 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "f200217d-2008-422c-8a4c-f5eb79873e24",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
10:27:31 - [34mdebug[39m: fromDirectory
10:27:31 - [34mdebug[39m: fromDirectory
10:27:31 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"f200217d-2008-422c-8a4c-f5eb79873e24","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:27:31 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"f200217d-2008-422c-8a4c-f5eb79873e24","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:27:31 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35mf200217d-2008-422c-8a4c-f5eb79873e24[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaVeren[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayan[39m[33m"[39m[33m: [39m[33m"[39m[35mCan Doğan[39m[33m"[39m[33m,[39m
  [33m"[39m[32myetkiliMahkeme[39m[33m"[39m[33m: [39m[33m"[39m[35mAnkara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mDikmen Caddesi No:48/15 Dikmen Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanAdres[39m[33m"[39m[33m: [39m[33m"[39m[35mJohn F. Kennedy Sokak No:23/12 Kavaklıdere Ankara[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkirayaverenTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901231231234[39m[33m"[39m[33m,[39m
  [33m"[39m[32mkiralayanTel[39m[33m"[39m[33m: [39m[33m"[39m[35m+901234567890[39m[33m"[39m[33m,[39m
  [33m"[39m[32mplakaNo[39m[33m"[39m[33m: [39m[33m"[39m[35m06 MX 7817[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmarka[39m[33m"[39m[33m: [39m[33m"[39m[35mVolkswagen[39m[33m"[39m[33m,[39m
  [33m"[39m[32mmodel[39m[33m"[39m[33m: [39m[33m"[39m[35mGolf 1.6 TDI Comfortline[39m[33m"[39m[33m,[39m
  [33m"[39m[32muretimYili[39m[33m"[39m[33m: [39m[33m"[39m[35m2017[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrenk[39m[33m"[39m[33m: [39m[33m"[39m[35mKırmızı[39m[33m"[39m[33m,[39m
  [33m"[39m[32mid[39m[33m"[39m[33m: [39m[33m"[39m[35mWVWZZZ3CZXW000001[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbaslangicTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m14.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbitisTarihi[39m[33m"[39m[33m: [39m[33m"[39m[35m17.07.2018[39m[33m"[39m[33m,[39m
  [33m"[39m[32mucret[39m[33m"[39m[33m: [39m[33m"[39m[35m730,00 TL[39m[33m"[39m[33m,[39m
  [33m"[39m[32mteslimatNoktasi[39m[33m"[39m[33m: [39m[33m"[39m[35mAcme Car Rental Merkez Ofis[39m[33m"[39m
[33m}[39m
10:27:36 - [32minfo[39m: Using current directory as template folder
10:27:36 - [32minfo[39m: Loading a default sample.txt file.
10:27:36 - [32minfo[39m: Loading a single default request.json file.
10:27:36 - [32minfo[39m: Loading a default state.json file.
10:27:36 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: constructor
10:27:36 - [34mdebug[39m: constructor
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processDirectory
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: fromDirectory
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:36 - [34mdebug[39m: isFileInNodeModuleDir
10:27:36 - [34mdebug[39m: processFile
10:27:42 - [34mdebug[39m: fromDirectory
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: processDirectory
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: processFile
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: processFile
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: processFile
10:27:42 - [34mdebug[39m: isFileInNodeModuleDir
10:27:42 - [34mdebug[39m: processFile
10:27:42 - [34mdebug[39m: fromDirectory
10:27:43 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {com.tr.carrental.MyRequest} context.request - the incoming request
 * @param {com.tr.carrental.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function comXtrXcarrentalXMyLogic_helloworld(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new comXtrXcarrentalXMyLogic().helloworld(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class comXtrXcarrentalXMyLogic {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["com.tr.carrental.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["com.tr.carrental.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  helloworld(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["com.tr.carrental.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



10:27:43 - [34mdebug[39m: fromDirectory
10:27:43 - [34mdebug[39m: isFileInNodeModuleDir
10:27:43 - [34mdebug[39m: processFile
10:27:43 - [34mdebug[39m: isFileInNodeModuleDir
10:27:43 - [34mdebug[39m: processFile
10:27:43 - [34mdebug[39m: isFileInNodeModuleDir
10:27:43 - [34mdebug[39m: processFile
10:27:43 - [34mdebug[39m: isFileInNodeModuleDir
10:27:43 - [34mdebug[39m: processFile
10:27:43 - [34mdebug[39m: isFileInNodeModuleDir
10:27:43 - [34mdebug[39m: processFile
10:27:43 - [34mdebug[39m: fromDirectory
10:27:43 - [34mdebug[39m: buildGrammar
10:27:43 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}},{"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}},{"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36},{"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}},{"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}},{"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}},{"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}},{"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}},{"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}},{"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}},{"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42},{"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}},{"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}},{"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23},{"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}},{"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}},{"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}},{"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37},{"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}},{"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45},{"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}},{"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34},{"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}},{"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59},{"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}},{"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}]}
10:27:43 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı ","text":"OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı [{","offset":0,"lineBreaks":4,"line":1,"col":1}
10:27:43 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaVeren","text":"kirayaVeren","offset":74,"lineBreaks":0,"line":5,"col":37}}
10:27:43 - [34mdebug[39m: element rule2 {"type":"Chunk","value":"\n    1.2 Adresi ","text":"\n    1.2 Adresi [{","offset":87,"lineBreaks":1,"line":5,"col":50}
10:27:43 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenAdres","text":"kirayaverenAdres","offset":105,"lineBreaks":0,"line":6,"col":18}}
10:27:43 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"\n    1.3 Telefon ","text":"\n    1.3 Telefon [{","offset":123,"lineBreaks":1,"line":6,"col":36}
10:27:43 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"kirayaverenTel","text":"kirayaverenTel","offset":142,"lineBreaks":0,"line":7,"col":19}}
10:27:43 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı ","text":"\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı [{","offset":158,"lineBreaks":4,"line":7,"col":35}
10:27:43 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayan","text":"kiralayan","offset":240,"lineBreaks":0,"line":11,"col":34}}
10:27:43 - [34mdebug[39m: element rule8 {"type":"Chunk","value":"\n    1.5 Adresi ","text":"\n    1.5 Adresi [{","offset":251,"lineBreaks":1,"line":11,"col":45}
10:27:43 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanAdres","text":"kiralayanAdres","offset":269,"lineBreaks":0,"line":12,"col":18}}
10:27:43 - [34mdebug[39m: element rule10 {"type":"Chunk","value":"\n    1.6 Telefon ","text":"\n    1.6 Telefon [{","offset":285,"lineBreaks":1,"line":12,"col":34}
10:27:43 - [34mdebug[39m: element rule11 {"type":"Binding","fieldName":{"type":"varid","value":"kiralayanTel","text":"kiralayanTel","offset":304,"lineBreaks":0,"line":13,"col":19}}
10:27:43 - [34mdebug[39m: element rule12 {"type":"Chunk","value":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No ","text":"\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No [{","offset":318,"lineBreaks":6,"line":13,"col":33}
10:27:43 - [34mdebug[39m: element rule13 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":402,"lineBreaks":0,"line":19,"col":20}}
10:27:43 - [34mdebug[39m: element rule14 {"type":"Chunk","value":"\n    2.2 Marka ","text":"\n    2.2 Marka [{","offset":411,"lineBreaks":1,"line":19,"col":29}
10:27:43 - [34mdebug[39m: element rule15 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":428,"lineBreaks":0,"line":20,"col":17}}
10:27:43 - [34mdebug[39m: element rule16 {"type":"Chunk","value":"\n    2.3 Model ","text":"\n    2.3 Model [{","offset":435,"lineBreaks":1,"line":20,"col":24}
10:27:43 - [34mdebug[39m: element rule17 {"type":"Binding","fieldName":{"type":"varid","value":"model","text":"model","offset":452,"lineBreaks":0,"line":21,"col":17}}
10:27:43 - [34mdebug[39m: element rule18 {"type":"Chunk","value":"\n    2.4 Trafiğe Çıkış Yılı ","text":"\n    2.4 Trafiğe Çıkış Yılı [{","offset":459,"lineBreaks":1,"line":21,"col":24}
10:27:43 - [34mdebug[39m: element rule19 {"type":"Binding","fieldName":{"type":"varid","value":"uretimYili","text":"uretimYili","offset":489,"lineBreaks":0,"line":22,"col":30}}
10:27:43 - [34mdebug[39m: element rule20 {"type":"Chunk","value":"\n    2.5 Renk ","text":"\n    2.5 Renk [{","offset":501,"lineBreaks":1,"line":22,"col":42}
10:27:43 - [34mdebug[39m: element rule21 {"type":"Binding","fieldName":{"type":"varid","value":"renk","text":"renk","offset":517,"lineBreaks":0,"line":23,"col":16}}
10:27:43 - [34mdebug[39m: element rule22 {"type":"Chunk","value":"\n    2.6 Şase No ","text":"\n    2.6 Şase No [{","offset":523,"lineBreaks":1,"line":23,"col":22}
10:27:43 - [34mdebug[39m: element rule23 {"type":"Binding","fieldName":{"type":"varid","value":"id","text":"id","offset":542,"lineBreaks":0,"line":24,"col":19}}
10:27:43 - [34mdebug[39m: element rule24 {"type":"Chunk","value":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret ","text":"\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret [{","offset":546,"lineBreaks":4,"line":24,"col":23}
10:27:43 - [34mdebug[39m: element rule25 {"type":"Binding","fieldName":{"type":"varid","value":"ucret","text":"ucret","offset":587,"lineBreaks":0,"line":28,"col":17}}
10:27:43 - [34mdebug[39m: element rule26 {"type":"Chunk","value":"\n    3.2 Başlangıç Tarihi ","text":"\n    3.2 Başlangıç Tarihi [{","offset":594,"lineBreaks":1,"line":28,"col":24}
10:27:43 - [34mdebug[39m: element rule27 {"type":"Binding","fieldName":{"type":"varid","value":"baslangicTarihi","text":"baslangicTarihi","offset":622,"lineBreaks":0,"line":29,"col":28}}
10:27:43 - [34mdebug[39m: element rule28 {"type":"Chunk","value":"\n    3.3 Bitiş Tarihi ","text":"\n    3.3 Bitiş Tarihi [{","offset":639,"lineBreaks":1,"line":29,"col":45}
10:27:43 - [34mdebug[39m: element rule29 {"type":"Binding","fieldName":{"type":"varid","value":"bitisTarihi","text":"bitisTarihi","offset":663,"lineBreaks":0,"line":30,"col":24}}
10:27:43 - [34mdebug[39m: element rule30 {"type":"Chunk","value":"\n    3.4 Teslimat Noktası ","text":"\n    3.4 Teslimat Noktası [{","offset":676,"lineBreaks":1,"line":30,"col":37}
10:27:43 - [34mdebug[39m: element rule31 {"type":"Binding","fieldName":{"type":"varid","value":"teslimatNoktasi","text":"teslimatNoktasi","offset":704,"lineBreaks":0,"line":31,"col":28}}
10:27:43 - [34mdebug[39m: element rule32 {"type":"Chunk","value":"\n\n1. SÖZLEŞMENİN KONUSU ","text":"\n\n1. SÖZLEŞMENİN KONUSU [{","offset":721,"lineBreaks":2,"line":31,"col":45}
10:27:43 - [34mdebug[39m: element rule33 {"type":"Binding","fieldName":{"type":"varid","value":"plakaNo","text":"plakaNo","offset":747,"lineBreaks":0,"line":33,"col":25}}
10:27:43 - [34mdebug[39m: element rule34 {"type":"Chunk","value":" Plaka numaralı ","text":" Plaka numaralı [{","offset":756,"lineBreaks":0,"line":33,"col":34}
10:27:43 - [34mdebug[39m: element rule35 {"type":"Binding","fieldName":{"type":"varid","value":"marka","text":"marka","offset":774,"lineBreaks":0,"line":33,"col":52}}
10:27:43 - [34mdebug[39m: element rule36 {"type":"Chunk","value":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda ","text":" marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda [{","offset":781,"lineBreaks":11,"line":33,"col":59}
10:27:43 - [34mdebug[39m: element rule37 {"type":"Binding","fieldName":{"type":"varid","value":"yetkiliMahkeme","text":"yetkiliMahkeme","offset":1657,"lineBreaks":0,"line":44,"col":64}}
10:27:43 - [34mdebug[39m: element rule38 {"type":"LastChunk","value":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","text":" mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n","offset":1673,"lineBreaks":1,"line":44,"col":80}
10:27:43 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 rule11 rule12 rule13 rule14 rule15 rule16 rule17 rule18 rule19 rule20 rule21 rule22 rule23 rule24 rule25 rule26 rule27 rule28 rule29 rule30 rule31 rule32 rule33 rule34 rule35 rule36 rule37 rule38 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule17,rule18,rule19,rule20,rule21,rule22,rule23,rule24,rule25,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38 ]) => {
    return {
        $class: "com.tr.carrental.MyContract",
        contractId : "dc8357b5-019e-424f-9810-b5cc9584818b",
        kirayaVeren : rule1,
        kiralayan : rule7,
        yetkiliMahkeme : rule37,
        kirayaverenAdres : rule3,
        kiralayanAdres : rule9,
        kirayaverenTel : rule5,
        kiralayanTel : rule11,
        plakaNo : rule13,
        marka : rule15,
        model : rule17,
        uretimYili : rule19,
        renk : rule21,
        id : rule23,
        baslangicTarihi : rule27,
        bitisTarihi : rule29,
        ucret : rule25,
        teslimatNoktasi : rule31,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "OTO KİRALAMA SÖZLEŞMESİ\n\n1. TARAFLAR\n\n    1.1 Kiraya Verenin Adı Soyadı " 


rule1 -> String {% id %} # kirayaVeren 


rule2 -> "\n    1.2 Adresi " 


rule3 -> String {% id %} # kirayaverenAdres 


rule4 -> "\n    1.3 Telefon " 


rule5 -> String {% id %} # kirayaverenTel 


rule6 -> "\n\nBundan böyle KİRAYA VEREN olarak anılacaktır.\n\n    1.4 Kiralayanın Adı Soyadı " 


rule7 -> String {% id %} # kiralayan 


rule8 -> "\n    1.5 Adresi " 


rule9 -> String {% id %} # kiralayanAdres 


rule10 -> "\n    1.6 Telefon " 


rule11 -> String {% id %} # kiralayanTel 


rule12 -> "\n\nBundan böyle KİRALAYAN olarak anılacaktır.\n\n2. ARAÇ DETAYLARI\n\n    2.1 Plaka No " 


rule13 -> String {% id %} # plakaNo 


rule14 -> "\n    2.2 Marka " 


rule15 -> String {% id %} # marka 


rule16 -> "\n    2.3 Model " 


rule17 -> String {% id %} # model 


rule18 -> "\n    2.4 Trafiğe Çıkış Yılı " 


rule19 -> String {% id %} # uretimYili 


rule20 -> "\n    2.5 Renk " 


rule21 -> String {% id %} # renk 


rule22 -> "\n    2.6 Şase No " 


rule23 -> String {% id %} # id 


rule24 -> "\n\n3. KİRALAMA DETAYLARI\n\n    3.1 Ücret " 


rule25 -> String {% id %} # ucret 


rule26 -> "\n    3.2 Başlangıç Tarihi " 


rule27 -> String {% id %} # baslangicTarihi 


rule28 -> "\n    3.3 Bitiş Tarihi " 


rule29 -> String {% id %} # bitisTarihi 


rule30 -> "\n    3.4 Teslimat Noktası " 


rule31 -> String {% id %} # teslimatNoktasi 


rule32 -> "\n\n1. SÖZLEŞMENİN KONUSU " 


rule33 -> String {% id %} # plakaNo 


rule34 -> " Plaka numaralı " 


rule35 -> String {% id %} # marka 


rule36 -> " marka otomobilin KİRALAYAN'a kiraya verilmesi.\n\n2. SÖZLEŞMENİN İÇERİĞİ : Bu sözleşme tarafların taahhütlerine ve aracın kiralanması şartlarını kapsar.\n\n3. TAAHHÜTNAME : Sözleşmenin akidi olarak hareket eden KİRAYA VEREN ve KİRALAYAN aşağıda belirtiliği üzere yükümlülüklerini karşılıklı birbirlerine taahhüt edip kabul ile imzalamışlardır.\n\n4. SÖZLEŞME ŞARTLARI :\n\n    a) KİRAYA VEREN, aracı tüm fonksiyonları çalışır vaziyette KİRALAYAN'a teslim etmiştir. \n    b) Sözleşme tarihinden itibaren araçta meydana gelebilecek her türlü arıza, bakım, onarım ve yakıt giderleri KİRALAYAN'a aittir. Hiç bir surette giderlerle ilgili olarak KİRAYA VEREN'den ücret talebinde bulunulmayacaktır. KİRALAYAN aracın en iyi şekilde korunması için gereken önlemleri alacak ve her türlü bakımını süresi içerisinde yaptıracaktır.\n\nİş bu sözleşmeden doğacak herhangi bir anlaşmazlık durumunda " 


rule37 -> String {% id %} # yetkiliMahkeme 


rule38 -> " mahkemelerinin yetkili olduğunu taraflar kabul etmişlerdir.\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "com.tr.carrental.MyContract",
        kirayaVeren : data[0],
        kiralayan : data[2],
        yetkiliMahkeme : data[4],
        kirayaverenAdres : data[6],
        kiralayanAdres : data[8],
        kirayaverenTel : data[10],
        kiralayanTel : data[12],
        plakaNo : data[14],
        marka : data[16],
        model : data[18],
        uretimYili : data[20],
        renk : data[22],
        id : data[24],
        baslangicTarihi : data[26],
        bitisTarihi : data[28],
        ucret : data[30],
        teslimatNoktasi : data[32],
        contractId : data[34],
        parties : data[36]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
10:27:43 - [34mdebug[39m: fromDirectory
10:27:43 - [34mdebug[39m: fromDirectory
10:27:43 - [34mdebug[39m: Result of parsing: {"$class":"com.tr.carrental.MyContract","contractId":"dc8357b5-019e-424f-9810-b5cc9584818b","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:27:43 - [34mdebug[39m: Setting clause data: {"$class":"com.tr.carrental.MyContract","contractId":"dc8357b5-019e-424f-9810-b5cc9584818b","kirayaVeren":"Acme Car Rental","kiralayan":"Can Doğan","yetkiliMahkeme":"Ankara","kirayaverenAdres":"Dikmen Caddesi No:48/15 Dikmen Ankara","kiralayanAdres":"John F. Kennedy Sokak No:23/12 Kavaklıdere Ankara","kirayaverenTel":"+901231231234","kiralayanTel":"+901234567890","plakaNo":"06 MX 7817","marka":"Volkswagen","model":"Golf 1.6 TDI Comfortline","uretimYili":"2017","renk":"Kırmızı","id":"WVWZZZ3CZXW000001","baslangicTarihi":"14.07.2018","bitisTarihi":"17.07.2018","ucret":"730,00 TL","teslimatNoktasi":"Acme Car Rental Merkez Ofis"}
10:27:43 - [34mdebug[39m: Engine processing request com.tr.carrental.MyRequest with state org.accordproject.cicero.contract.AccordContractState
10:27:43 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'com.tr.carrental.MyRequest':
                let type0 = 'com.tr.carrental.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                comXtrXcarrentalXMyLogic_helloworld(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
10:27:43 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
10:27:43 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-8b348e5af7314a91e831da2d56b7ec79196f5ec456744b1c8766f47e2d1b26af[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mWorld[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35mcom.tr.carrental.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mHello undefined World[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35mc9f26aa2-381d-433a-a1f7-ef61f9f7d966[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-26T07:27:43.341Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35mc6b47d53-e14d-4a7a-854c-cc9225aad3e4[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
11:47:48 - [32minfo[39m: Using current directory as template folder
11:47:48 - [32minfo[39m: Loading a default sample.txt file.
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: constructor
11:47:48 - [34mdebug[39m: constructor
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processDirectory
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: fromDirectory
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:48 - [34mdebug[39m: isFileInNodeModuleDir
11:47:48 - [34mdebug[39m: processFile
11:47:51 - [34mdebug[39m: fromDirectory
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: processDirectory
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: processFile
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: processFile
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: processFile
11:47:51 - [34mdebug[39m: isFileInNodeModuleDir
11:47:51 - [34mdebug[39m: processFile
11:47:51 - [34mdebug[39m: fromDirectory
11:47:51 - [31merror[39m: In: /Users/serkanerkan/cicero-template-library/src/online-payment-contract-tr/lib/logic.ergo [Cannot find type with name 'MyContract']
Error: In: /Users/serkanerkan/cicero-template-library/src/online-payment-contract-tr/lib/logic.ergo [Cannot find type with name 'MyContract']
    at Object.process (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:969:35)
    at Function.processFile (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1054:27)
    at items.forEach (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1039:22)
    at Array.forEach (<anonymous>)
    at Function.processDirectory (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1038:15)
    at template.getModelManager.updateExternalModels.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:945:22)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
11:47:51 - [32minfo[39m: undefined
11:49:52 - [32minfo[39m: Using current directory as template folder
11:49:52 - [32minfo[39m: Loading a default sample.txt file.
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: constructor
11:49:52 - [34mdebug[39m: constructor
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processDirectory
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: fromDirectory
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:52 - [34mdebug[39m: isFileInNodeModuleDir
11:49:52 - [34mdebug[39m: processFile
11:49:54 - [34mdebug[39m: fromDirectory
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: processDirectory
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: processFile
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: processFile
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: processFile
11:49:54 - [34mdebug[39m: isFileInNodeModuleDir
11:49:54 - [34mdebug[39m: processFile
11:49:54 - [34mdebug[39m: fromDirectory
11:49:54 - [31merror[39m: In: /Users/serkanerkan/cicero-template-library/src/online-payment-contract-tr/lib/logic.ergo [Cannot find type with name 'AccordContract']
Error: In: /Users/serkanerkan/cicero-template-library/src/online-payment-contract-tr/lib/logic.ergo [Cannot find type with name 'AccordContract']
    at Object.process (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:969:35)
    at Function.processFile (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1054:27)
    at items.forEach (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1039:22)
    at Array.forEach (<anonymous>)
    at Function.processDirectory (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1038:15)
    at template.getModelManager.updateExternalModels.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:945:22)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
11:49:54 - [32minfo[39m: undefined
11:50:33 - [32minfo[39m: Using current directory as template folder
11:50:33 - [32minfo[39m: Loading a default sample.txt file.
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: constructor
11:50:33 - [34mdebug[39m: constructor
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processDirectory
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: fromDirectory
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:33 - [34mdebug[39m: isFileInNodeModuleDir
11:50:33 - [34mdebug[39m: processFile
11:50:34 - [34mdebug[39m: fromDirectory
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: processDirectory
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: processFile
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: processFile
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: processFile
11:50:34 - [34mdebug[39m: isFileInNodeModuleDir
11:50:34 - [34mdebug[39m: processFile
11:50:34 - [34mdebug[39m: fromDirectory
11:50:35 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



11:50:35 - [34mdebug[39m: fromDirectory
11:50:35 - [34mdebug[39m: isFileInNodeModuleDir
11:50:35 - [34mdebug[39m: processFile
11:50:35 - [34mdebug[39m: isFileInNodeModuleDir
11:50:35 - [34mdebug[39m: processFile
11:50:35 - [34mdebug[39m: isFileInNodeModuleDir
11:50:35 - [34mdebug[39m: processFile
11:50:35 - [34mdebug[39m: isFileInNodeModuleDir
11:50:35 - [34mdebug[39m: processFile
11:50:35 - [34mdebug[39m: isFileInNodeModuleDir
11:50:35 - [34mdebug[39m: processFile
11:50:35 - [34mdebug[39m: fromDirectory
11:50:35 - [34mdebug[39m: buildGrammar
11:50:35 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"alici","text":"alici","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"satici","text":"satici","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"progname","text":"progname","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":241,"lineBreaks":2,"line":12,"col":22},{"type":"Binding","fieldName":{"type":"varid","value":"usernum","text":"usernum","offset":273,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":282,"lineBreaks":80,"line":14,"col":30},{"type":"Binding","fieldName":{"type":"varid","value":"mahkemebolge","text":"mahkemebolge","offset":4604,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":"  yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":"  yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4618,"lineBreaks":10,"line":94,"col":67}]}
11:50:35 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
11:50:35 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"alici","text":"alici","offset":79,"lineBreaks":0,"line":6,"col":20}}
11:50:35 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
11:50:35 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"satici","text":"satici","offset":147,"lineBreaks":0,"line":8,"col":20}}
11:50:35 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
11:50:35 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"progname","text":"progname","offset":231,"lineBreaks":0,"line":12,"col":12}}
11:50:35 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":241,"lineBreaks":2,"line":12,"col":22}
11:50:35 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"usernum","text":"usernum","offset":273,"lineBreaks":0,"line":14,"col":21}}
11:50:35 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":282,"lineBreaks":80,"line":14,"col":30}
11:50:35 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"mahkemebolge","text":"mahkemebolge","offset":4604,"lineBreaks":0,"line":94,"col":53}}
11:50:35 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":"  yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":"  yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4618,"lineBreaks":10,"line":94,"col":67}
11:50:35 - [31merror[39m: Template references a property 'alici' that is not declared in the template model 'org.accordtr.onlinepayment.MyContract'. Details: {"type":"Binding","fieldName":{"type":"varid","value":"alici","text":"alici","offset":79,"lineBreaks":0,"line":6,"col":20}}
Error: Template references a property 'alici' that is not declared in the template model 'org.accordtr.onlinepayment.MyContract'. Details: {"type":"Binding","fieldName":{"type":"varid","value":"alici","text":"alici","offset":79,"lineBreaks":0,"line":6,"col":20}}
    at Template.buildGrammarRules (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:285:31)
    at Template.buildGrammar (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:191:14)
    at template.getModelManager.updateExternalModels.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/template.js:1016:26)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
11:50:35 - [32minfo[39m: undefined
11:53:05 - [32minfo[39m: Using current directory as template folder
11:53:05 - [32minfo[39m: Loading a default sample.txt file.
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: constructor
11:53:05 - [34mdebug[39m: constructor
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processDirectory
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: fromDirectory
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:05 - [34mdebug[39m: isFileInNodeModuleDir
11:53:05 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: fromDirectory
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processDirectory
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: fromDirectory
11:53:07 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



11:53:07 - [34mdebug[39m: fromDirectory
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: isFileInNodeModuleDir
11:53:07 - [34mdebug[39m: processFile
11:53:07 - [34mdebug[39m: fromDirectory
11:53:07 - [34mdebug[39m: buildGrammar
11:53:07 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userID","text":"userID","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":283,"lineBreaks":80,"line":14,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4605,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4622,"lineBreaks":10,"line":94,"col":70}]}
11:53:07 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
11:53:07 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
11:53:07 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
11:53:07 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
11:53:07 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
11:53:07 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
11:53:07 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
11:53:07 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userID","text":"userID","offset":275,"lineBreaks":0,"line":14,"col":21}}
11:53:07 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":283,"lineBreaks":80,"line":14,"col":29}
11:53:07 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4605,"lineBreaks":0,"line":94,"col":53}}
11:53:07 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4622,"lineBreaks":10,"line":94,"col":70}
11:53:07 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "8e687926-ac62-4987-b72b-21ec2a7446c7",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userID : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userID 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userID : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
11:53:08 - [34mdebug[39m: fromDirectory
11:53:08 - [34mdebug[39m: fromDirectory
11:53:08 - [31merror[39m: invalid syntax at line 94 col 60:

  10. Bu sözleşmeden doğan anlaşmazlıkların çözümde "ankara"  yetkilidir.
                                                             ^
Unexpected " "

Error: invalid syntax at line 94 col 60:

  10. Bu sözleşmeden doğan anlaşmazlıkların çözümde "ankara"  yetkilidir.
                                                             ^
Unexpected " "

    at Parser.feed (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/nearley/lib/nearley.js:317:27)
    at Clause.parse (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-core/lib/templateinstance.js:96:16)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:54:24)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
11:53:08 - [32minfo[39m: undefined
11:53:32 - [32minfo[39m: Using current directory as template folder
11:53:32 - [32minfo[39m: Loading a default sample.txt file.
11:53:32 - [34mdebug[39m: fromDirectory
11:53:32 - [34mdebug[39m: fromDirectory
11:53:32 - [34mdebug[39m: fromDirectory
11:53:32 - [34mdebug[39m: fromDirectory
11:53:32 - [34mdebug[39m: fromDirectory
11:53:32 - [34mdebug[39m: fromDirectory
11:53:32 - [34mdebug[39m: fromDirectory
11:53:33 - [34mdebug[39m: constructor
11:53:33 - [34mdebug[39m: constructor
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processDirectory
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: fromDirectory
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:33 - [34mdebug[39m: isFileInNodeModuleDir
11:53:33 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: fromDirectory
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processDirectory
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: fromDirectory
11:53:34 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



11:53:34 - [34mdebug[39m: fromDirectory
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: isFileInNodeModuleDir
11:53:34 - [34mdebug[39m: processFile
11:53:34 - [34mdebug[39m: fromDirectory
11:53:34 - [34mdebug[39m: buildGrammar
11:53:34 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userID","text":"userID","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":283,"lineBreaks":80,"line":14,"col":29},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4605,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4622,"lineBreaks":10,"line":94,"col":70}]}
11:53:34 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
11:53:34 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
11:53:34 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
11:53:34 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
11:53:34 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
11:53:34 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
11:53:34 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
11:53:34 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userID","text":"userID","offset":275,"lineBreaks":0,"line":14,"col":21}}
11:53:34 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":283,"lineBreaks":80,"line":14,"col":29}
11:53:34 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4605,"lineBreaks":0,"line":94,"col":53}}
11:53:34 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4622,"lineBreaks":10,"line":94,"col":70}
11:53:34 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "0d67756f-395f-4eda-9ca2-2f62c4cf6f2e",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userID : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userID 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userID : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
11:53:35 - [34mdebug[39m: fromDirectory
11:53:35 - [34mdebug[39m: fromDirectory
11:53:35 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"0d67756f-395f-4eda-9ca2-2f62c4cf6f2e","buyer":"umut","seller":"serkan","softwareID":"prog","userID":"2","authorizedCourt":"yerel mahkemeler"}
11:53:35 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"0d67756f-395f-4eda-9ca2-2f62c4cf6f2e","buyer":"umut","seller":"serkan","softwareID":"prog","userID":"2","authorizedCourt":"yerel mahkemeler"}
11:53:35 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m0d67756f-395f-4eda-9ca2-2f62c4cf6f2e[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbuyer[39m[33m"[39m[33m: [39m[33m"[39m[35mumut[39m[33m"[39m[33m,[39m
  [33m"[39m[32mseller[39m[33m"[39m[33m: [39m[33m"[39m[35mserkan[39m[33m"[39m[33m,[39m
  [33m"[39m[32msoftwareID[39m[33m"[39m[33m: [39m[33m"[39m[35mprog[39m[33m"[39m[33m,[39m
  [33m"[39m[32muserID[39m[33m"[39m[33m: [39m[33m"[39m[35m2[39m[33m"[39m[33m,[39m
  [33m"[39m[32mauthorizedCourt[39m[33m"[39m[33m: [39m[33m"[39m[35myerel mahkemeler[39m[33m"[39m
[33m}[39m
11:55:47 - [32minfo[39m: Using current directory as template folder
11:55:47 - [32minfo[39m: Loading a default sample.txt file.
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: constructor
11:55:47 - [34mdebug[39m: constructor
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processDirectory
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: fromDirectory
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:47 - [34mdebug[39m: isFileInNodeModuleDir
11:55:47 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: fromDirectory
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processDirectory
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: fromDirectory
11:55:49 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



11:55:49 - [34mdebug[39m: fromDirectory
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: isFileInNodeModuleDir
11:55:49 - [34mdebug[39m: processFile
11:55:49 - [34mdebug[39m: fromDirectory
11:55:49 - [34mdebug[39m: buildGrammar
11:55:49 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
11:55:49 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
11:55:49 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
11:55:49 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
11:55:49 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
11:55:49 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
11:55:49 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
11:55:49 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
11:55:49 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
11:55:49 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
11:55:49 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
11:55:49 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
11:55:49 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "0edd46cf-2f50-4fef-a076-1117e571ea54",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
11:55:50 - [34mdebug[39m: fromDirectory
11:55:50 - [34mdebug[39m: fromDirectory
11:55:50 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"0edd46cf-2f50-4fef-a076-1117e571ea54","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"yerel mahkemeler"}
11:55:50 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"0edd46cf-2f50-4fef-a076-1117e571ea54","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"yerel mahkemeler"}
11:55:50 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m0edd46cf-2f50-4fef-a076-1117e571ea54[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbuyer[39m[33m"[39m[33m: [39m[33m"[39m[35mUmut[39m[33m"[39m[33m,[39m
  [33m"[39m[32mseller[39m[33m"[39m[33m: [39m[33m"[39m[35mSerkan[39m[33m"[39m[33m,[39m
  [33m"[39m[32msoftwareID[39m[33m"[39m[33m: [39m[33m"[39m[35mAcmeSoftware-1.0[39m[33m"[39m[33m,[39m
  [33m"[39m[32muserCount[39m[33m"[39m[33m: [39m[33m"[39m[35m2[39m[33m"[39m[33m,[39m
  [33m"[39m[32mauthorizedCourt[39m[33m"[39m[33m: [39m[33m"[39m[35myerel mahkemeler[39m[33m"[39m
[33m}[39m
12:01:24 - [32minfo[39m: Using current directory as template folder
12:01:24 - [32minfo[39m: Loading a default sample.txt file.
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: constructor
12:01:24 - [34mdebug[39m: constructor
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processDirectory
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: fromDirectory
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:24 - [34mdebug[39m: isFileInNodeModuleDir
12:01:24 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: fromDirectory
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processDirectory
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: fromDirectory
12:01:26 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:01:26 - [34mdebug[39m: fromDirectory
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: isFileInNodeModuleDir
12:01:26 - [34mdebug[39m: processFile
12:01:26 - [34mdebug[39m: fromDirectory
12:01:26 - [34mdebug[39m: buildGrammar
12:01:26 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:01:26 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:01:26 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:01:26 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:01:26 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:01:26 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:01:26 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:01:26 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:01:26 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:01:26 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:01:26 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:01:26 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:01:26 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "1cd9daef-76ab-4c47-9f3b-319391aaa86b",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:01:27 - [34mdebug[39m: fromDirectory
12:01:27 - [34mdebug[39m: fromDirectory
12:01:27 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"1cd9daef-76ab-4c47-9f3b-319391aaa86b","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:01:27 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"1cd9daef-76ab-4c47-9f3b-319391aaa86b","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:01:27 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m1cd9daef-76ab-4c47-9f3b-319391aaa86b[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbuyer[39m[33m"[39m[33m: [39m[33m"[39m[35mUmut[39m[33m"[39m[33m,[39m
  [33m"[39m[32mseller[39m[33m"[39m[33m: [39m[33m"[39m[35mSerkan[39m[33m"[39m[33m,[39m
  [33m"[39m[32msoftwareID[39m[33m"[39m[33m: [39m[33m"[39m[35mAcmeSoftware-1.0[39m[33m"[39m[33m,[39m
  [33m"[39m[32muserCount[39m[33m"[39m[33m: [39m[33m"[39m[35m2[39m[33m"[39m[33m,[39m
  [33m"[39m[32mauthorizedCourt[39m[33m"[39m[33m: [39m[33m"[39m[35mANKARA 1.Bölge İdare Mahkemesi[39m[33m"[39m
[33m}[39m
12:01:47 - [32minfo[39m: Using current directory as template folder
12:01:47 - [32minfo[39m: Loading a default sample.txt file.
12:01:47 - [32minfo[39m: Loading a single default request.json file.
12:01:47 - [32minfo[39m: Loading a default state.json file.
12:01:47 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: constructor
12:01:47 - [34mdebug[39m: constructor
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processDirectory
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: fromDirectory
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:47 - [34mdebug[39m: isFileInNodeModuleDir
12:01:47 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: fromDirectory
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processDirectory
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: fromDirectory
12:01:50 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:01:50 - [34mdebug[39m: fromDirectory
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: isFileInNodeModuleDir
12:01:50 - [34mdebug[39m: processFile
12:01:50 - [34mdebug[39m: fromDirectory
12:01:50 - [34mdebug[39m: buildGrammar
12:01:50 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:01:50 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:01:50 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:01:50 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:01:50 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:01:50 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:01:50 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:01:50 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:01:50 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:01:50 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:01:50 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:01:50 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:01:50 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "ab267e90-501d-48e1-8e69-e7bf7381a60c",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:01:50 - [34mdebug[39m: fromDirectory
12:01:50 - [34mdebug[39m: fromDirectory
12:01:50 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"ab267e90-501d-48e1-8e69-e7bf7381a60c","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:01:50 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"ab267e90-501d-48e1-8e69-e7bf7381a60c","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:01:50 - [31merror[39m: Namespace is not defined for type com.tr.carrental.MyRequest
TypeNotFoundException: Namespace is not defined for type com.tr.carrental.MyRequest
    at ModelManager.getType (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/modelmanager.js:445:19)
    at Serializer.fromJSON (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer.js:146:52)
    at Engine.execute (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-engine/lib/engine.js:203:55)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:151:45)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
12:01:50 - [32minfo[39m: undefined
12:02:15 - [32minfo[39m: Using current directory as template folder
12:02:15 - [32minfo[39m: Loading a default sample.txt file.
12:02:15 - [32minfo[39m: Loading a single default request.json file.
12:02:15 - [32minfo[39m: Loading a default state.json file.
12:02:15 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: constructor
12:02:15 - [34mdebug[39m: constructor
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processDirectory
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: fromDirectory
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:15 - [34mdebug[39m: isFileInNodeModuleDir
12:02:15 - [34mdebug[39m: processFile
12:02:18 - [34mdebug[39m: fromDirectory
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: processDirectory
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: processFile
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: processFile
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: processFile
12:02:18 - [34mdebug[39m: isFileInNodeModuleDir
12:02:18 - [34mdebug[39m: processFile
12:02:18 - [34mdebug[39m: fromDirectory
12:02:18 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:02:19 - [34mdebug[39m: fromDirectory
12:02:19 - [34mdebug[39m: isFileInNodeModuleDir
12:02:19 - [34mdebug[39m: processFile
12:02:19 - [34mdebug[39m: isFileInNodeModuleDir
12:02:19 - [34mdebug[39m: processFile
12:02:19 - [34mdebug[39m: isFileInNodeModuleDir
12:02:19 - [34mdebug[39m: processFile
12:02:19 - [34mdebug[39m: isFileInNodeModuleDir
12:02:19 - [34mdebug[39m: processFile
12:02:19 - [34mdebug[39m: isFileInNodeModuleDir
12:02:19 - [34mdebug[39m: processFile
12:02:19 - [34mdebug[39m: fromDirectory
12:02:19 - [34mdebug[39m: buildGrammar
12:02:19 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:02:19 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:02:19 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:02:19 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:02:19 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:02:19 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:02:19 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:02:19 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:02:19 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:02:19 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:02:19 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:02:19 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:02:19 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "413f7db6-ea28-408d-b4e8-647811692625",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:02:19 - [34mdebug[39m: fromDirectory
12:02:19 - [34mdebug[39m: fromDirectory
12:02:19 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"413f7db6-ea28-408d-b4e8-647811692625","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:02:19 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"413f7db6-ea28-408d-b4e8-647811692625","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:02:19 - [31merror[39m: Namespace is not defined for type org.accordtr.onlinepayment
TypeNotFoundException: Namespace is not defined for type org.accordtr.onlinepayment
    at ModelManager.getType (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/modelmanager.js:445:19)
    at Serializer.fromJSON (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer.js:146:52)
    at Engine.execute (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-engine/lib/engine.js:203:55)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:151:45)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
12:02:19 - [32minfo[39m: undefined
12:02:41 - [32minfo[39m: Using current directory as template folder
12:02:41 - [32minfo[39m: Loading a default sample.txt file.
12:02:41 - [32minfo[39m: Loading a single default request.json file.
12:02:41 - [32minfo[39m: Loading a default state.json file.
12:02:41 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: constructor
12:02:41 - [34mdebug[39m: constructor
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processDirectory
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: fromDirectory
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:41 - [34mdebug[39m: isFileInNodeModuleDir
12:02:41 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: fromDirectory
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processDirectory
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: fromDirectory
12:02:43 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:02:43 - [34mdebug[39m: fromDirectory
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: isFileInNodeModuleDir
12:02:43 - [34mdebug[39m: processFile
12:02:43 - [34mdebug[39m: fromDirectory
12:02:43 - [34mdebug[39m: buildGrammar
12:02:43 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:02:43 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:02:43 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:02:43 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:02:43 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:02:43 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:02:43 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:02:43 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:02:43 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:02:43 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:02:43 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:02:43 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:02:44 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "296acab7-9b25-4f1d-baa9-0506b91b20ce",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:02:44 - [34mdebug[39m: fromDirectory
12:02:44 - [34mdebug[39m: fromDirectory
12:02:44 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"296acab7-9b25-4f1d-baa9-0506b91b20ce","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:02:44 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"296acab7-9b25-4f1d-baa9-0506b91b20ce","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:02:44 - [31merror[39m: Instance org.accordtr.onlinepayment.MyRequest#3b436f90-1c6c-435e-ab48-da666013e8f4 missing required field input
ValidationException: Instance org.accordtr.onlinepayment.MyRequest#3b436f90-1c6c-435e-ab48-da666013e8f4 missing required field input
    at Function.reportMissingRequiredProperty (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer/resourcevalidator.js:481:15)
    at ResourceValidator.visitClassDeclaration (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer/resourcevalidator.js:179:39)
    at ResourceValidator.visit (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/serializer/resourcevalidator.js:74:25)
    at TransactionDeclaration.accept (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/introspect/decorated.js:65:24)
    at ValidatedResource.validate (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/composer-common/lib/model/validatedresource.js:124:26)
    at Engine.execute (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/node_modules/@accordproject/cicero-engine/lib/engine.js:205:22)
    at Template.fromDirectory.then (/Users/serkanerkan/.nvm/versions/node/v8.9.4/lib/node_modules/@accordproject/cicero-cli/lib/commands.js:151:45)
    at <anonymous>
    at process._tickCallback (internal/process/next_tick.js:188:7)
12:02:44 - [32minfo[39m: undefined
12:07:35 - [32minfo[39m: Using current directory as template folder
12:07:35 - [32minfo[39m: Loading a default sample.txt file.
12:07:35 - [34mdebug[39m: fromDirectory
12:07:35 - [34mdebug[39m: fromDirectory
12:07:35 - [34mdebug[39m: fromDirectory
12:07:35 - [34mdebug[39m: fromDirectory
12:07:35 - [34mdebug[39m: fromDirectory
12:07:35 - [34mdebug[39m: fromDirectory
12:07:35 - [34mdebug[39m: fromDirectory
12:07:35 - [34mdebug[39m: constructor
12:07:36 - [34mdebug[39m: constructor
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processDirectory
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: fromDirectory
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:36 - [34mdebug[39m: isFileInNodeModuleDir
12:07:36 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: fromDirectory
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processDirectory
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: fromDirectory
12:07:37 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:07:37 - [34mdebug[39m: fromDirectory
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: isFileInNodeModuleDir
12:07:37 - [34mdebug[39m: processFile
12:07:37 - [34mdebug[39m: fromDirectory
12:07:37 - [34mdebug[39m: buildGrammar
12:07:37 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:07:37 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:07:37 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:07:37 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:07:37 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:07:37 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:07:37 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:07:37 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:07:37 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:07:37 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:07:37 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:07:37 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:07:37 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "1dc6bcca-50f5-4220-bb25-7a9be2633812",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:07:38 - [34mdebug[39m: fromDirectory
12:07:38 - [34mdebug[39m: fromDirectory
12:07:38 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"1dc6bcca-50f5-4220-bb25-7a9be2633812","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:07:38 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"1dc6bcca-50f5-4220-bb25-7a9be2633812","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:07:38 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m1dc6bcca-50f5-4220-bb25-7a9be2633812[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbuyer[39m[33m"[39m[33m: [39m[33m"[39m[35mUmut[39m[33m"[39m[33m,[39m
  [33m"[39m[32mseller[39m[33m"[39m[33m: [39m[33m"[39m[35mSerkan[39m[33m"[39m[33m,[39m
  [33m"[39m[32msoftwareID[39m[33m"[39m[33m: [39m[33m"[39m[35mAcmeSoftware-1.0[39m[33m"[39m[33m,[39m
  [33m"[39m[32muserCount[39m[33m"[39m[33m: [39m[33m"[39m[35m2[39m[33m"[39m[33m,[39m
  [33m"[39m[32mauthorizedCourt[39m[33m"[39m[33m: [39m[33m"[39m[35mANKARA 1.Bölge İdare Mahkemesi[39m[33m"[39m
[33m}[39m
12:07:45 - [32minfo[39m: Using current directory as template folder
12:07:45 - [32minfo[39m: Loading a default sample.txt file.
12:07:45 - [32minfo[39m: Loading a single default request.json file.
12:07:45 - [32minfo[39m: Loading a default state.json file.
12:07:45 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: constructor
12:07:45 - [34mdebug[39m: constructor
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processDirectory
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: fromDirectory
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:45 - [34mdebug[39m: isFileInNodeModuleDir
12:07:45 - [34mdebug[39m: processFile
12:07:48 - [34mdebug[39m: fromDirectory
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: processDirectory
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: processFile
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: processFile
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: processFile
12:07:48 - [34mdebug[39m: isFileInNodeModuleDir
12:07:48 - [34mdebug[39m: processFile
12:07:48 - [34mdebug[39m: fromDirectory
12:07:49 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract_0), "name")) + " ") + deref(unbrand(vrequest_0), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vcontract = deref(context, "contract");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": ((("Hello " + deref(unbrand(vcontract), "name")) + " ") + deref(unbrand(vrequest), "input"))})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:07:49 - [34mdebug[39m: fromDirectory
12:07:49 - [34mdebug[39m: isFileInNodeModuleDir
12:07:49 - [34mdebug[39m: processFile
12:07:49 - [34mdebug[39m: isFileInNodeModuleDir
12:07:49 - [34mdebug[39m: processFile
12:07:49 - [34mdebug[39m: isFileInNodeModuleDir
12:07:49 - [34mdebug[39m: processFile
12:07:49 - [34mdebug[39m: isFileInNodeModuleDir
12:07:49 - [34mdebug[39m: processFile
12:07:49 - [34mdebug[39m: isFileInNodeModuleDir
12:07:49 - [34mdebug[39m: processFile
12:07:49 - [34mdebug[39m: fromDirectory
12:07:49 - [34mdebug[39m: buildGrammar
12:07:49 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:07:49 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:07:49 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:07:49 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:07:49 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:07:49 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:07:49 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:07:49 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:07:49 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:07:49 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:07:49 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:07:49 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:07:49 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "b359df8f-61c5-4718-94d7-29ca52ab33d5",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:07:49 - [34mdebug[39m: fromDirectory
12:07:49 - [34mdebug[39m: fromDirectory
12:07:49 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"b359df8f-61c5-4718-94d7-29ca52ab33d5","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:07:49 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"b359df8f-61c5-4718-94d7-29ca52ab33d5","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:07:49 - [34mdebug[39m: Engine processing request org.accordtr.onlinepayment.MyRequest with state org.accordproject.cicero.contract.AccordContractState
12:07:49 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'org.accordtr.onlinepayment.MyRequest':
                let type0 = 'org.accordtr.onlinepayment.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
12:07:49 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
12:07:49 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-8216648e000cde0406ef93ad053c52a0d7ae87e0c6eef39ba0996ebad990e54d[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mHello undefined Payment Valid[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35m4074895b-3b38-42c8-86b5-903cd367c101[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-26T09:07:49.462Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35ma8b57c86-95c6-4613-b1e2-ae7b00aac749[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
12:08:26 - [32minfo[39m: Using current directory as template folder
12:08:26 - [32minfo[39m: Loading a default sample.txt file.
12:08:26 - [32minfo[39m: Loading a single default request.json file.
12:08:26 - [32minfo[39m: Loading a default state.json file.
12:08:26 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: constructor
12:08:26 - [34mdebug[39m: constructor
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processDirectory
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: fromDirectory
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:26 - [34mdebug[39m: isFileInNodeModuleDir
12:08:26 - [34mdebug[39m: processFile
12:08:28 - [34mdebug[39m: fromDirectory
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: processDirectory
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: processFile
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: processFile
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: processFile
12:08:28 - [34mdebug[39m: isFileInNodeModuleDir
12:08:28 - [34mdebug[39m: processFile
12:08:28 - [34mdebug[39m: fromDirectory
12:08:29 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:08:29 - [34mdebug[39m: fromDirectory
12:08:29 - [34mdebug[39m: isFileInNodeModuleDir
12:08:29 - [34mdebug[39m: processFile
12:08:29 - [34mdebug[39m: isFileInNodeModuleDir
12:08:29 - [34mdebug[39m: processFile
12:08:29 - [34mdebug[39m: isFileInNodeModuleDir
12:08:29 - [34mdebug[39m: processFile
12:08:29 - [34mdebug[39m: isFileInNodeModuleDir
12:08:29 - [34mdebug[39m: processFile
12:08:29 - [34mdebug[39m: isFileInNodeModuleDir
12:08:29 - [34mdebug[39m: processFile
12:08:29 - [34mdebug[39m: fromDirectory
12:08:29 - [34mdebug[39m: buildGrammar
12:08:29 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:08:29 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:08:29 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:08:29 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:08:29 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:08:29 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:08:29 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:08:29 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:08:29 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:08:29 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:08:29 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:08:29 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:08:29 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "ccbefcfd-6f41-4495-a305-65c4d644e595",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:08:29 - [34mdebug[39m: fromDirectory
12:08:29 - [34mdebug[39m: fromDirectory
12:08:29 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"ccbefcfd-6f41-4495-a305-65c4d644e595","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:08:29 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"ccbefcfd-6f41-4495-a305-65c4d644e595","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:08:29 - [34mdebug[39m: Engine processing request org.accordtr.onlinepayment.MyRequest with state org.accordproject.cicero.contract.AccordContractState
12:08:29 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'org.accordtr.onlinepayment.MyRequest':
                let type0 = 'org.accordtr.onlinepayment.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
12:08:29 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
12:08:29 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-5f5ecbd395f2a783dd1624c404b1e6911cd74f394d18eb34c35ef11a10a53e24[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35m829eb1ba-c58b-4314-a1f8-393a74783c16[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-26T09:08:29.453Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35m859d76b0-627f-48e5-932f-18e367854d41[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
12:08:49 - [32minfo[39m: Using current directory as template folder
12:08:49 - [32minfo[39m: Loading a default sample.txt file.
12:08:49 - [32minfo[39m: Loading a single default request.json file.
12:08:49 - [32minfo[39m: Loading a default state.json file.
12:08:49 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: constructor
12:08:49 - [34mdebug[39m: constructor
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processDirectory
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: fromDirectory
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:49 - [34mdebug[39m: isFileInNodeModuleDir
12:08:49 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: fromDirectory
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processDirectory
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: fromDirectory
12:08:53 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:08:53 - [34mdebug[39m: fromDirectory
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: isFileInNodeModuleDir
12:08:53 - [34mdebug[39m: processFile
12:08:53 - [34mdebug[39m: fromDirectory
12:08:53 - [34mdebug[39m: buildGrammar
12:08:53 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:08:53 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:08:53 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:08:53 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:08:53 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:08:53 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:08:53 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:08:53 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:08:53 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:08:53 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:08:53 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:08:53 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:08:53 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "7de9a442-a608-4e07-8683-af76a2264aff",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:08:53 - [34mdebug[39m: fromDirectory
12:08:53 - [34mdebug[39m: fromDirectory
12:08:53 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"7de9a442-a608-4e07-8683-af76a2264aff","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:08:53 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"7de9a442-a608-4e07-8683-af76a2264aff","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:08:53 - [34mdebug[39m: Engine processing request org.accordtr.onlinepayment.MyRequest with state org.accordproject.cicero.contract.AccordContractState
12:08:53 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'org.accordtr.onlinepayment.MyRequest':
                let type0 = 'org.accordtr.onlinepayment.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
12:08:53 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
12:08:53 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-760d95f46b3a0d9b1f13c18045f0cc2233952eccd5439c5fdc9181781902451b[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Sent[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Sent[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35m7b6934c8-4b78-4289-9a43-3c231421941a[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-26T09:08:53.981Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35m5461e08b-1c03-4d5c-baca-9132f58a6b0f[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
12:09:18 - [32minfo[39m: Using current directory as template folder
12:09:18 - [32minfo[39m: Loading a default sample.txt file.
12:09:18 - [32minfo[39m: Loading a single default request.json file.
12:09:18 - [32minfo[39m: Loading a default state.json file.
12:09:18 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: constructor
12:09:18 - [34mdebug[39m: constructor
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processDirectory
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: fromDirectory
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:18 - [34mdebug[39m: isFileInNodeModuleDir
12:09:18 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: fromDirectory
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processDirectory
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: fromDirectory
12:09:22 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



12:09:22 - [34mdebug[39m: fromDirectory
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: isFileInNodeModuleDir
12:09:22 - [34mdebug[39m: processFile
12:09:22 - [34mdebug[39m: fromDirectory
12:09:22 - [34mdebug[39m: buildGrammar
12:09:22 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
12:09:22 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
12:09:22 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
12:09:22 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
12:09:22 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
12:09:22 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
12:09:22 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
12:09:22 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
12:09:22 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
12:09:22 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
12:09:22 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
12:09:22 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
12:09:22 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "47150cac-7e27-458f-994a-e569ca3bcdd8",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
12:09:23 - [34mdebug[39m: fromDirectory
12:09:23 - [34mdebug[39m: fromDirectory
12:09:23 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"47150cac-7e27-458f-994a-e569ca3bcdd8","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:09:23 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"47150cac-7e27-458f-994a-e569ca3bcdd8","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
12:09:23 - [34mdebug[39m: Engine processing request org.accordtr.onlinepayment.MyRequest with state org.accordproject.cicero.contract.AccordContractState
12:09:23 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'org.accordtr.onlinepayment.MyRequest':
                let type0 = 'org.accordtr.onlinepayment.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
12:09:23 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
12:09:23 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-c200fbfbd4af7e56b252f1209c8113d39071740d3dfb09b612048d4211bb0286[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35mcdd6176d-4860-42a2-b40c-f48bf7ec97b9[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-26T09:09:23.067Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35m18efa547-d88c-4ae3-b9c8-88980fad6870[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
13:33:54 - [32minfo[39m: Using current directory as template folder
13:33:54 - [32minfo[39m: Loading a default sample.txt file.
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: constructor
13:33:54 - [34mdebug[39m: constructor
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processDirectory
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: fromDirectory
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:54 - [34mdebug[39m: isFileInNodeModuleDir
13:33:54 - [34mdebug[39m: processFile
13:33:55 - [34mdebug[39m: fromDirectory
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: processDirectory
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: processFile
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: processFile
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: processFile
13:33:55 - [34mdebug[39m: isFileInNodeModuleDir
13:33:55 - [34mdebug[39m: processFile
13:33:55 - [34mdebug[39m: fromDirectory
13:33:56 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



13:33:56 - [34mdebug[39m: fromDirectory
13:33:56 - [34mdebug[39m: isFileInNodeModuleDir
13:33:56 - [34mdebug[39m: processFile
13:33:56 - [34mdebug[39m: isFileInNodeModuleDir
13:33:56 - [34mdebug[39m: processFile
13:33:56 - [34mdebug[39m: isFileInNodeModuleDir
13:33:56 - [34mdebug[39m: processFile
13:33:56 - [34mdebug[39m: isFileInNodeModuleDir
13:33:56 - [34mdebug[39m: processFile
13:33:56 - [34mdebug[39m: isFileInNodeModuleDir
13:33:56 - [34mdebug[39m: processFile
13:33:56 - [34mdebug[39m: fromDirectory
13:33:56 - [34mdebug[39m: buildGrammar
13:33:56 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
13:33:56 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
13:33:56 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
13:33:56 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
13:33:56 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
13:33:56 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
13:33:56 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
13:33:56 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
13:33:56 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
13:33:56 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
13:33:56 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
13:33:56 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
13:33:56 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "39739912-027f-4709-a8ee-b09c57e26299",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
13:33:56 - [34mdebug[39m: fromDirectory
13:33:56 - [34mdebug[39m: fromDirectory
13:33:56 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"39739912-027f-4709-a8ee-b09c57e26299","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
13:33:56 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"39739912-027f-4709-a8ee-b09c57e26299","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
13:33:56 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m39739912-027f-4709-a8ee-b09c57e26299[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbuyer[39m[33m"[39m[33m: [39m[33m"[39m[35mUmut[39m[33m"[39m[33m,[39m
  [33m"[39m[32mseller[39m[33m"[39m[33m: [39m[33m"[39m[35mSerkan[39m[33m"[39m[33m,[39m
  [33m"[39m[32msoftwareID[39m[33m"[39m[33m: [39m[33m"[39m[35mAcmeSoftware-1.0[39m[33m"[39m[33m,[39m
  [33m"[39m[32muserCount[39m[33m"[39m[33m: [39m[33m"[39m[35m2[39m[33m"[39m[33m,[39m
  [33m"[39m[32mauthorizedCourt[39m[33m"[39m[33m: [39m[33m"[39m[35mANKARA 1.Bölge İdare Mahkemesi[39m[33m"[39m
[33m}[39m
13:34:05 - [32minfo[39m: Using current directory as template folder
13:34:05 - [32minfo[39m: Loading a default sample.txt file.
13:34:05 - [32minfo[39m: Loading a single default request.json file.
13:34:05 - [32minfo[39m: Loading a default state.json file.
13:34:05 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: constructor
13:34:05 - [34mdebug[39m: constructor
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processDirectory
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: fromDirectory
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:05 - [34mdebug[39m: isFileInNodeModuleDir
13:34:05 - [34mdebug[39m: processFile
13:34:06 - [34mdebug[39m: fromDirectory
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: processDirectory
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: processFile
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: processFile
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: processFile
13:34:06 - [34mdebug[39m: isFileInNodeModuleDir
13:34:06 - [34mdebug[39m: processFile
13:34:06 - [34mdebug[39m: fromDirectory
13:34:07 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



13:34:07 - [34mdebug[39m: fromDirectory
13:34:07 - [34mdebug[39m: isFileInNodeModuleDir
13:34:07 - [34mdebug[39m: processFile
13:34:07 - [34mdebug[39m: isFileInNodeModuleDir
13:34:07 - [34mdebug[39m: processFile
13:34:07 - [34mdebug[39m: isFileInNodeModuleDir
13:34:07 - [34mdebug[39m: processFile
13:34:07 - [34mdebug[39m: isFileInNodeModuleDir
13:34:07 - [34mdebug[39m: processFile
13:34:07 - [34mdebug[39m: isFileInNodeModuleDir
13:34:07 - [34mdebug[39m: processFile
13:34:07 - [34mdebug[39m: fromDirectory
13:34:07 - [34mdebug[39m: buildGrammar
13:34:07 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
13:34:07 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
13:34:07 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
13:34:07 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
13:34:07 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
13:34:07 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
13:34:07 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
13:34:07 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
13:34:07 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
13:34:07 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
13:34:07 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
13:34:07 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
13:34:07 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "3e4197b7-bd40-4ce9-845c-cc1155692d88",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
13:34:07 - [34mdebug[39m: fromDirectory
13:34:07 - [34mdebug[39m: fromDirectory
13:34:07 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"3e4197b7-bd40-4ce9-845c-cc1155692d88","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
13:34:07 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"3e4197b7-bd40-4ce9-845c-cc1155692d88","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
13:34:07 - [34mdebug[39m: Engine processing request org.accordtr.onlinepayment.MyRequest with state org.accordproject.cicero.contract.AccordContractState
13:34:07 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'org.accordtr.onlinepayment.MyRequest':
                let type0 = 'org.accordtr.onlinepayment.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
13:34:07 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
13:34:07 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-1fa7197a84cace76d83467b35f8971a2fb485c210baed336e1e391b59dec93f3[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35m8bc346bd-6d27-46bd-ab71-766a537a6ec8[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-30T10:34:07.416Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35maba203f0-ffd4-43bd-a9c8-c9722cf24a4a[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
14:44:46 - [32minfo[39m: Using current directory as template folder
14:44:46 - [32minfo[39m: Loading a default sample.txt file.
14:44:46 - [34mdebug[39m: fromDirectory
14:44:46 - [34mdebug[39m: fromDirectory
14:44:46 - [34mdebug[39m: fromDirectory
14:44:46 - [34mdebug[39m: fromDirectory
14:44:46 - [34mdebug[39m: fromDirectory
14:44:46 - [34mdebug[39m: fromDirectory
14:44:46 - [34mdebug[39m: fromDirectory
14:44:46 - [34mdebug[39m: constructor
14:44:46 - [34mdebug[39m: constructor
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: processDirectory
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: processFile
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: processFile
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: processFile
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: processFile
14:44:46 - [34mdebug[39m: isFileInNodeModuleDir
14:44:46 - [34mdebug[39m: processFile
14:44:47 - [34mdebug[39m: isFileInNodeModuleDir
14:44:47 - [34mdebug[39m: processFile
14:44:47 - [34mdebug[39m: fromDirectory
14:44:47 - [34mdebug[39m: isFileInNodeModuleDir
14:44:47 - [34mdebug[39m: processFile
14:44:47 - [34mdebug[39m: isFileInNodeModuleDir
14:44:47 - [34mdebug[39m: processFile
14:44:47 - [34mdebug[39m: isFileInNodeModuleDir
14:44:47 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: fromDirectory
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processDirectory
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: fromDirectory
14:44:48 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



14:44:48 - [34mdebug[39m: fromDirectory
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: isFileInNodeModuleDir
14:44:48 - [34mdebug[39m: processFile
14:44:48 - [34mdebug[39m: fromDirectory
14:44:48 - [34mdebug[39m: buildGrammar
14:44:48 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
14:44:48 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
14:44:48 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
14:44:48 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
14:44:48 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
14:44:48 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
14:44:48 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
14:44:48 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
14:44:48 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
14:44:48 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
14:44:48 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
14:44:48 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
14:44:48 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "39572dee-cabc-454a-920e-1a07d28623a3",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
14:44:49 - [34mdebug[39m: fromDirectory
14:44:49 - [34mdebug[39m: fromDirectory
14:44:49 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"39572dee-cabc-454a-920e-1a07d28623a3","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
14:44:49 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"39572dee-cabc-454a-920e-1a07d28623a3","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
14:44:49 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyContract[39m[33m"[39m[33m,[39m
  [33m"[39m[32mcontractId[39m[33m"[39m[33m: [39m[33m"[39m[35m39572dee-cabc-454a-920e-1a07d28623a3[39m[33m"[39m[33m,[39m
  [33m"[39m[32mbuyer[39m[33m"[39m[33m: [39m[33m"[39m[35mUmut[39m[33m"[39m[33m,[39m
  [33m"[39m[32mseller[39m[33m"[39m[33m: [39m[33m"[39m[35mSerkan[39m[33m"[39m[33m,[39m
  [33m"[39m[32msoftwareID[39m[33m"[39m[33m: [39m[33m"[39m[35mAcmeSoftware-1.0[39m[33m"[39m[33m,[39m
  [33m"[39m[32muserCount[39m[33m"[39m[33m: [39m[33m"[39m[35m2[39m[33m"[39m[33m,[39m
  [33m"[39m[32mauthorizedCourt[39m[33m"[39m[33m: [39m[33m"[39m[35mANKARA 1.Bölge İdare Mahkemesi[39m[33m"[39m
[33m}[39m
14:44:55 - [32minfo[39m: Using current directory as template folder
14:44:55 - [32minfo[39m: Loading a default sample.txt file.
14:44:55 - [32minfo[39m: Loading a single default request.json file.
14:44:55 - [32minfo[39m: Loading a default state.json file.
14:44:55 - [33mwarn[39m: A state file was not provided, generating default state object. Try the --state flag or create a state.json in the root folder of your template.
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: constructor
14:44:55 - [34mdebug[39m: constructor
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processDirectory
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: fromDirectory
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:55 - [34mdebug[39m: isFileInNodeModuleDir
14:44:55 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: fromDirectory
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processDirectory
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: fromDirectory
14:44:57 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



14:44:57 - [34mdebug[39m: fromDirectory
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: isFileInNodeModuleDir
14:44:57 - [34mdebug[39m: processFile
14:44:57 - [34mdebug[39m: fromDirectory
14:44:57 - [34mdebug[39m: buildGrammar
14:44:57 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
14:44:57 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
14:44:57 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
14:44:57 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
14:44:57 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
14:44:57 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
14:44:57 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
14:44:57 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
14:44:57 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
14:44:57 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
14:44:57 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
14:44:57 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
14:44:57 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "95e3b2c1-d45c-443c-a96b-c84e3817817a",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
14:44:57 - [34mdebug[39m: fromDirectory
14:44:57 - [34mdebug[39m: fromDirectory
14:44:57 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"95e3b2c1-d45c-443c-a96b-c84e3817817a","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
14:44:57 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"95e3b2c1-d45c-443c-a96b-c84e3817817a","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
14:44:57 - [34mdebug[39m: Engine processing request org.accordtr.onlinepayment.MyRequest with state org.accordproject.cicero.contract.AccordContractState
14:44:57 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'org.accordtr.onlinepayment.MyRequest':
                let type0 = 'org.accordtr.onlinepayment.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
14:44:57 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
14:44:57 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-ff89c948d7499cf12b3319b2e2d809cd7485a6ee0c819b6ce7b643bc49579bd1[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35me041f21a-0557-432d-bac9-0b32070787dd[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-31T11:44:57.748Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35mb71ed0bf-56b1-4b27-8574-3d20f64b5896[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
14:45:40 - [32minfo[39m: Using current directory as template folder
14:45:40 - [32minfo[39m: Loading a default sample.txt file.
14:45:40 - [32minfo[39m: Loading a single default request.json file.
14:45:40 - [32minfo[39m: Loading a default state.json file.
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: constructor
14:45:40 - [34mdebug[39m: constructor
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processDirectory
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: fromDirectory
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:40 - [34mdebug[39m: isFileInNodeModuleDir
14:45:40 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: fromDirectory
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processDirectory
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: fromDirectory
14:45:41 - [34mdebug[39m: Compiled Ergo to Javascript:
/*
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/* Initialize inheritance */
var inheritance = null;
/* "standard library" (implementation of unary and binary operators) */
function unwrap(doc) {
    // Unwrap for Enhanced TxStore format
    if ("state" in doc && !("$class" in doc)) {
        if (doc.state == "COMMITTED")
            return JSON.parse(doc.currentValue);
        else
            return null; // Not sure if we will need something more fancy for un-committed data
    }
    // Leave as-is
    else
        return doc;
}
function concat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2)
        if (!(key2 in r1))
            result[key2] = r2[key2];
    return result;
}
function contains(v, b) {
    for (var i=0; i<b.length; i++)
        if (equal(v, toLeft(b[i])))
            return true;
    return false;
}
function distinct(b) {
    var result = [ ];
    for (var i=0; i<b.length; i++) {
        var v = b[i];
        var dup = false;
        for (var j=0; j<result.length;j++) {
            if (equal(v,result[j])) { dup = true; break; }
        }
        if (!(dup)) { result.push(v); } else { dup = false; }
    }
    return result;
}
function fastdistinct(b) {
    b1 = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    b1.sort(compare);
    var result = [ ];
    var v1 = null;
    var v2 = null;
    for (var i=0; i<b1.length; i++) {
        var v1 = b1[i];
        if (i == (b1.length -1)) {
            result.push(v1);
        }
        else {
            v2 = b1[i+1];
            if (equal(v1,v2)) {
            } else {
                result.push(v1);
            }
            v1 = v2;
        }
    }
    return result;
}
function compare(v1, v2) {
    var t1 = typeof v1, t2 = typeof v2;
    if (t1 != t2)
        return t1 < t2 ? -1 : +1;
    var a1 = {}.toString.apply(v1), a2 = {}.toString.apply(v2);
    if (a1 != a2)
        return a1 < a2 ? -1 : +1;
    if (a1 == "[object Array]") {
        v1 = v1.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
        v2 = v2.slice(); /* So we do the sort/compare on a clone of the original array */
        v1.sort(compare);
        v2.sort(compare);
    }
    if (t1 == "object") {
        var fields1 = [];
        var fields2 = [];
        for (var f1 in v1) { fields1.push(f1); }
        for (var f2 in v2) { fields2.push(f2); }
        fields1 = fields1.sort(compare);
        fields2 = fields2.sort(compare);
        for (var i = 0; i < fields1.length; i++) {
            if (!(fields1[i] in v2))
                return -1;
            var fc = compare(v1[fields1[i]], v2[fields1[i]]);
            if (fc != 0)
                return fc;
        }
        for (var i = 0; i < fields2.length; i++) {
            if (!(fields2[i] in v1))
                return +1;
        }
        return 0;
    }
    if (v1 != v2)
        return v1 < v2 ? -1 : +1;
    return 0;
}
function equal(v1, v2) {
    return compare(v1, v2) == 0;
}
function compareOfMultipleCriterias(scl) {
    return function(a,b) {
        var current_compare = 0;
        for (var i=0; i<scl.length; i++) {
            var sc = scl[i];
            if ("asc" in sc) { current_compare = compare(deref(a,sc['asc']), deref(b,sc['asc'])); }
            else if ("desc" in sc) { current_compare = -(compare(deref(a,sc['asc']), deref(b,sc['asc']))); }

            if (current_compare == -1) { return -1; }
            else if(current_compare == 1) { return 1; }
        }
        return current_compare;
    }
    
}
function sort(b,scl) {
    var result = [ ];
    if (scl.length == 0) { return b; } // Check for no sorting criteria
    var compareFun = compareOfMultipleCriterias(scl);
    result = b.slice(); /* Sorting in place leads to inconsistencies, notably as it re-orders the input WM in the middle of processing */
    result.sort(compareFun);
    return result;
}
function flatten(aOuter) {
    var result = [ ];
    for (var iOuter=0, nOuter=aOuter.length; iOuter<nOuter; iOuter++) {
        var aInner = aOuter[iOuter];
        for (var iInner=0, nInner=aInner.length; iInner<nInner; iInner++)
            result.push(aInner[iInner]);
    }
    return result;
}
function mergeConcat(r1, r2) {
    var result = { };
    for (var key1 in r1)
        result[key1] = r1[key1];
    for (var key2 in r2) {
        if (key2 in r1) {
            if (!equal(r1[key2], r2[key2])) {
                return [ ];
            }
        } else {
            result[key2] = r2[key2];
        }
    }
    return [ result ];
}
function project(r1, p2) {
    var result = { };
    for (var key1 in r1) {
        if (!(p2.indexOf(key1) == -1))
            result[key1] = r1[key1];
    }
    return result;
}
function remove(r, f) {
    var result = { };
    for (var key in r)
        if (key != f)
            result[key] = r[key];
    return result;
}
function sum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i];
    return result;
}
function arithMean(b) {
    var len = b.length;
    if(len == 0) {
        return 0;
    } else {
        return sum(b)/len;
    }
}
function toString(v) {
    return toStringQ(v, "");
}
function toStringQ(v, quote) {
    if (v === null)
        return "null";
    var t = typeof v;
    if (t == "string")
        return quote + v + quote;
    if (t == "boolean")
        return "" + v;
    if (t == "number") {
        if (Math.floor(v) == v) return (new Number(v)).toFixed(1); // Make sure there is always decimal point
        else return "" + v;
    }
    if ({}.toString.apply(v) == "[object Array]") {
        v = v.slice();
        v.sort();
        var result = "[";
        for (var i=0, n=v.length; i<n; i++) {
            if (i > 0)
                result += ", ";
            result += toStringQ(v[i], quote);
        }
        return result + "]";
    }
    if(v.hasOwnProperty('nat')){
        return "" + v.nat;
    }
    var result2 = "{";
    var first = true;
    for (var key in v) {
        if (first) first = false; else result2 += ", ";
        result2 += toStringQ(key, quote) + ": " + toStringQ(v[key], quote);
    }
    return result2 + "}";
}
function bunion(b1, b2) {
    var result = [ ];
    for (var i1=0; i1<b1.length; i1++)
        result.push(b1[i1]);
    for (var i2=0; i2<b2.length; i2++)
        result.push(b2[i2]);
    return result;
}
function bminus(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == (-1)) { result.push(v1[i1]); } else { i2++; }
        } else {
            result.push(v1[i1]);
        }
    }
    return result;
}
function bmin(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) i2++;
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) result.push(v1[i1]);
        }
    }
    return result;
}
function bmax(b1, b2) {
    var result = [ ];
    var v1 = b1.slice();
    var v2 = b2.slice();
    v1.sort(compare);
    v2.sort(compare);
    var i2=0;
    var length2=v2.length;
    var comp=0;
    for (var i1=0; i1<v1.length; i1++) {
        while ((i2 < length2) && (compare(v1[i1],v2[i2]) == 1)) { result.push(v2[i2]); i2++; }
        if (i2 < length2) {
            if(compare(v1[i1],v2[i2]) == 0) i2++;
        }
        result.push(v1[i1]);
    }
    while (i2 < length2) { result.push(v2[i2]); i2++; }
    return result;
}
function sub_brand(b1,b2) {
    var bsub=null;
    var bsup=null;
    var inh = [];
    if (inheritance) { inh = inheritance; };
    for (var i=0; i<inh.length; i++) {
        bsub = inh[i].sub;
        bsup = inh[i].sup;
        if ((b1 == bsub) && (b2 == bsup)) return true;
    }
    return false;
}
function left(v) {
    return { left : v };
}
function right(v) {
    return { right : v };
}
function mustBeArray(obj) {
    if (Array.isArray(obj))
        return;
    var e = new Error("Expected an array but got: " + JSON.stringify(obj));
    throw e;
}
function cast(brands,v) {
    //logger.info("CASTING: "+brands[0]);
    //logger.info("FOR OBJECT: "+JSON.stringify(v));
    mustBeArray(brands);
    if ("$class" in v)
        return enhanced_cast(brands,v);
    var type = v.type;
    mustBeArray(type);
    if (brands.length == 1 && brands[0] == "Any") { /* cast to top of inheritance is built-in */
        return left(v);
    }
    brands:
    for (var i in brands) {
        var b = brands[i];
        for (var j in type) {
            var t = type[j];
            if (equal(t,b) || sub_brand(t,b))
                continue brands;
        }
        /* the brand b does not appear in the type, so the cast fails */
        return right(null);
    }
    /* All brands appear in the type, so the cast succeeds */
    return left(v);
}
function enhanced_cast(brands,v) {
    var type = v.$class;
    if (brands.length != 1)
        throw "Can't handle multiple brands yet";
    var brand = brands[0];
    if (brand == type || brand == "Any" || sub_brand(type, brand)) {
        return left(v);
    }
    return right(null);
}
function singleton(v) {
    if (v.length == 1) {
        return left(v[0]);
    } else {
        return right(null); /* Not a singleton */
    }
}
function unbrand(v) {
    if (typeof v === "object")
        if ("$class" in v) {
            return remove(v,"$class");
        } else {
            return ("data" in v) ? v.data : v;
        }
    throw "TypeError: unbrand called on non-object";
}
function brand(b,v) {
    v['$class'] = b[0];
    return v
}
function either(v) {
    if (v == null)
        return false;
    if (typeof v === "object")
        return !("right" in v);
    return true;
}
function toLeft(v) {
    if (typeof v === "object") {
        if ("left" in v)
            return v.left;
        if ("$value" in v)
            return v.$value;
        if (looksLikeRelationship(v))
            return v["key"];
    }
    return v;
}
function toRight(v) {
    if (v === null)
        return null;
    if (typeof v === "object" && "right" in v)
        return v.right;
    return undefined;
}
function deref(receiver, member) {
    if (typeof receiver === "object" && member in receiver) {
        var ans = receiver[member];
        if (ans === null) {
            return null;
        }
        if (typeof ans === "object" && looksLikeRelationship(ans))
            ans = left(ans["key"]);
        if (("$class" in receiver) && typeof ans === "object" && !("left" in ans) && !Array.isArray(ans))
            ans = left(ans);
        return ans;
    }
    return undefined;
}
function looksLikeRelationship(v) {
    // As the name suggests, this is only heuristic.  We call it a relationship if it has two or three members.
    // A "key" and "type" member must be among those.   A third member, if present, must be $class and must denote
    // the relationship class.
    var hasKey = false;
    var hasType = false;
    for (var member in v)
        if (member == "key")
            hasKey = true;
    else if (member == "type")
        hasType = true;
    else if (member == "$class" && v["$class"] == "com.ibm.ia.model.Relationship")
        continue;
    else
        return false;
    return hasKey && hasType;
}
function mkWorld(v) {
    return { "WORLD" : v };
}

// from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions?redirectlocale=en-US&redirectslug=JavaScript%2FGuide%2FRegular_Expressions
function escapeRegExp(string){
    return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1");
}

// Nat operations

function natPlus(v1, v2) {
    return { "nat" : v1.nat + v2.nat };
}
function natMinus(v1, v2) {
    return { "nat" : v1.nat - v2.nat };
}
function natMult(v1, v2) {
    return { "nat" : v1.nat * v2.nat };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natDiv(v1, v2) {
    return { "nat" : Math.floor(v1.nat / v2.nat) };
}
function natRem(v1, v2) {
    return { "nat" : Math.floor(v1.nat % v2.nat) };
}
function natMin(v1, v2) {
    return { "nat" : Math.min(v1.nat,v2.nat) };
}
function natMax(v1, v2) {
    return { "nat" : Math.max(v1.nat,v2.nat) };
}
function natAbs(v) {
    return { "nat" : Math.abs(v.nat) };
}
function natLog2(v) {
    return { "nat" : Math.floor(Math.log2(v.nat)) }; // Default Z.log2 is log_inf, biggest integer lower than log2
}
function natSqrt(v) {
    return { "nat" : Math.floor(Math.sqrt(v.nat)) }; // See Z.sqrt biggest integer lower than sqrt
}
function natSum(b) {
    var result = 0;
    for (var i=0; i<b.length; i++)
        result += b[i].nat;
    return { "nat" : result };
}
function natMinApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.min.apply(Math,numbers) };
}
function natMaxApply(b) {
    var numbers = [ ];
    for (var i=0; i<b.length; i++)
        numbers.push(b[i].nat);
    return { "nat" : Math.max.apply(Math,numbers) };
}
function natArithMean(b) {
    var len = b.length;
    if(len == 0) {
        return { "nat" : 0 };
    } else {
        return { "nat" : Math.floor(natSum(b)/len) };
    }
}
function count(v) {
    //return { "nat" : v.length };
    return v.length; /* XXX To be fixed */
}
function floatOfNat(v) {
    return v.nat;
}
function substring(v, start, len) {
    return v.substring(start,len);
}
function substringNoLength(v, start) {
    return v.substring(start);
}
/* Addendum to for dateTime and duration */

var DAY = "day";
var MONTH = "month";
var QUARTER = "quarter";
var YEAR = "year";

function dateTimeComponent(part, date) {
    date = mustBeDate(date);
    switch(part) {
    case DAY:
        return date.dayOfMonth();
    case MONTH:
        return date.month();
    case YEAR:
        return date.year();
    case QUARTER:
        return date.quarter();
    default:
        throw new Error("Unknown date part: " + part);
    }
}

function dateTimeFromString(stringDate) {
    return moment(stringDate);
}

function dateTimeDurationFromString(stringDuration) {
    // TODO verify what the string format for durations is going to be.
    // Here we assume a number adjoined to a valid unit with a dash.
    if (typeof stringDuration === "string") {
	      parts = stringDuration.split("-");
	      if (parts.length === 2) {
	          mustBeUnit(parts[1]);
            return moment.duration(parseFloat(parts[0]),parts[1]+"s");
        }
    }
    throw new Error("Not well formed duration input: " + stringDuration);
}

function dateTimePointPlus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.add(duration);
}

function dateTimePointMinus(date, duration) {
    date = mustBeDate(date);
    duration = mustBeDuration(duration);
    return date.substract(duration);
}

function dateTimePointNe(date1, date2) {
    return compareDates(date1, date2) != 0;
}

function dateTimePointLt(date1, date2) {
    return compareDates(date1,date2) < 0;
}

function dateTimePointLe(date1, date2) {
    return compareDates(date1, date2) <= 0;
}

function dateTimePointGt(date1, date2) {
    return compareDates(date1, date2) > 0;
}

function dateTimePointGe(date1, date2) {
    return compareDates(date1, date2) >= 0;
}

function dateTimeDurationDays(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'days');
}
function dateTimeDurationSeconds(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    return date1.diff(date2,'seconds');
}

function compareDates(date1, date2) {
    date1 = mustBeDate(date1);
    date2 = mustBeDate(date2);
    if (date1.isBefore(date2)) {
        return -1;
    } else if (date1.isAfter(date2)) {
        return 1;
    } else if (date1.isSame(date2)) {
        return 0;
    }
    throw new Error("Unexpected failure: compareDates")
}

function dateNewYear(date, year) {
    date = mustBeDate(date);
    return date.year(year);
}

function dateNewMonth(date, month) {
    date = mustBeDate(date);
    return date.month(month);
}

function dateNewDay(date, day) {
    date = mustBeDate(date);
    return date.day(day);
}

function makeDate(year, month, day) {
    return moment({ 'year' :year, 'month' :month, 'day' :day });
}

function mustBeDate(date) {
    if (typeof date == "string") {
        return moment(date);
    } else {
        return date.clone();
    }
}

function mustBeDuration(duration) {
    if (typeof duration == "string") {
        return moment.duration(duration);
    } else {
        return duration.clone();
    }
}

function mustBeUnit(unit) {
    if (unit === DAY || unit === MONTH || unit === QUARTER || unit === YEAR)
	      return;
    throw new Error("Expected a duration unit but got " + JSON.stringify(unit));
}

'use strict';
/*eslint-disable no-unused-vars*/
/*eslint-disable no-undef*/
/*eslint-disable no-var*/


/**
 * Execute the smart clause
 * @param {Context} context - the Accord context
 * @param {org.accordtr.onlinepayment.MyRequest} context.request - the incoming request
 * @param {org.accordtr.onlinepayment.MyResponse} context.response - the response
 * @param {org.hyperledger.composer.system.Event} context.emit - the emitted events
 * @param {org.accordproject.cicero.contract.AccordContractState} context.state - the state
 * @AccordClauseLogic
 */
function orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context) {
  let pcontext = { 'request' : serializer.toJSON(context.request,{permitResourcesForRelationships:true}), 'state': serializer.toJSON(context.state,{permitResourcesForRelationships:true}), 'contract': serializer.toJSON(context.contract,{permitResourcesForRelationships:true}), 'emit': context.emit, 'now': context.now};
  //logger.info('ergo context: '+JSON.stringify(pcontext))
  let result = new orgXaccordtrXonlinepaymentXMyContract().onlinepayment(pcontext);
  if (result.hasOwnProperty('left')) {
    //logger.info('ergo result: '+JSON.stringify(result))
    context.response = serializer.fromJSON(result.left.response, {validate: false, acceptResourcesForRelationships: true},{permitResourcesForRelationships:true});
    context.state = serializer.fromJSON(result.left.state, {validate: false, acceptResourcesForRelationships: true});
    let emitResult = [];
    for (let i = 0; i < result.left.emit.length; i++) {
      emitResult.push(serializer.fromJSON(result.left.emit[i], {validate: false, acceptResourcesForRelationships: true}));
    }
    context.emit = emitResult;
    return context;
  } else {
    throw new Error(result.right);
  }
}
class orgXaccordtrXonlinepaymentXMyContract {
  main(context) {
    var vnow = deref(context, "now");
    var vcontract = deref(context, "contract");
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit_0 = vemit;
    var vX$match0 = vrequest;
    var res1 = null;
    if (either(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0))) {
      var vX$case0 = null;
      vX$case0 = toLeft(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"left" : {"$main": vX$case0}};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(cast(["org.accordtr.onlinepayment.MyRequest"],vX$match0));
      res1 = {"right" : null};
    }
    var res2 = null;
    if (either(res1)) {
      var vX$case0_0 = null;
      vX$case0_0 = toLeft(res1);
      var vX$case0 = vX$case0_0;
      var vX$main = deref(vX$case0, "$main");
      var vrequest_0 = vX$main;
      var vemit_0 = vlemit_0;
      var vstate_0 = vlstate_0;
      var vcontract_0 = vcontract;
      var vnow_0 = vnow;
      var vlstate = vstate_0;
      var vlemit = vemit_0;
      res2 = {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest_0), "input")})}, {"state": vlstate}), {"emit": vlemit})};
    } else {
      var vX$case1 = null;
      vX$case1 = toRight(res1);
      res2 = {"right" : brand(["org.accordproject.cicero.runtime.ErrorResponse"],{"message": ""})};
    }
    return res2;
  }
  init(context) {
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate_0 = vstate;
    var vlemit = vemit;
    var vlstate = {"$class": "org.accordproject.cicero.contract.AccordContractState", "stateId": "1"};
    return {"left" : concat(concat({"response": {"$class": "org.accordproject.cicero.runtime.Response"}}, {"state": vlstate}), {"emit": vlemit})};
  }
  onlinepayment(context) {
    var vrequest = deref(context, "request");
    var vemit = deref(context, "emit");
    var vstate = deref(context, "state");
    var vlstate = vstate;
    var vlemit = vemit;
    return {"left" : concat(concat({"response": brand(["org.accordtr.onlinepayment.MyResponse"],{"output": deref(unbrand(vrequest), "input")})}, {"state": vlstate}), {"emit": vlemit})};
  }
}

/*eslint-enable no-unused-vars*/
/*eslint-enable no-undef*/



14:45:41 - [34mdebug[39m: fromDirectory
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: isFileInNodeModuleDir
14:45:41 - [34mdebug[39m: processFile
14:45:41 - [34mdebug[39m: fromDirectory
14:45:41 - [34mdebug[39m: buildGrammar
14:45:41 - [34mdebug[39m: Template AST {"type":"ContractTemplate","data":[{"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1},{"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}},{"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27},{"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}},{"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28},{"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}},{"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24},{"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}},{"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32},{"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}},{"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}]}
14:45:41 - [34mdebug[39m: element rule0 {"type":"Chunk","value":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  ","text":"DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  [{","offset":0,"lineBreaks":5,"line":1,"col":1}
14:45:41 - [34mdebug[39m: element rule1 {"type":"Binding","fieldName":{"type":"varid","value":"buyer","text":"buyer","offset":79,"lineBreaks":0,"line":6,"col":20}}
14:45:41 - [34mdebug[39m: element rule2 {"type":"Chunk","value":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. ","text":" (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. [{","offset":86,"lineBreaks":2,"line":6,"col":27}
14:45:41 - [34mdebug[39m: element rule3 {"type":"Binding","fieldName":{"type":"varid","value":"seller","text":"seller","offset":147,"lineBreaks":0,"line":8,"col":20}}
14:45:41 - [34mdebug[39m: element rule4 {"type":"Chunk","value":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: ","text":"  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: [{","offset":155,"lineBreaks":4,"line":8,"col":28}
14:45:41 - [34mdebug[39m: element rule5 {"type":"Binding","fieldName":{"type":"varid","value":"softwareID","text":"softwareID","offset":231,"lineBreaks":0,"line":12,"col":12}}
14:45:41 - [34mdebug[39m: element rule6 {"type":"Chunk","value":"          \n\nKullanıcı Sayısı: ","text":"          \n\nKullanıcı Sayısı: [{","offset":243,"lineBreaks":2,"line":12,"col":24}
14:45:41 - [34mdebug[39m: element rule7 {"type":"Binding","fieldName":{"type":"varid","value":"userCount","text":"userCount","offset":275,"lineBreaks":0,"line":14,"col":21}}
14:45:41 - [34mdebug[39m: element rule8 {"type":"Chunk","value":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde ","text":" \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde [{","offset":286,"lineBreaks":80,"line":14,"col":32}
14:45:41 - [34mdebug[39m: element rule9 {"type":"Binding","fieldName":{"type":"varid","value":"authorizedCourt","text":"authorizedCourt","offset":4608,"lineBreaks":0,"line":94,"col":53}}
14:45:41 - [34mdebug[39m: element rule10 {"type":"LastChunk","value":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","text":" yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n","offset":4625,"lineBreaks":10,"line":94,"col":70}
14:45:41 - [34mdebug[39m: Generated template grammar# Dynamically Generated
@builtin "number.ne"
@builtin "string.ne"
@builtin "whitespace.ne"
@{%
    function compact(v) {
        if (Array.isArray(v)) {
            return v.reduce((a, v) => (v === null || v === undefined || (v && v.length === 0) ) ? a : (a.push(v), a), []);
        } else {
            return v;
        }
    }

    function flatten(v) {
        let r;
        if (Array.isArray(v)) {
            r = v.reduce((a,v) => (a.push(...((v && Array.isArray(v)) ? flatten(v) : [v])), a), []);
        } else {
            r = v;
        }
        r = compact(r);
        return r;
        }
%}


rule -> rule0 rule1 rule2 rule3 rule4 rule5 rule6 rule7 rule8 rule9 rule10 
{% ([ rule0,rule1,rule2,rule3,rule4,rule5,rule6,rule7,rule8,rule9,rule10 ]) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        contractId : "066efb80-eb95-4423-91a6-4602cf874460",
        buyer : rule1,
        seller : rule3,
        softwareID : rule5,
        userCount : rule7,
        authorizedCourt : rule9,
    };
}
%}

ROOT -> rule0 
{% ([ rule0 ]) => {
    return {
        
        
    };
}
%}



rule0 -> "DLK BİLİŞİM TEKNOLOJİLERİ SATIŞ SÖZLEŞMESİ\n\n\n1. TARAFLAR :\n\n            1.1  " 


rule1 -> String {% id %} # buyer 


rule2 -> " (Bundan sonra ALICI olarak anılacaktır)\n\n            1.2. " 


rule3 -> String {% id %} # seller 


rule4 -> "  (Bundan sonra SATICI olarak anılacaktır)\n\n2. SATILAN ÜRÜNLER:\n\nProgram: " 


rule5 -> String {% id %} # softwareID 


rule6 -> "          \n\nKullanıcı Sayısı: " 


rule7 -> String {% id %} # userCount 


rule8 -> " \n\n3.KONU\n\n            3.1.SATICI, bu sözleşmeyle satışı yapılan yazılımların (bilgisayar programlarının) kullanım hak ve yetkisini ALICI’ya verir.\n\n\n4. KARŞILIKLI TAAHHÜTLER:\n\n4.1.Sözleşmenin tarafları olarak hareket eden SATICI  ve ALICI aşağıda belirten hak ve yükümlülüklerini karşılıklı olarak taahhüt edip kabul ve imza etmişlerdir.\n\n            4.2 SATICI ;\n\n4.2.1.İkinci Maddede belirtilen ürünleri, ALICInın bilgisayarına yüklemek, yazılım hatalarına karşı çıkabilecek sorunlarda ekteki garanti belgesinde belirlenen koşul ve süreler içinde ücretsiz, daha sonrasında ise ücret karşılığı da olsa ALICI'ya destek sağlamak ve verilmesi zorunlu olan program eğitimini vermekle sorumludur.\n\n            4.2.2.Eğitim:\n\n4.2.2.1.ALICI, ikinci maddede belirtilen ürünler için, standart program eğitimi ya da ek eğitim taleplerinde bulunabilir. SATICI , ALICIDAN gelecek eğitim taleplerini en kısa sürede karşılamakla yükümlüdür.  Eğitim karşılıklı anlaşmaya bağlı olarak, ALICI’nın iş yerinde veya SATICI ’nın eğitim merkezinde olabilir. Eğitimin, ne zaman, ne sürede ve hangi kapsamda olacağı SATICI ve ALICI tarafından birlikte belirlenir.\n\n4.2.2.2. ALICI, çalışanların eğitiminin sürekliliğini sağlamakla sorumludur. Eğitim amaçlı olarak ALICI’nın iş yerine gelen, eğiticiye yeteri kadar zaman ayrılmaması veya geldiği halde eğitimi verememesi gibi durumlarda, eğitim çalışması yapılmış sayılır.\n\n4.2.2.3. Eğitim hizmetleri, destek sözleşmelerinde belirtilen fiyatlar ile ücretlendirilir.\n\n\n            4.3 ALICI:\n\n            4.3.1. Bu sözleşme ile kendisine tanınmış hak, sorumluluk ve yetkileri, hiç bir şekilde başka kişi veya kuruluşlara devremedez. SATICI adına ya da hesabına üçüncü bir şahısla bir işlem ya da anlaşma yapamaz. Herhangi bir taahhütte bulunamaz.\n\n            4.3.2. ALICI, hiçbir şekilde ürünleri oluşturan yazılım ve diğer belgeleri (CD, kitap, kullanım kılavuzu v.b. gibi) kiralayamaz, kopyalayamaz, ücretli ya da ücretsiz bir şekilde dağıtamaz.\n\n \n\n5. ÖDEME:\n\n5.1. İkinci maddede belirtilen ürünler, aşağıdaki ödeme tablosundaki bilgilere göre ALICI’ya satılmıştır.\n\n6. ÖDEMENİN YAPILMAMASI YA DA GECİKMESİ DURUMUNDA\n\n            6.1. Beşinci maddede belirtilen ödemelerin her hangi birisinin yapılmaması durumunda SATICI  geriye kalan tüm ödemelerin tahsilatını isteyebilir.\n\n            6.2. Beşinci Maddede belirtilen ödemelere uyulmaması durumunda SATICI ’nın garanti destek ve eğitim yükümlülükleri ödemeler tamamlanana kadar kalkar. Bu arada geçen süreler garanti ve destek srelerine eklenmez.\n\n            6.3. ALICI’nın ödemelerini geciktirmesi durumunda, gecikme süresi için, aylık % 7 gecikme faizi işletilerek ödeme miktarına eklenir.\n\n            6.4. Satışı yapılmış olan yazılımların hiçbir şekilde iadesi yapılamaz. Yazılımın kullanılmasından vazgeçilse dahi tüm ödemelerin vadesinde tamamlanması zorunludur.\n\n \n\n7. DİĞER HÜKÜMLER\n\n            7.1. SATICI , ürünlerin kullanımından kaynaklanacak hatalardan sorumlu değildir. ALICI, yazılımdaki raporların ya da verilerin hatalı olduğunu; bu verilere bakarak yanlış kararlar aldığını ve zarara uğradığını öne süremez.\n\n            7.2. SATICI , hiçbir şekilde ürünlerle birlikte depolanan bilgileri garanti etmez. Bilgilerin güvenliğini sağlamak kullanıcının sorumluluğundadır.\n\n            7.3.  SATICI , ALICInın ürünleri, yasalara aykırı biçimde kullanmasından sorumlu değildir.\n\n            7.4. Yazılım sisteminin konusuna giren yasa, yönetmelik veya diğer mevzuat, uygulama ve raporlarda değişiklik olması ya da çeşitli nedenlerle ALICI tarafından programda değişiklik ya da programa ek yapılmasının istenmesi durumunda, bu işlemlerin gerçekleştirilip gerçekleştirilmeyeceğine SATICI  karar verir.  Yapılacak değişiklik ve ekler ayrıca fiyatlandırılır.\n\n \n\n8. FESİH\n\n            8.1. Taraflar aşağıda belirtilen sebeplerin varlığında sözleşmeyi fesh etme hakkına sahiptir.\n\n            8.1.1. ALICInın SATICI ya olan borçları ile ilgili temerrüde düşmesi halinde,\n\n            8.1.2. Tarafların sözleşme hükümlerine aykırı davranması halinde,\n\n            8.1.3. ALICI’nın ticari işletmesini devretmesi halinde,\n\n            8.1.4.SATICI ’nın, ticari faaliyetlerinin T.T.K.’da belirtilen biçimlerde sona ermesi halinde.\n\n \n\n9. EKLER\n\nGaranti Belgesi\nDestek Sözleşmesi\n \n\n10. Bu sözleşmeden doğan anlaşmazlıkların çözümde " 


rule9 -> String {% id %} # authorizedCourt 


rule10 -> " yetkilidir.\n\n \n\n11. 11 (0nbir) ana maddeden oluşan bu sözleşme aşağıda belirtilen tarihte, 2 (iki) nüsha halinde düzenlenmiş olup, taraflarca imzalanıp teslim alınmıştır.\n\n \n\n \n\n" 


MyRequest -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyRequest",
        input : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyResponse -> String  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyResponse",
        output : data[0],
        transactionId : data[2],
        timestamp : data[4]
    };
}
%}


MyContract -> String  __  String  __  String  __  String  __  String  __  String  __  String 

{% ( data ) => {
    return {
        $class: "org.accordtr.onlinepayment.MyContract",
        buyer : data[0],
        seller : data[2],
        softwareID : data[4],
        userCount : data[6],
        authorizedCourt : data[8],
        contractId : data[10],
        parties : data[12]
    };
}
%}


AccordContractState -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordContractState",
        stateId : data[0]
    };
}
%}


AccordParty -> String 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.contract.AccordParty",
        partyId : data[0]
    };
}
%}


Request -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Request",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


Response -> String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Response",
        transactionId : data[0],
        timestamp : data[2]
    };
}
%}


PaymentObligation -> MonetaryAmount  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.PaymentObligation",
        amount : data[0],
        description : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


NotificationObligation -> String  __  String  __  String  __  String  __  String  __  DateTime:?  __  String  __  DateTime 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.NotificationObligation",
        title : data[0],
        message : data[2],
        contract : data[4],
        promisor : data[6],
        promisee : data[8],
        deadline : data[10],
        eventId : data[12],
        timestamp : data[14]
    };
}
%}


Payload -> AccordContract  __  Request  __  AccordContractState:? 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Payload",
        contract : data[0],
        request : data[2],
        state : data[4]
    };
}
%}


Success -> Response  __  AccordContractState  __  Event:+ 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Success",
        response : data[0],
        state : data[2],
        emit : data[4]
    };
}
%}


Failure -> ErrorResponse 

{% ( data ) => {
    return {
        $class: "org.accordproject.cicero.runtime.Failure",
        error : data[0]
    };
}
%}


CryptoMonetaryAmount -> Double  __  CryptoCurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.CryptoMonetaryAmount",
        doubleValue : data[0],
        cryptoCurrencyCode : data[2]
    };
}
%}


CryptoCurrencyCode -> "ADA" {% id %} | "BCH" {% id %} | "BTC" {% id %} | "DASH" {% id %} | "EOS" {% id %} | "ETC" {% id %} | "ETH" {% id %} | "LTC" {% id %} | "NEO" {% id %} | "XLM" {% id %} | "XMR" {% id %} | "XRP" {% id %} | "ZEC" {% id %} 


MonetaryAmount -> Double  __  CurrencyCode 

{% ( data ) => {
    return {
        $class: "org.accordproject.money.MonetaryAmount",
        doubleValue : data[0],
        currencyCode : data[2]
    };
}
%}


CurrencyCode -> "AED" {% id %} | "AFN" {% id %} | "ALL" {% id %} | "AMD" {% id %} | "ANG" {% id %} | "AOA" {% id %} | "ARS" {% id %} | "AUD" {% id %} | "AWG" {% id %} | "AZN" {% id %} | "BAM" {% id %} | "BBD" {% id %} | "BDT" {% id %} | "BGN" {% id %} | "BHD" {% id %} | "BIF" {% id %} | "BMD" {% id %} | "BND" {% id %} | "BOB" {% id %} | "BOV" {% id %} | "BRL" {% id %} | "BSD" {% id %} | "BTN" {% id %} | "BWP" {% id %} | "BYN" {% id %} | "BZD" {% id %} | "CAD" {% id %} | "CDF" {% id %} | "CHE" {% id %} | "CHF" {% id %} | "CHW" {% id %} | "CLF" {% id %} | "CLP" {% id %} | "CNY" {% id %} | "COP" {% id %} | "COU" {% id %} | "CRC" {% id %} | "CUC" {% id %} | "CUP" {% id %} | "CVE" {% id %} | "CZK" {% id %} | "DJF" {% id %} | "DKK" {% id %} | "DOP" {% id %} | "DZD" {% id %} | "EGP" {% id %} | "ERN" {% id %} | "ETB" {% id %} | "EUR" {% id %} | "FJD" {% id %} | "FKP" {% id %} | "GBP" {% id %} | "GEL" {% id %} | "GHS" {% id %} | "GIP" {% id %} | "GMD" {% id %} | "GNF" {% id %} | "GTQ" {% id %} | "GYD" {% id %} | "HKD" {% id %} | "HNL" {% id %} | "HRK" {% id %} | "HTG" {% id %} | "HUF" {% id %} | "IDR" {% id %} | "ILS" {% id %} | "INR" {% id %} | "IQD" {% id %} | "IRR" {% id %} | "ISK" {% id %} | "JMD" {% id %} | "JOD" {% id %} | "JPY" {% id %} | "KES" {% id %} | "KGS" {% id %} | "KHR" {% id %} | "KMF" {% id %} | "KPW" {% id %} | "KRW" {% id %} | "KWD" {% id %} | "KYD" {% id %} | "KZT" {% id %} | "LAK" {% id %} | "LBP" {% id %} | "LKR" {% id %} | "LRD" {% id %} | "LSL" {% id %} | "LYD" {% id %} | "MAD" {% id %} | "MDL" {% id %} | "MGA" {% id %} | "MKD" {% id %} | "MMK" {% id %} | "MNT" {% id %} | "MOP" {% id %} | "MRU" {% id %} | "MUR" {% id %} | "MVR" {% id %} | "MWK" {% id %} | "MXN" {% id %} | "MXV" {% id %} | "MYR" {% id %} | "MZN" {% id %} | "NAD" {% id %} | "NGN" {% id %} | "NIO" {% id %} | "NOK" {% id %} | "NPR" {% id %} | "NZD" {% id %} | "OMR" {% id %} | "PAB" {% id %} | "PEN" {% id %} | "PGK" {% id %} | "PHP" {% id %} | "PKR" {% id %} | "PLN" {% id %} | "PYG" {% id %} | "QAR" {% id %} | "RON" {% id %} | "RSD" {% id %} | "RUB" {% id %} | "RWF" {% id %} | "SAR" {% id %} | "SBD" {% id %} | "SCR" {% id %} | "SDG" {% id %} | "SEK" {% id %} | "SGD" {% id %} | "SHP" {% id %} | "SLL" {% id %} | "SOS" {% id %} | "SRD" {% id %} | "SSP" {% id %} | "STN" {% id %} | "SVC" {% id %} | "SYP" {% id %} | "SZL" {% id %} | "THB" {% id %} | "TJS" {% id %} | "TMT" {% id %} | "TND" {% id %} | "TOP" {% id %} | "TRY" {% id %} | "TTD" {% id %} | "TWD" {% id %} | "TZS" {% id %} | "UAH" {% id %} | "UGX" {% id %} | "USD" {% id %} | "USN" {% id %} | "UYI" {% id %} | "UYU" {% id %} | "UZS" {% id %} | "VEF" {% id %} | "VND" {% id %} | "VUV" {% id %} | "WST" {% id %} | "XAF" {% id %} | "XAG" {% id %} | "XAU" {% id %} | "XBA" {% id %} | "XBB" {% id %} | "XBC" {% id %} | "XBD" {% id %} | "XCD" {% id %} | "XDR" {% id %} | "XOF" {% id %} | "XPD" {% id %} | "XPF" {% id %} | "XPT" {% id %} | "XSU" {% id %} | "XTS" {% id %} | "XUA" {% id %} | "XXX" {% id %} | "YER" {% id %} | "ZAR" {% id %} | "ZMW" {% id %} | "ZWL" {% id %} 



# Basic types
NUMBER -> [0-9] 
{% (d) => {return parseInt(d[0]);}%}

DOUBLE_NUMBER -> NUMBER NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

MONTH -> DOUBLE_NUMBER
DAY -> DOUBLE_NUMBER
YEAR -> DOUBLE_NUMBER DOUBLE_NUMBER
{% (d) => {return '' + d[0] + d[1]}%}

DATE -> MONTH "/" DAY "/" YEAR
{% (d) => {return '' + d[4] + '-' + d[0] + '-' + d[2]}%}

Word -> [\S]:*
{% (d) => {return d[0].join('');}%}

BRACKET_PHRASE -> "[" Word (__ Word):* "]" {% ((d) => {return d[1] + ' ' + flatten(d[2]).join(" ");}) %}

String -> dqstring {% id %}
Double -> decimal {% id %}
Integer -> int {% id %}
Long -> int {% id %}
Boolean -> "true" {% id %} | "false" {% id %}
DateTime -> DATE  {% id %}
14:45:42 - [34mdebug[39m: fromDirectory
14:45:42 - [34mdebug[39m: fromDirectory
14:45:42 - [34mdebug[39m: Result of parsing: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"066efb80-eb95-4423-91a6-4602cf874460","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
14:45:42 - [34mdebug[39m: Setting clause data: {"$class":"org.accordtr.onlinepayment.MyContract","contractId":"066efb80-eb95-4423-91a6-4602cf874460","buyer":"Umut","seller":"Serkan","softwareID":"AcmeSoftware-1.0","userCount":"2","authorizedCourt":"ANKARA 1.Bölge İdare Mahkemesi"}
14:45:42 - [34mdebug[39m: Engine processing request org.accordtr.onlinepayment.MyRequest with state org.accordproject.cicero.contract.AccordContractState
14:45:42 - [34mdebug[39m: 
        __dispatch(contract,data,request,state,moment());

        function __dispatch(contract,data,request,state,now) {
            switch(request.getFullyQualifiedType()) {
        
            case 'org.accordtr.onlinepayment.MyRequest':
                let type0 = 'org.accordtr.onlinepayment.MyResponse';
                let ns0 = type0.substr(0, type0.lastIndexOf('.'));
                let clazz0 = type0.substr(type0.lastIndexOf('.')+1);
                let response0 = factory.newTransaction(ns0, clazz0);
                let context0 = {request: request, state: state, contract: contract, data: data, response: response0, emit: [], now: now};
                orgXaccordtrXonlinepaymentXMyContract_onlinepayment(context0);
                return { response: context0.response, state: context0.state, emit: context0.emit };
            break;
            default:
                throw new Error('No function handler for ' + request.getFullyQualifiedType() );
            } // switch
            return 'oops';
        }
        
14:45:42 - [34mdebug[39m: 
        __init(contract,data,request,moment());

        function __init(contract,data,request,now) {
        
                return { response: serializer.fromJSON({ '$class': 'org.accordproject.cicero.runtime.Response' }, {validate: false, acceptResourcesForRelationships: true}), state: serializer.fromJSON({ '$class': 'org.accordproject.cicero.contract.AccordContractState', 'stateId' : 'org.accordproject.cicero.contract.AccordContractState#1' }, {validate: false, acceptResourcesForRelationships: true}), emit: [] };
        }
        
14:45:42 - [32minfo[39m:
[33m{[39m
  [33m"[39m[32mclause[39m[33m"[39m[33m: [39m[33m"[39m[35mcar-rental-tr@0.0.0-a7b1deb52b75e9af86dc08af30399db639e718f9dea5faa6f4c98331d03b9930[39m[33m"[39m[33m,[39m
  [33m"[39m[32mrequest[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyRequest[39m[33m"[39m[33m,[39m
    [33m"[39m[32minput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mresponse[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordtr.onlinepayment.MyResponse[39m[33m"[39m[33m,[39m
    [33m"[39m[32moutput[39m[33m"[39m[33m: [39m[33m"[39m[35mPayment Valid[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtransactionId[39m[33m"[39m[33m: [39m[33m"[39m[35mc702c699-0959-4dfe-b99b-9bfa5e4d9a7d[39m[33m"[39m[33m,[39m
    [33m"[39m[32mtimestamp[39m[33m"[39m[33m: [39m[33m"[39m[35m2018-07-31T11:45:42.077Z[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32mstate[39m[33m"[39m[33m: [39m[33m{[39m
    [33m"[39m[32m$class[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState[39m[33m"[39m[33m,[39m
    [33m"[39m[32mstateId[39m[33m"[39m[33m: [39m[33m"[39m[35morg.accordproject.cicero.contract.AccordContractState#1[39m[33m"[39m
  [33m}[39m[33m,[39m
  [33m"[39m[32memit[39m[33m"[39m[33m: [39m[33m[[39m[33m][39m
[33m}[39m
